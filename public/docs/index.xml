<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Bubblevan – 文档</title>
    <link>http://localhost:1313/docs/</link>
    <description>Recent content in 文档 on Bubblevan</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    
	  <atom:link href="http://localhost:1313/docs/index.xml" rel="self" type="application/rss+xml" />
    
    
      
        
      
    
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/research/ai4science/ed-gat/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/research/ai4science/ed-gat/</guid>
      <description>
        
        
        &lt;h1&gt;深度学习加速晶体力常数预测：基于等变图神经网络与自动微分的AI4Science实践&lt;/h1&gt;&lt;h2&gt;1. 引言与背景&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;1-引言与背景&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#1-%e5%bc%95%e8%a8%80%e4%b8%8e%e8%83%8c%e6%99%af&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;想象一下，我们需要设计一种新的超导材料。传统的做法是什么？科学家们会使用&lt;strong&gt;第一性原理计算&lt;/strong&gt;，特别是&lt;strong&gt;密度泛函理论（DFT）&lt;/strong&gt;，从量子力学的基本原理出发，计算每个原子的相互作用。这听起来很美好，但现实是残酷的：&lt;/p&gt;
&lt;p&gt;对于一个包含几百个原子的材料体系，DFT计算可能需要运行几天甚至几周。而如果我们想要筛选成千上万种候选材料来找到最优的超导体，这种方法就变得完全不现实了。&lt;/p&gt;
&lt;p&gt;这就是&lt;strong&gt;AI4Science&lt;/strong&gt;要解决的核心问题：能否用人工智能来学习物理规律，从而大幅度加速科学计算？&lt;/p&gt;
&lt;h3&gt;力常数&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;力常数&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%8a%9b%e5%b8%b8%e6%95%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;在所有需要计算的物理量中，&lt;strong&gt;力常数&lt;/strong&gt;特别重要。你可以把它想象成材料的&amp;quot;弹性指纹&amp;quot;——它描述了当你轻微移动一个原子时，其他原子会如何响应。更准确地说，力常数告诉我们原子间的相互作用力如何随位置变化。&lt;/p&gt;
&lt;p&gt;力常数不仅决定了材料的机械性质（硬度、弹性模量），还影响热学性质（热导率、比热容）和动力学性质（声音传播速度）。可以说，掌握了力常数，就掌握了材料行为的关键。&lt;/p&gt;
&lt;h3&gt;我们的目标&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;我们的目标&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%88%91%e4%bb%ac%e7%9a%84%e7%9b%ae%e6%a0%87&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;本项目的目标很明确：构建一个深度学习系统，能够在几秒钟内预测任意晶体结构的力常数，准确度接近传统DFT计算，但速度快几个数量级。&lt;/p&gt;
&lt;p&gt;为了实现这个目标，我们需要解决三个核心挑战：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;如何让神经网络理解三维空间中的物理对称性？&lt;/li&gt;
&lt;li&gt;如何表示复杂的晶体结构？&lt;/li&gt;
&lt;li&gt;如何确保预测结果符合物理定律？&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h2&gt;2. 理论基础：从对称性原理到深度学习架构&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;2-理论基础从对称性原理到深度学习架构&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#2-%e7%90%86%e8%ae%ba%e5%9f%ba%e7%a1%80%e4%bb%8e%e5%af%b9%e7%a7%b0%e6%80%a7%e5%8e%9f%e7%90%86%e5%88%b0%e6%b7%b1%e5%ba%a6%e5%ad%a6%e4%b9%a0%e6%9e%b6%e6%9e%84&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;2.1 物理系统的对称性困境&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;21-物理系统的对称性困境&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#21-%e7%89%a9%e7%90%86%e7%b3%bb%e7%bb%9f%e7%9a%84%e5%af%b9%e7%a7%b0%e6%80%a7%e5%9b%b0%e5%a2%83&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;让我们从一个看似简单但极具挑战性的问题开始。假设我们有一个双原子分子，想用神经网络预测其势能面。传统的做法是将原子坐标&lt;code&gt;[x1, y1, z1, x2, y2, z2]&lt;/code&gt;直接输入全连接网络。&lt;/p&gt;
&lt;p&gt;然而，这种方法存在一个根本性的缺陷：&lt;strong&gt;破坏了物理系统的内在对称性&lt;/strong&gt;。当我们将整个分子在空间中旋转时，坐标数值会发生剧烈变化，但从物理学角度，分子的内在性质（如键长、键角、势能）应该保持不变。这种不一致性迫使网络需要学习所有可能的旋转变换，导致数据需求的组合爆炸。&lt;/p&gt;
&lt;p&gt;更深层的问题在于，传统神经网络无法理解物理量的&lt;strong&gt;张量性质&lt;/strong&gt;。力常数不是简单的标量，而是二阶张量，其在坐标变换下遵循特定的变换规律。忽视这一点等于抛弃了物理学几百年来积累的对称性智慧。&lt;/p&gt;
&lt;h3&gt;2.2 群论与等变性：数学的美学与物理的必然&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;22-群论与等变性数学的美学与物理的必然&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#22-%e7%be%a4%e8%ae%ba%e4%b8%8e%e7%ad%89%e5%8f%98%e6%80%a7%e6%95%b0%e5%ad%a6%e7%9a%84%e7%be%8e%e5%ad%a6%e4%b8%8e%e7%89%a9%e7%90%86%e7%9a%84%e5%bf%85%e7%84%b6&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;要解决这个问题，我们需要回到数学的基础——&lt;strong&gt;群论&lt;/strong&gt;。在物理系统中，对称性变换形成一个数学群，其中最重要的是三维旋转群。&lt;/p&gt;
&lt;h4&gt;从欧几里得群到特殊正交群&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;从欧几里得群到特殊正交群&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%bb%8e%e6%ac%a7%e5%87%a0%e9%87%8c%e5%be%97%e7%be%a4%e5%88%b0%e7%89%b9%e6%ae%8a%e6%ad%a3%e4%ba%a4%e7%be%a4&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;三维空间中的等距变换构成&lt;strong&gt;欧几里得群E(3)&lt;/strong&gt;，它包含旋转和平移两种基本操作。对于晶体系统，我们主要关注&lt;strong&gt;特殊正交群SO(3)&lt;/strong&gt;——所有保持原点不动的旋转变换。&lt;/p&gt;
&lt;p&gt;SO(3)群的数学表示为：
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;{&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo&gt;∈&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;double-struck&#34;&gt;R&lt;/mi&gt;&lt;mrow&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;×&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;det&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&#34;false&#34;&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;SO(3) = \{R \in \mathbb{R}^{3 \times 3} : R^T R = I, \det(R) = 1\}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;SO&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.00773em;&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;∈&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8641em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbb&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8641em;&#34;&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;×&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8913em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.00773em;&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8913em;&#34;&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.00773em;&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.07847em;&#34;&gt;I&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;det&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.00773em;&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;这个群的重要性在于，物理定律在SO(3)变换下保持不变。这不仅是一个数学抽象，更是自然界的基本原理——&lt;strong&gt;诺特定理&lt;/strong&gt;告诉我们，对称性与守恒律之间存在深刻的联系。&lt;/p&gt;
&lt;h4&gt;等变性的严格定义&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;等变性的严格定义&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ad%89%e5%8f%98%e6%80%a7%e7%9a%84%e4%b8%a5%e6%a0%bc%e5%ae%9a%e4%b9%89&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;等变性&lt;/strong&gt;是比不变性更精细的概念。对于函数$f: X \to Y$和群作用$g$，等变性要求：
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo&gt;⋅&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;ρ&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;⋅&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;f(g \cdot x) = \rho(g) \cdot f(x)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10764em;&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;⋅&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;ρ&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;⋅&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10764em;&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;其中$\rho(g)$是群元素$g$在输出空间的表示。这个公式看似抽象，但它编码了物理量变换的本质：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;当我们旋转输入（晶体结构）&lt;/li&gt;
&lt;li&gt;输出（力常数张量）按照张量变换规律相应变化&lt;/li&gt;
&lt;li&gt;物理内容保持不变&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;2.3 不可约表示理论：物理量的分类学&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;23-不可约表示理论物理量的分类学&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#23-%e4%b8%8d%e5%8f%af%e7%ba%a6%e8%a1%a8%e7%a4%ba%e7%90%86%e8%ae%ba%e7%89%a9%e7%90%86%e9%87%8f%e7%9a%84%e5%88%86%e7%b1%bb%e5%ad%a6&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;SO(3)群的&lt;strong&gt;不可约表示&lt;/strong&gt;为我们提供了理解和构造等变网络的数学框架。每个不可约表示对应一种特定的物理量类型。&lt;/p&gt;
&lt;h4&gt;球谐函数作为SO(3)的不可约表示&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;球谐函数作为so3的不可约表示&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%90%83%e8%b0%90%e5%87%bd%e6%95%b0%e4%bd%9c%e4%b8%baso3%e7%9a%84%e4%b8%8d%e5%8f%af%e7%ba%a6%e8%a1%a8%e7%a4%ba&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;球谐函数$Y_l^m(\theta, \phi)$构成SO(3)群的完备不可约表示：
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;→&lt;/mo&gt;&lt;mi mathvariant=&#34;double-struck&#34;&gt;C&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;Y_l^m: S^2 \to \mathbb{C}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.9614em;vertical-align:-0.247em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.22222em;&#34;&gt;Y&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.7144em;&#34;&gt;&lt;span style=&#34;top:-2.453em;margin-left:-0.2222em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;m&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.247em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8641em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05764em;&#34;&gt;S&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8641em;&#34;&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;→&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.6889em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathbb&#34;&gt;C&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;其中：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$l = 0, 1, 2, \ldots$ 称为&lt;strong&gt;阶数&lt;/strong&gt;或&lt;strong&gt;角动量量子数&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;$m = -l, -l+1, \ldots, l-1, l$ 是&lt;strong&gt;磁量子数&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;每个$l$对应一个$(2l+1)$维的不可约表示空间&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;物理意义的对应关系&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$l=0$：标量场（如密度、温度、势能）&lt;/li&gt;
&lt;li&gt;$l=1$：向量场（如位移、力、电场）&lt;/li&gt;
&lt;li&gt;$l=2$：二阶张量场（如应力、应变、力常数）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在我们的代码中，&lt;code&gt;irreps_node_embedding=&#39;128x0e+64x1e+32x2e&#39;&lt;/code&gt;precisely体现了这种分类：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;128x0e&lt;/code&gt;：128个标量特征通道&lt;/li&gt;
&lt;li&gt;&lt;code&gt;64x1e&lt;/code&gt;：64个向量特征通道&lt;/li&gt;
&lt;li&gt;&lt;code&gt;32x2e&lt;/code&gt;：32个二阶张量特征通道&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Clebsch-Gordan系数与张量积&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;clebsch-gordan系数与张量积&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#clebsch-gordan%e7%b3%bb%e6%95%b0%e4%b8%8e%e5%bc%a0%e9%87%8f%e7%a7%af&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;等变网络的核心操作是&lt;strong&gt;张量积&lt;/strong&gt;，它描述了不同阶表示的耦合：
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/msubsup&gt;&lt;mo&gt;⊗&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;∑&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∣&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∣&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo&gt;∑&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/munderover&gt;&lt;msubsup&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msubsup&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;Y_{l_1}^{m_1} \otimes Y_{l_2}^{m_2} = \sum_{l=|l_1-l_2|}^{l_1+l_2} \sum_{m=-l}^{l} C_{l_1 m_1, l_2 m_2}^{l m} Y_l^m&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.1477em;vertical-align:-0.4014em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.22222em;&#34;&gt;Y&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.7463em;&#34;&gt;&lt;span style=&#34;top:-2.3987em;margin-left:-0.2222em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3173em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.1449em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3173em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:0em;margin-right:0.0714em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.4014em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;⊗&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.1477em;vertical-align:-0.4014em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.22222em;&#34;&gt;Y&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.7463em;&#34;&gt;&lt;span style=&#34;top:-2.3987em;margin-left:-0.2222em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3173em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.1449em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3173em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:0em;margin-right:0.0714em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.4014em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:3.3632em;vertical-align:-1.516em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.8472em;&#34;&gt;&lt;span style=&#34;top:-1.809em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;∣&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3173em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;−&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3173em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;∣&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-4.3111em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3173em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3173em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.516em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.8361em;&#34;&gt;&lt;span style=&#34;top:-1.8479em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;−&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-4.3em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.3604em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.07153em;&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8991em;&#34;&gt;&lt;span style=&#34;top:-2.453em;margin-left:-0.0715em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3173em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3173em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:0em;margin-right:0.0714em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3173em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3173em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:0em;margin-right:0.0714em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;m&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3831em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.22222em;&#34;&gt;Y&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.7144em;&#34;&gt;&lt;span style=&#34;top:-2.453em;margin-left:-0.2222em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;m&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.247em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;其中$C_{l_1 m_1, l_2 m_2}^{l m}$是&lt;strong&gt;Clebsch-Gordan系数&lt;/strong&gt;，它们确保了张量积的等变性。这不仅是数学上的优雅，更是物理上的必然——量子力学中的角动量耦合遵循完全相同的规律。&lt;/p&gt;
&lt;h3&gt;2.4 图神经网络：拓扑结构与几何信息的统一&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;24-图神经网络拓扑结构与几何信息的统一&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#24-%e5%9b%be%e7%a5%9e%e7%bb%8f%e7%bd%91%e7%bb%9c%e6%8b%93%e6%89%91%e7%bb%93%e6%9e%84%e4%b8%8e%e5%87%a0%e4%bd%95%e4%bf%a1%e6%81%af%e7%9a%84%e7%bb%9f%e4%b8%80&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;有了群论的数学基础，我们现在面临第二个挑战：如何在保持等变性的同时处理复杂的晶体拓扑结构？&lt;/p&gt;
&lt;h4&gt;从晶体学到图论：天然的数学对应&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;从晶体学到图论天然的数学对应&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%bb%8e%e6%99%b6%e4%bd%93%e5%ad%a6%e5%88%b0%e5%9b%be%e8%ae%ba%e5%a4%a9%e7%84%b6%e7%9a%84%e6%95%b0%e5%ad%a6%e5%af%b9%e5%ba%94&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;晶体结构在数学上可以自然地表示为&lt;strong&gt;赋权图&lt;/strong&gt; $G = (V, E, W)$：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;顶点集 $V$&lt;/strong&gt;：原子位置 ${r_i}_{i=1}^N$&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;边集 $E$&lt;/strong&gt;：原子间相互作用关系&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;权重函数 $W$&lt;/strong&gt;：编码距离和方向信息的边特征&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这种表示的数学优势在于：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;尺寸不变性&lt;/strong&gt;：图可以自然处理不同大小的晶体超胞&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;局部性原理&lt;/strong&gt;：符合物理中的&amp;quot;近程相互作用占主导&amp;quot;假设&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;置换等变性&lt;/strong&gt;：图结构天然具有对原子标记重排的不变性&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;消息传递框架：信息几何的观点&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;消息传递框架信息几何的观点&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%b6%88%e6%81%af%e4%bc%a0%e9%80%92%e6%a1%86%e6%9e%b6%e4%bf%a1%e6%81%af%e5%87%a0%e4%bd%95%e7%9a%84%e8%a7%82%e7%82%b9&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;现代图神经网络基于**消息传递神经网络(MPNN)**框架。在数学上，一次消息传递可以表示为：&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;m&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;ϕ&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;h&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;e&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mathbf{m}_{ij}^{(t)} = \phi_m^{(t)}(\mathbf{h}_i^{(t)}, \mathbf{h}_j^{(t)}, \mathbf{e}_{ij})&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.4578em;vertical-align:-0.413em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.0448em;&#34;&gt;&lt;span style=&#34;top:-2.4231em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;ij&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2198em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.413em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.4578em;vertical-align:-0.413em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;ϕ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.938em;&#34;&gt;&lt;span style=&#34;top:-2.453em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;m&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.247em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.0448em;&#34;&gt;&lt;span style=&#34;top:-2.4231em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2198em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2769em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.0448em;&#34;&gt;&lt;span style=&#34;top:-2.4231em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2198em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.413em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3117em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;ij&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2861em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;ϕ&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mrow&gt;&lt;mo fence=&#34;true&#34;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;⨁&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;∈&lt;/mo&gt;&lt;mi mathvariant=&#34;script&#34;&gt;N&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msubsup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;m&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo fence=&#34;true&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mathbf{h}_i^{(t+1)} = \phi_h^{(t)}\left(\mathbf{h}_i^{(t)}, \bigoplus_{j \in \mathcal{N}(i)} \mathbf{m}_{ij}^{(t)}\right)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.3217em;vertical-align:-0.2769em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.0448em;&#34;&gt;&lt;span style=&#34;top:-2.4231em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2198em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2769em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:3.6em;vertical-align:-1.55em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;ϕ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.0448em;&#34;&gt;&lt;span style=&#34;top:-2.3987em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;h&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2198em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3013em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;mopen&#34;&gt;&lt;span class=&#34;delimsizing mult&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:2.05em;&#34;&gt;&lt;span style=&#34;top:-4.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:5.6em;&#34;&gt;&lt;/span&gt;&lt;span style=&#34;width:0.875em;height:3.600em;&#34;&gt;&lt;svg xmlns=&#34;http://www.w3.org/2000/svg&#34; width=&#34;0.875em&#34; height=&#34;3.600em&#34; viewBox=&#34;0 0 875 3600&#34;&gt;&lt;path d=&#34;M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1
c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,
-36,557 l0,84c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,
949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9
c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,
-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189
l0,-92c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,
-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z&#34;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.55em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.0448em;&#34;&gt;&lt;span style=&#34;top:-2.4231em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2198em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2769em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.05em;&#34;&gt;&lt;span style=&#34;top:-1.809em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;∈&lt;/span&gt;&lt;span class=&#34;mord mathcal mtight&#34; style=&#34;margin-right:0.14736em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;⨁&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.516em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.0448em;&#34;&gt;&lt;span style=&#34;top:-2.4231em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;ij&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2198em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.413em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;&lt;span class=&#34;delimsizing mult&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:2.05em;&#34;&gt;&lt;span style=&#34;top:-4.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:5.6em;&#34;&gt;&lt;/span&gt;&lt;span style=&#34;width:0.875em;height:3.600em;&#34;&gt;&lt;svg xmlns=&#34;http://www.w3.org/2000/svg&#34; width=&#34;0.875em&#34; height=&#34;3.600em&#34; viewBox=&#34;0 0 875 3600&#34;&gt;&lt;path d=&#34;M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,
63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5
c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,9
c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664
c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11
c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17
c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558
l0,-144c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,
-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z&#34;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.55em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;其中$\phi_m$和$\phi_h$是可学习的函数，$\bigoplus$是置换不变的聚合函数（如求和或平均）。&lt;/p&gt;
&lt;p&gt;然而，标准MPNN存在致命缺陷：&lt;strong&gt;破坏了几何等变性&lt;/strong&gt;。函数$\phi_m$和$\phi_h$通常由多层感知机实现，无法保持坐标变换的等变性。&lt;/p&gt;
&lt;h4&gt;等变消息传递：E3NN的突破&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;等变消息传递e3nn的突破&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ad%89%e5%8f%98%e6%b6%88%e6%81%af%e4%bc%a0%e9%80%92e3nn%e7%9a%84%e7%aa%81%e7%a0%b4&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;**E3NN（Euclidean Neural Networks）**框架通过以下创新解决了这个问题：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1. 几何张量特征&lt;/strong&gt;：将标量特征扩展为完整的几何张量
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;⨁&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/munderover&gt;&lt;msubsup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mathbf{h}_i = \bigoplus_{l=0}^{L_{max}} \mathbf{h}_i^{(l)}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8444em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3117em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:3.1415em;vertical-align:-1.3021em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.8394em;&#34;&gt;&lt;span style=&#34;top:-1.8479em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;⨁&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-4.3111em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.1645em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:0em;margin-right:0.0714em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;ma&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.3021em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.0448em;&#34;&gt;&lt;span style=&#34;top:-2.4231em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2198em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2769em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;
其中$\mathbf{h}_i^{(l)}$是$l$阶球谐函数空间中的特征。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2. 等变线性变换&lt;/strong&gt;：替换标准全连接层为等变线性层
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;h&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;↦&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;∑&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo mathvariant=&#34;normal&#34; lspace=&#34;0em&#34; rspace=&#34;0em&#34;&gt;′&lt;/mo&gt;&lt;/msup&gt;&lt;/munder&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;W&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;←&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo mathvariant=&#34;normal&#34; lspace=&#34;0em&#34; rspace=&#34;0em&#34;&gt;′&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;h&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo mathvariant=&#34;normal&#34; lspace=&#34;0em&#34; rspace=&#34;0em&#34;&gt;′&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mathbf{h}^{(l)} \mapsto \sum_{l&amp;#x27;} \mathbf{W}^{(l \leftarrow l&amp;#x27;)} \mathbf{h}^{(l&amp;#x27;)}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.949em;vertical-align:-0.011em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.938em;&#34;&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;↦&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.3521em;vertical-align:-1.3021em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.05em;&#34;&gt;&lt;span style=&#34;top:-1.8479em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.6828em;&#34;&gt;&lt;span style=&#34;top:-2.786em;margin-right:0.0714em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;′&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.3021em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34; style=&#34;margin-right:0.01597em;&#34;&gt;W&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.9925em;&#34;&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;←&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8278em;&#34;&gt;&lt;span style=&#34;top:-2.931em;margin-right:0.0714em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;′&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.9925em;&#34;&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8278em;&#34;&gt;&lt;span style=&#34;top:-2.931em;margin-right:0.0714em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;′&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;
其中权重矩阵$\mathbf{W}^{(l \leftarrow l&amp;rsquo;)}$满足特定的等变约束。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3. 张量积非线性&lt;/strong&gt;：通过Clebsch-Gordan耦合实现等变非线性
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;ϕ&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;h&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;h&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;⨁&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/munder&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;h&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;⊗&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;h&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\phi(\mathbf{h}^{(l_1)}, \mathbf{h}^{(l_2)}) = \bigoplus_{l} (\mathbf{h}^{(l_1)} \otimes \mathbf{h}^{(l_2)})^{(l)}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.188em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;ϕ&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.938em;&#34;&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3173em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.938em;&#34;&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3173em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.3521em;vertical-align:-1.3021em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.05em;&#34;&gt;&lt;span style=&#34;top:-1.8479em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;⨁&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.3021em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.938em;&#34;&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3173em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;⊗&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.188em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.938em;&#34;&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3173em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.938em;&#34;&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;h3&gt;2.5 注意力机制的等变推广&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;25-注意力机制的等变推广&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#25-%e6%b3%a8%e6%84%8f%e5%8a%9b%e6%9c%ba%e5%88%b6%e7%9a%84%e7%ad%89%e5%8f%98%e6%8e%a8%e5%b9%bf&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;传统的注意力机制 $\text{Attention}(Q,K,V) = \text{softmax}(QK^T/\sqrt{d})V$ 假设查询、键、值都是向量，这在几何等变的语境下是不充分的。&lt;/p&gt;
&lt;h4&gt;等变多头注意力&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;等变多头注意力&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ad%89%e5%8f%98%e5%a4%9a%e5%a4%b4%e6%b3%a8%e6%84%8f%e5%8a%9b&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;我们需要将注意力机制推广到等变设定。关键洞察是：&lt;strong&gt;注意力权重必须是标量&lt;/strong&gt;以保持等变性。我们的方法是：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;标量注意力计算&lt;/strong&gt;：
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;softmax&lt;/mtext&gt;&lt;mrow&gt;&lt;mo fence=&#34;true&#34;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;q&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;msup&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;msubsup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;k&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/msqrt&gt;&lt;/mfrac&gt;&lt;mo fence=&#34;true&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\alpha_{ij} = \text{softmax}\left(\frac{(\mathbf{q}_i^{(0)})^T \mathbf{k}_j^{(0)}}{\sqrt{d_0}}\right)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.7167em;vertical-align:-0.2861em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;α&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3117em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;ij&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2861em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:3.0978em;vertical-align:-1.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;softmax&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;mopen delimcenter&#34; style=&#34;top:0em;&#34;&gt;&lt;span class=&#34;delimsizing size4&#34;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.8478em;&#34;&gt;&lt;span style=&#34;top:-2.2976em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.0448em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8572em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:0.833em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3011em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-2.8172em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:0.853em;height:1.08em;&#34;&gt;&lt;svg xmlns=&#34;http://www.w3.org/2000/svg&#34; width=&#34;400em&#34; height=&#34;1.08em&#34; viewBox=&#34;0 0 400000 1080&#34; preserveAspectRatio=&#34;xMinYMin slice&#34;&gt;&lt;path d=&#34;M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z&#34;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.1828em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2748em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.0448em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.8478em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.0448em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.0448em;&#34;&gt;&lt;span style=&#34;top:-2.4231em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2198em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2769em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8413em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.0448em;&#34;&gt;&lt;span style=&#34;top:-2.4231em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2198em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.413em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.93em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose delimcenter&#34; style=&#34;top:0em;&#34;&gt;&lt;span class=&#34;delimsizing size4&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;
其中$\mathbf{q}_i^{(0)}$和$\mathbf{k}_j^{(0)}$是标量（$l=0$）分量。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;等变值聚合&lt;/strong&gt;：
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;o&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;∑&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;∈&lt;/mo&gt;&lt;mi mathvariant=&#34;script&#34;&gt;N&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msubsup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;v&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mathbf{o}_i^{(l)} = \sum_{j \in \mathcal{N}(i)} \alpha_{ij} \mathbf{v}_j^{(l)}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.3217em;vertical-align:-0.2769em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.0448em;&#34;&gt;&lt;span style=&#34;top:-2.4231em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2198em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2769em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.566em;vertical-align:-1.516em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.05em;&#34;&gt;&lt;span style=&#34;top:-1.809em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;∈&lt;/span&gt;&lt;span class=&#34;mord mathcal mtight&#34; style=&#34;margin-right:0.14736em;&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.516em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;α&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3117em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;ij&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2861em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34; style=&#34;margin-right:0.01597em;&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.0448em;&#34;&gt;&lt;span style=&#34;top:-2.4231em;margin-left:-0.016em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2198em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.413em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;
对每个$l$阶分量分别进行加权聚合。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这种设计确保了注意力权重的物理可解释性——它们真正反映了原子间相互作用的强度。&lt;/p&gt;
&lt;h3&gt;2.6 径向函数与角度编码的统一&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;26-径向函数与角度编码的统一&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#26-%e5%be%84%e5%90%91%e5%87%bd%e6%95%b0%e4%b8%8e%e8%a7%92%e5%ba%a6%e7%bc%96%e7%a0%81%e7%9a%84%e7%bb%9f%e4%b8%80&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;等变图神经网络需要同时处理标量距离信息和矢量方向信息。我们采用&lt;strong&gt;径向-角度分离&lt;/strong&gt;的策略：&lt;/p&gt;
&lt;h4&gt;径向基函数展开&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;径向基函数展开&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%be%84%e5%90%91%e5%9f%ba%e5%87%bd%e6%95%b0%e5%b1%95%e5%bc%80&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;距离信息通过径向基函数编码：
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;∑&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;ϕ&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;R(r) = \sum_{k=1}^{K} w_k \phi_k(r)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.00773em;&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:3.1304em;vertical-align:-1.3021em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.8283em;&#34;&gt;&lt;span style=&#34;top:-1.8479em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-4.3em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.07153em;&#34;&gt;K&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.3021em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3361em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;ϕ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3361em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;在我们的实现中，使用&lt;strong&gt;高斯径向基函数&lt;/strong&gt;：
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;ϕ&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;mrow&gt;&lt;mo fence=&#34;true&#34;&gt;(&lt;/mo&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mi&gt;γ&lt;/mi&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo fence=&#34;true&#34;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;μ&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;σ&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;mo fence=&#34;true&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo fence=&#34;true&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\phi_k(r) = \exp\left(-\gamma \left(\frac{r - \mu_k}{\sigma_k}\right)^2\right)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;ϕ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3361em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:3em;vertical-align:-1.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;mopen delimcenter&#34; style=&#34;top:0em;&#34;&gt;&lt;span class=&#34;delimsizing size4&#34;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;−&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05556em;&#34;&gt;γ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;mopen delimcenter&#34; style=&#34;top:0em;&#34;&gt;&lt;span class=&#34;delimsizing size3&#34;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.2603em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;σ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3361em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;−&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;μ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3361em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.836em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose delimcenter&#34; style=&#34;top:0em;&#34;&gt;&lt;span class=&#34;delimsizing size3&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.654em;&#34;&gt;&lt;span style=&#34;top:-3.9029em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose delimcenter&#34; style=&#34;top:0em;&#34;&gt;&lt;span class=&#34;delimsizing size4&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;这种选择的物理动机来自于原子相互作用的局域性——大多数相互作用在特定距离范围内最强。&lt;/p&gt;
&lt;h4&gt;球谐函数角度编码&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;球谐函数角度编码&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%90%83%e8%b0%90%e5%87%bd%e6%95%b0%e8%a7%92%e5%ba%a6%e7%bc%96%e7%a0%81&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;方向信息通过球谐函数的实形式编码：
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;Y&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;r&lt;/mi&gt;&lt;mo&gt;^&lt;/mo&gt;&lt;/mover&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;[&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;r&lt;/mi&gt;&lt;mo&gt;^&lt;/mo&gt;&lt;/mover&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mo&gt;…&lt;/mo&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;r&lt;/mi&gt;&lt;mo&gt;^&lt;/mo&gt;&lt;/mover&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mo stretchy=&#34;false&#34;&gt;]&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mathbf{Y}_l(\hat{\mathbf{r}}) = [Y_l^{-l}(\hat{\mathbf{r}}), \ldots, Y_l^l(\hat{\mathbf{r}})]^T&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34; style=&#34;margin-right:0.02875em;&#34;&gt;Y&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3361em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0288em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.7079em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathbf&#34;&gt;r&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.0134em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.1944em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.1905em;vertical-align:-0.2914em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.22222em;&#34;&gt;Y&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8991em;&#34;&gt;&lt;span style=&#34;top:-2.4086em;margin-left:-0.2222em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;−&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2914em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.7079em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathbf&#34;&gt;r&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.0134em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.1944em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;…&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.22222em;&#34;&gt;Y&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8991em;&#34;&gt;&lt;span style=&#34;top:-2.453em;margin-left:-0.2222em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.247em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.7079em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathbf&#34;&gt;r&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.0134em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.1944em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;&lt;span class=&#34;mclose&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8913em;&#34;&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;其中$\hat{\mathbf{r}} = \mathbf{r}/|\mathbf{r}|$是单位方向向量。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;张量积耦合&lt;/strong&gt;将径向和角度信息结合：
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;⊗&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;Y&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;r&lt;/mi&gt;&lt;mo&gt;^&lt;/mo&gt;&lt;/mover&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mathbf{f}_{ij}^{(l)} = R(r_{ij}) \otimes \mathbf{Y}_l(\hat{\mathbf{r}}_{ij})&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.4578em;vertical-align:-0.413em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34; style=&#34;margin-right:0.10903em;&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.0448em;&#34;&gt;&lt;span style=&#34;top:-2.4231em;margin-left:-0.109em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;ij&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2198em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.413em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.0361em;vertical-align:-0.2861em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.00773em;&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3117em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;ij&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2861em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;⊗&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.0361em;vertical-align:-0.2861em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34; style=&#34;margin-right:0.02875em;&#34;&gt;Y&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3361em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0288em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.7079em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathbf&#34;&gt;r&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.0134em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.1944em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3117em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;ij&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2861em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;这种分离策略不仅数学上优雅，更重要的是它反映了物理相互作用的内在结构。&lt;/p&gt;
&lt;h3&gt;2.7 自动微分：从能量函数到力常数的数学机器&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;27-自动微分从能量函数到力常数的数学机器&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#27-%e8%87%aa%e5%8a%a8%e5%be%ae%e5%88%86%e4%bb%8e%e8%83%bd%e9%87%8f%e5%87%bd%e6%95%b0%e5%88%b0%e5%8a%9b%e5%b8%b8%e6%95%b0%e7%9a%84%e6%95%b0%e5%ad%a6%e6%9c%ba%e5%99%a8&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;最后一个核心技术涉及&lt;strong&gt;计算物理学的基本原理&lt;/strong&gt;：如何从单一的能量函数推导出所有相关的物理量。&lt;/p&gt;
&lt;h4&gt;Hamilton力学与梯度关系&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;hamilton力学与梯度关系&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#hamilton%e5%8a%9b%e5%ad%a6%e4%b8%8e%e6%a2%af%e5%ba%a6%e5%85%b3%e7%b3%bb&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;在经典力学中，系统的动力学完全由&lt;strong&gt;Hamilton函数&lt;/strong&gt;（总能量）决定。对于我们的晶体系统，关键的物理量通过以下微分关系联系：&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;F&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mathbf{F}_i = -\frac{\partial E}{\partial \mathbf{r}_i}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8361em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3117em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.2074em;vertical-align:-0.836em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;−&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.3714em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3117em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05764em;&#34;&gt;E&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.836em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;Φ&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;β&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;β&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;β&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\Phi_{i\alpha,j\beta} = \frac{\partial^2 E}{\partial r_{i\alpha} \partial r_{j\beta}} = -\frac{\partial F_{i\alpha}}{\partial r_{j\beta}}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.9694em;vertical-align:-0.2861em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;Φ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3361em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.0037em;&#34;&gt;α&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05278em;&#34;&gt;β&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2861em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.4632em;vertical-align:-0.9721em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.4911em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3117em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.0037em;&#34;&gt;α&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3361em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05278em;&#34;&gt;β&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2861em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05764em;&#34;&gt;E&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.9721em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.3435em;vertical-align:-0.9721em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;−&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.3714em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3361em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05278em;&#34;&gt;β&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2861em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3117em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.0037em;&#34;&gt;α&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.9721em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;其中$E({\mathbf{r}_i})$是系统总能量，$\mathbf{F}&lt;em&gt;i$是作用在原子$i$上的力，$\Phi&lt;/em&gt;{i\alpha,j\beta}$是力常数矩阵元素。&lt;/p&gt;
&lt;h4&gt;传统方法的困境：一致性问题&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;传统方法的困境一致性问题&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%bc%a0%e7%bb%9f%e6%96%b9%e6%b3%95%e7%9a%84%e5%9b%b0%e5%a2%83%e4%b8%80%e8%87%b4%e6%80%a7%e9%97%ae%e9%a2%98&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;传统的机器学习方法分别训练不同的模型来预测$E$、$\mathbf{F}$和$\Phi$。这种策略存在根本性缺陷：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;热力学不一致性&lt;/strong&gt;：独立训练的模型无法保证$\mathbf{F} = -\nabla E$&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;动力学不一致性&lt;/strong&gt;：力常数与力场之间缺乏微分关系&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;能量守恒违背&lt;/strong&gt;：在分子动力学模拟中导致非物理的能量漂移&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;自动微分的革命性解决方案&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;自动微分的革命性解决方案&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%87%aa%e5%8a%a8%e5%be%ae%e5%88%86%e7%9a%84%e9%9d%a9%e5%91%bd%e6%80%a7%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;自动微分（Automatic Differentiation, AD）&lt;strong&gt;提供了一个数学上严格、计算上高效的解决方案。与数值微分不同，AD能够&lt;/strong&gt;精确&lt;/strong&gt;计算任意函数的导数，精度仅受浮点数表示限制。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;前向模式AD&lt;/strong&gt;：对于函数$f: \mathbb{R}^n \to \mathbb{R}$，前向模式计算方向导数：
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;v&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mrow&gt;&lt;mi&gt;lim&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;ϵ&lt;/mi&gt;&lt;mo&gt;→&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;ϵ&lt;/mi&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;v&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;x&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;ϵ&lt;/mi&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\frac{\partial f}{\partial \mathbf{v}} = \lim_{\epsilon \to 0} \frac{f(\mathbf{x} + \epsilon \mathbf{v}) - f(\mathbf{x})}{\epsilon}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.0574em;vertical-align:-0.686em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.3714em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;mord mathbf&#34; style=&#34;margin-right:0.01597em;&#34;&gt;v&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10764em;&#34;&gt;f&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.686em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.1441em;vertical-align:-0.7171em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.6944em;&#34;&gt;&lt;span style=&#34;top:-2.3829em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;ϵ&lt;/span&gt;&lt;span class=&#34;mrel mtight&#34;&gt;→&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop&#34;&gt;lim&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.7171em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.427em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;ϵ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10764em;&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathbf&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;ϵ&lt;/span&gt;&lt;span class=&#34;mord mathbf&#34; style=&#34;margin-right:0.01597em;&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;−&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10764em;&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathbf&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.686em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;&lt;strong&gt;反向模式AD&lt;/strong&gt;：更适合神经网络的情况，计算梯度：
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∇&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo fence=&#34;true&#34;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mo&gt;…&lt;/mo&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo fence=&#34;true&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\nabla f = \left(\frac{\partial f}{\partial x_1}, \ldots, \frac{\partial f}{\partial x_n}\right)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8889em;vertical-align:-0.1944em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;∇&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10764em;&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.4em;vertical-align:-0.95em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;&lt;span class=&#34;mopen delimcenter&#34; style=&#34;top:0em;&#34;&gt;&lt;span class=&#34;delimsizing size3&#34;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.3714em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3011em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10764em;&#34;&gt;f&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.836em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;minner&#34;&gt;…&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.3714em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.1514em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10764em;&#34;&gt;f&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.836em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose delimcenter&#34; style=&#34;top:0em;&#34;&gt;&lt;span class=&#34;delimsizing size3&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;h4&gt;Hessian矩阵的高效计算&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;hessian矩阵的高效计算&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#hessian%e7%9f%a9%e9%98%b5%e7%9a%84%e9%ab%98%e6%95%88%e8%ae%a1%e7%ae%97&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;力常数矩阵本质上是能量函数的&lt;strong&gt;Hessian矩阵&lt;/strong&gt;。对于包含$N$个原子的系统，这是一个$3N \times 3N$的矩阵，包含$O(N^2)$个元素。&lt;/p&gt;
&lt;p&gt;朴素的计算方法需要$O(N^2)$次反向传播，计算复杂度为$O(N^3)$。我们采用更高效的策略：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;逐原子计算&lt;/strong&gt;：对每个原子$i$，计算$\frac{\partial \mathbf{F}_i}{\partial \mathbf{r}_j}$&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;稀疏性利用&lt;/strong&gt;：利用力常数矩阵的稀疏结构减少计算&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;批处理优化&lt;/strong&gt;：并行计算多个原子对的贡献&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;实现细节：PyTorch中的二阶导数&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;实现细节pytorch中的二阶导数&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ae%9e%e7%8e%b0%e7%bb%86%e8%8a%82pytorch%e4%b8%ad%e7%9a%84%e4%ba%8c%e9%98%b6%e5%af%bc%e6%95%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;在我们的代码中，核心计算流程为：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 第一步：计算能量&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;energy&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 形状: [batch_size]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 第二步：计算力 (一阶导数)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;forces&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;autograd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grad&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;energy&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;create_graph&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;retain_graph&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 形状: [num_atoms, 3]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 第三步：计算力常数 (二阶导数)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;force_constants&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_atoms&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;alpha&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;grad&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;autograd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grad&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;forces&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;alpha&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;retain_graph&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;create_graph&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 形状: [num_atoms, 3]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;force_constants&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grad&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这种方法的关键优势是&lt;strong&gt;数学保证的一致性&lt;/strong&gt;：所有物理量都来自同一个能量函数，自动满足热力学和动力学约束。&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;3. 数据处理管道：从原始数据到训练就绪&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;3-数据处理管道从原始数据到训练就绪&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#3-%e6%95%b0%e6%8d%ae%e5%a4%84%e7%90%86%e7%ae%a1%e9%81%93%e4%bb%8e%e5%8e%9f%e5%a7%8b%e6%95%b0%e6%8d%ae%e5%88%b0%e8%ae%ad%e7%bb%83%e5%b0%b1%e7%bb%aa&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;3.1 我们的数据来源：理解Phonopy的输出&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;31-我们的数据来源理解phonopy的输出&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#31-%e6%88%91%e4%bb%ac%e7%9a%84%e6%95%b0%e6%8d%ae%e6%9d%a5%e6%ba%90%e7%90%86%e8%a7%a3phonopy%e7%9a%84%e8%be%93%e5%87%ba&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;在开始构建神经网络之前，我们需要理解我们的训练数据是什么样的。&lt;/p&gt;
&lt;h4&gt;Phonopy：声子计算的瑞士军刀&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;phonopy声子计算的瑞士军刀&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#phonopy%e5%a3%b0%e5%ad%90%e8%ae%a1%e7%ae%97%e7%9a%84%e7%91%9e%e5%a3%ab%e5%86%9b%e5%88%80&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;Phonopy&lt;/strong&gt;是材料科学中计算声子（晶格振动）性质的标准工具。它的工作流程是这样的：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;输入结构&lt;/strong&gt;：给定一个晶体的原胞结构&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;构建超胞&lt;/strong&gt;：创建一个更大的重复单元&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;微小扰动&lt;/strong&gt;：系统地微移每个原子&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;DFT计算&lt;/strong&gt;：对每种扰动配置计算能量和力&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;有限差分&lt;/strong&gt;：通过数值求导得到力常数&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;我们的训练数据就是这个过程的输出。&lt;/p&gt;
&lt;h4&gt;理解数据格式&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;理解数据格式&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%90%86%e8%a7%a3%e6%95%b0%e6%8d%ae%e6%a0%bc%e5%bc%8f&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;让我们看看实际的数据长什么样：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;phonopy.yaml文件&lt;/strong&gt;（描述晶体结构）：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;supercell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;lattice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;8.123&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0.000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0.000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# 晶格向量&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0.000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;8.123&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0.000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0.000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0.000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;8.123&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;points&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;symbol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Si             &lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# 硅原子&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;coordinates&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mass&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;28.0855&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;symbol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Si&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;coordinates&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0.25&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0.25&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0.25&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mass&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;28.0855&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;FORCE_CONSTANTS文件&lt;/strong&gt;（力常数矩阵）：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;pre&gt;&lt;code&gt;    1    1                    # 原子对 (1,1)
  123.45  0.00  0.00         # 3x3 力常数矩阵
    0.00 123.45  0.00
    0.00   0.00 123.45
    1    2                    # 原子对 (1,2)
  -23.45  0.00  0.00
    0.00 -23.45  0.00
    0.00   0.00 -23.45&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;h3&gt;3.2 从晶体到图：一步步构建数据表示&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;32-从晶体到图一步步构建数据表示&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#32-%e4%bb%8e%e6%99%b6%e4%bd%93%e5%88%b0%e5%9b%be%e4%b8%80%e6%ad%a5%e6%ad%a5%e6%9e%84%e5%bb%ba%e6%95%b0%e6%8d%ae%e8%a1%a8%e7%a4%ba&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;第一步：读取晶体结构&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第一步读取晶体结构&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e4%b8%80%e6%ad%a5%e8%af%bb%e5%8f%96%e6%99%b6%e4%bd%93%e7%bb%93%e6%9e%84&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;我们首先需要将文本格式的数据转换为程序能理解的形式：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;read_phonopy_file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;phonopy_file_path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;yaml_content&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;yaml&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;safe_load&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 提取原子信息&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;supercell_points&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;yaml_content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;supercell&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;points&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 提取晶格信息&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;supercell_lattice&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;yaml_content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;supercell&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;lattice&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;supercell_points&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;supercell_lattice&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这一步看似简单，但它建立了从外部数据到内部表示的桥梁。&lt;/p&gt;
&lt;h4&gt;第二步：坐标变换&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第二步坐标变换&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e4%ba%8c%e6%ad%a5%e5%9d%90%e6%a0%87%e5%8f%98%e6%8d%a2&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;晶体学中通常使用&amp;quot;分数坐标&amp;quot;（相对于晶格向量的坐标），但我们的神经网络需要&amp;quot;笛卡尔坐标&amp;quot;（普通的x,y,z坐标）：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 分数坐标 → 笛卡尔坐标&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;lattice&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tensor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;supercell_lattice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dtype&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;fractional_coords&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tensor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;coordinates&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;atoms&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;cartesian_coords&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;matmul&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fractional_coords&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lattice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这个矩阵乘法完成了坐标系的转换，让我们能够正确计算原子间距离。&lt;/p&gt;
&lt;h4&gt;第三步：构建图的连接关系&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第三步构建图的连接关系&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e4%b8%89%e6%ad%a5%e6%9e%84%e5%bb%ba%e5%9b%be%e7%9a%84%e8%bf%9e%e6%8e%a5%e5%85%b3%e7%b3%bb&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;现在到了关键步骤：决定哪些原子之间应该有边。我们使用一个混合策略：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;threshold&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;8.0&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;# 8埃的距离截断&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;max_neighbors&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;   &lt;span class=&#34;c1&#34;&gt;# 最多32个邻居&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_atoms&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 找到距离最近的邻居&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;distances_to_i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dist_matrix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;nearest_neighbors&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;distances_to_i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;argsort&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;max_neighbors&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nearest_neighbors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;distances_to_i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;threshold&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# 添加边 i -&amp;gt; j&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;edge_list&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这个策略平衡了两个考虑：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;物理合理性&lt;/strong&gt;：距离太远的原子相互作用很弱&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;计算效率&lt;/strong&gt;：限制邻居数量避免图过于稠密&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;第四步：边特征的计算&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第四步边特征的计算&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e5%9b%9b%e6%ad%a5%e8%be%b9%e7%89%b9%e5%be%81%e7%9a%84%e8%ae%a1%e7%ae%97&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;对于每条边，我们需要计算描述原子对关系的特征：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;edge&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;edge_list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;edge&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 边向量（包含方向和距离信息）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;edge_vector&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 距离（标量）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;distance&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;norm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;edge_vector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;edge_vectors&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;edge_vector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;edge_distances&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;distance&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这些边特征将输入到我们的等变图神经网络中。&lt;/p&gt;
&lt;h3&gt;3.3 力常数数据的组织&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;33-力常数数据的组织&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#33-%e5%8a%9b%e5%b8%b8%e6%95%b0%e6%95%b0%e6%8d%ae%e7%9a%84%e7%bb%84%e7%bb%87&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;理解力常数矩阵的结构&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;理解力常数矩阵的结构&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%90%86%e8%a7%a3%e5%8a%9b%e5%b8%b8%e6%95%b0%e7%9f%a9%e9%98%b5%e7%9a%84%e7%bb%93%e6%9e%84&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;力常数矩阵有一个特殊的结构。对于N个原子的体系，完整的力常数矩阵是3N×3N的（每个原子有x,y,z三个方向）。&lt;/p&gt;
&lt;p&gt;但在实际存储中，我们通常将其组织为N×N个3×3的子矩阵，其中每个子矩阵描述原子对(i,j)之间的相互作用。&lt;/p&gt;
&lt;h4&gt;从稀疏到稠密：矩阵重构&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;从稀疏到稠密矩阵重构&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%bb%8e%e7%a8%80%e7%96%8f%e5%88%b0%e7%a8%a0%e5%af%86%e7%9f%a9%e9%98%b5%e9%87%8d%e6%9e%84&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;FORCE_CONSTANTS文件通常只包含非零的矩阵元素。我们需要重构完整的矩阵：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;reconstruct_force_constants_matrix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 初始化零矩阵&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;force_constants_all&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;zeros&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_atoms&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_atoms&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 填充非零元素&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;atom_pair&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;matrix_3x3&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;force_constants&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;items&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;atom_pair&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;force_constants_all&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;matrix_3x3&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 注意索引从0开始&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;force_constants_all&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;h4&gt;矩阵的重塑：适应网络输入&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;矩阵的重塑适应网络输入&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%9f%a9%e9%98%b5%e7%9a%84%e9%87%8d%e5%a1%91%e9%80%82%e5%ba%94%e7%bd%91%e7%bb%9c%e8%be%93%e5%85%a5&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;最后，我们需要将3×3的子矩阵重塑为向量形式，以便输入神经网络：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 将 (N, N, 3, 3) 重塑为 (N*N, 9)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;force_constants_reshaped&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;force_constants_all&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;view&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这个步骤看似技术性，但它反映了深度学习中一个重要的原则：将复杂的数学对象转换为向量，让神经网络能够处理。&lt;/p&gt;
&lt;h3&gt;3.4 数据增强：教会网络物理对称性&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;34-数据增强教会网络物理对称性&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#34-%e6%95%b0%e6%8d%ae%e5%a2%9e%e5%bc%ba%e6%95%99%e4%bc%9a%e7%bd%91%e7%bb%9c%e7%89%a9%e7%90%86%e5%af%b9%e7%a7%b0%e6%80%a7&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;虽然我们的网络在架构上具有等变性，但数据增强仍然是有用的。通过人为地生成更多符合物理对称性的训练样本，我们可以让网络更快地学会这些规律。&lt;/p&gt;
&lt;h4&gt;旋转增强&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;旋转增强&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%97%8b%e8%bd%ac%e5%a2%9e%e5%bc%ba&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;rotate_crystal_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;force_constants&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 生成随机旋转矩阵&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;rotation_matrix&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;generate_random_rotation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 旋转原子坐标&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;pos_rotated&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;matmul&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rotation_matrix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 相应地变换力常数&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;fc_rotated&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;transform_force_constants&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;force_constants&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rotation_matrix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos_rotated&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fc_rotated&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这个过程确保网络见到同一个物理体系的多种方位，强化等变性的学习。&lt;/p&gt;
&lt;h3&gt;3.5 批处理：让训练高效进行&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;35-批处理让训练高效进行&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#35-%e6%89%b9%e5%a4%84%e7%90%86%e8%ae%a9%e8%ae%ad%e7%bb%83%e9%ab%98%e6%95%88%e8%bf%9b%e8%a1%8c&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;最后一个重要的技术细节是批处理。对于图数据，批处理比普通数据更复杂，因为不同的图可能有不同的大小。&lt;/p&gt;
&lt;h4&gt;PyTorch Geometric的解决方案&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;pytorch-geometric的解决方案&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pytorch-geometric%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;PyTorch Geometric库提供了一个巧妙的解决方案：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;图合并&lt;/strong&gt;：将批次中的多个图合并成一个大图&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;索引调整&lt;/strong&gt;：自动调整边的索引，避免冲突&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;批次标记&lt;/strong&gt;：用一个额外的向量记录每个节点属于哪个原始图&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 自动批处理&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;dataloader&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;DataLoader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dataset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch_size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;shuffle&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dataloader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# batch.x: 所有图的节点特征拼接&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# batch.edge_index: 调整后的边索引&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# batch.batch: 节点到图的映射&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;output&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这种设计让我们能够高效地并行处理多个晶体结构，大大提高训练速度。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;通过这三章，我们已经建立了从基本概念到实际实现的完整理解。我们看到了：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;为什么&lt;/strong&gt;需要专门的技术来处理物理问题&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;如何&lt;/strong&gt;将抽象的数学概念转化为具体的算法&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;怎样&lt;/strong&gt;将真实的物理数据转换为可训练的格式&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;深度学习加速晶体力常数预测：模型架构、训练策略与物理验证（续）&lt;/h1&gt;&lt;h2&gt;4. 模型架构详解：从概念验证到产品级实现&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;4-模型架构详解从概念验证到产品级实现&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#4-%e6%a8%a1%e5%9e%8b%e6%9e%b6%e6%9e%84%e8%af%a6%e8%a7%a3%e4%bb%8e%e6%a6%82%e5%bf%b5%e9%aa%8c%e8%af%81%e5%88%b0%e4%ba%a7%e5%93%81%e7%ba%a7%e5%ae%9e%e7%8e%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;4.1 架构演进的思考历程&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;41-架构演进的思考历程&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#41-%e6%9e%b6%e6%9e%84%e6%bc%94%e8%bf%9b%e7%9a%84%e6%80%9d%e8%80%83%e5%8e%86%e7%a8%8b&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;在深度学习项目中，模型架构往往不是一蹴而就的。我们的项目展现了从初步概念到成熟实现的典型演进路径，这种迭代过程体现了科学研究的本质——不断试错、改进和优化。&lt;/p&gt;
&lt;h4&gt;第一阶段：概念验证（GraphTransformer）&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第一阶段概念验证graphtransformer&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e4%b8%80%e9%98%b6%e6%ae%b5%e6%a6%82%e5%bf%b5%e9%aa%8c%e8%af%81graphtransformer&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;最初，我们从最直观的想法开始：能否用传统的图卷积网络加上Transformer来处理晶体结构？&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# module.py中的初代模型&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;GraphTransformer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;node_features&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_layers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;heads&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;GraphTransformer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;conv1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;GCNConv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;node_features&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;conv2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;GCNConv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;transformer_encoder_layer&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TransformerEncoderLayer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d_model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nhead&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;heads&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;transformer_encoder&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TransformerEncoder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;transformer_encoder_layer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_layers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这个初代模型有着明显的局限性：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;缺乏几何等变性&lt;/strong&gt;：标准的GCN和Transformer无法处理3D旋转对称性&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;特征表示简单&lt;/strong&gt;：只使用标量特征，忽略了张量性质&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;物理意义模糊&lt;/strong&gt;：输出直接预测9维力常数向量，缺乏物理约束&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;从训练脚本中可以看到，最初我们使用的是：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# scripts/train_1.sh 中被注释的旧版本&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# python -u main.py \&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#     --model-name &amp;#39;graph_attention_transformer_nonlinear_l2_e3_noNorm&amp;#39; \&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;h4&gt;第二阶段：等变化改造（GraphAttentionTransformer）&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第二阶段等变化改造graphattentiontransformer&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e4%ba%8c%e9%98%b6%e6%ae%b5%e7%ad%89%e5%8f%98%e5%8c%96%e6%94%b9%e9%80%a0graphattentiontransformer&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;认识到几何对称性的重要性后，我们开始引入E3NN框架，构建真正的等变图神经网络：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;GraphAttentionTransformer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;irreps_in&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;86x0e&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;irreps_out&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;1x0e+1x1o+1x2e&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 输出包含多种阶数&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;irreps_node_embedding&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;128x0e+64x1e+32x2e&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;irreps_sh&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;1x0e+1x1e+1x2e&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这个版本的关键改进：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;等变架构&lt;/strong&gt;：基于E3NN框架，保持SO(3)对称性&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;多阶表示&lt;/strong&gt;：使用标量、向量、张量的组合表示&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;物理输出&lt;/strong&gt;：输出irreps包含不同阶的物理量&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;然而，这个版本仍然存在问题：&lt;strong&gt;我们直接预测力常数，而不是从能量推导&lt;/strong&gt;。&lt;/p&gt;
&lt;h4&gt;第三阶段：自动微分革命（GraphAttentionTransformer_dx系列）&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第三阶段自动微分革命graphattentiontransformer_dx系列&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e4%b8%89%e9%98%b6%e6%ae%b5%e8%87%aa%e5%8a%a8%e5%be%ae%e5%88%86%e9%9d%a9%e5%91%bdgraphattentiontransformer_dx%e7%b3%bb%e5%88%97&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;关键的突破来自于物理一致性的考虑。我们意识到应该从&lt;strong&gt;能量函数&lt;/strong&gt;出发，通过自动微分计算力常数：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# scripts/train_1.sh 中的新版本&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;python -u main_re.py &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    --model-name &lt;span class=&#34;s1&#34;&gt;&amp;#39;graph_attention_transformer_nonlinear_l2_e3_noNorm_dx&amp;#39;&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;\&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;注意这里的关键变化：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;main.py&lt;/code&gt; → &lt;code&gt;main_re.py&lt;/code&gt;：重构了主训练脚本&lt;/li&gt;
&lt;li&gt;模型名加上&lt;code&gt;_dx&lt;/code&gt;后缀：标志着自动微分版本&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;4.2 GraphAttentionTransformer_dx架构深度解析&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;42-graphattentiontransformer_dx架构深度解析&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#42-graphattentiontransformer_dx%e6%9e%b6%e6%9e%84%e6%b7%b1%e5%ba%a6%e8%a7%a3%e6%9e%90&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;输出的根本性变化&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;输出的根本性变化&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%be%93%e5%87%ba%e7%9a%84%e6%a0%b9%e6%9c%ac%e6%80%a7%e5%8f%98%e5%8c%96&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;最关键的架构变化是输出层的设计思路：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;GraphAttentionTransformer_dx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;irreps_out&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;1x0e&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 只输出标量能量！&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这个看似简单的改变具有深远的意义：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;传统方法&lt;/strong&gt;：&lt;code&gt;irreps_out=&#39;1x0e+1x1o+1x2e&#39;&lt;/code&gt; → 直接预测多种物理量&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;dx方法&lt;/strong&gt;：&lt;code&gt;irreps_out=&#39;1x0e&#39;&lt;/code&gt; → 只预测标量能量，其他量通过微分得到&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;核心组件架构&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;核心组件架构&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%a0%b8%e5%bf%83%e7%bb%84%e4%bb%b6%e6%9e%b6%e6%9e%84&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;1. NodeEmbeddingNetwork：原子特征的等变编码&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;atom_embed&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;NodeEmbeddingNetwork&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;irreps_node_embedding&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_MAX_ATOM_TYPE&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这个模块将86种化学元素的one-hot编码转换为等变特征表示。关键在于它不仅仅是简单的嵌入层，而是&lt;strong&gt;等变嵌入&lt;/strong&gt;：&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;Embedding&lt;/mtext&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mtext&gt;atom_type&lt;/mtext&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mathbf{h}_i^{(0)} = \text{Embedding}(\text{atom\_type}_i)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.3217em;vertical-align:-0.2769em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.0448em;&#34;&gt;&lt;span style=&#34;top:-2.4231em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2198em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2769em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.1097em;vertical-align:-0.3597em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;Embedding&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord text&#34;&gt;&lt;span class=&#34;mord&#34;&gt;atom_type&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.102em;&#34;&gt;&lt;span style=&#34;top:-2.3403em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3597em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;其中$\mathbf{h}_i^{(0)}$是原子$i$的标量特征。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2. EdgeDegreeEmbeddingNetwork：边信息的几何编码&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;edge_deg_embed&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;EdgeDegreeEmbeddingNetwork&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;irreps_node_embedding&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;irreps_edge_attr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fc_neurons&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;_AVG_DEGREE&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这个组件处理边的几何信息，将距离和方向分别编码：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;径向信息&lt;/strong&gt;：通过高斯径向基函数$\phi_k(r)$处理&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;角度信息&lt;/strong&gt;：通过球谐函数$Y_l^m(\hat{\mathbf{r}})$处理&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;3. TransBlock：等变注意力的核心&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;每个TransBlock实现了等变消息传递：&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;m&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;∑&lt;/mo&gt;&lt;mtext&gt;path&lt;/mtext&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mtext&gt;path&lt;/mtext&gt;&lt;/msub&gt;&lt;mo&gt;⋅&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;⊗&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;Y&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;r&lt;/mi&gt;&lt;mo&gt;^&lt;/mo&gt;&lt;/mover&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;⊗&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;msubsup&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mtext&gt;path&lt;/mtext&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mathbf{m}_{ij}^{(l)} = \sum_{\text{path}} W_{\text{path}} \cdot (\mathbf{h}_i^{(l_1)} \otimes \mathbf{Y}_l(\hat{\mathbf{r}}_{ij}) \otimes R(r_{ij}))_{\text{path}}^{(l)}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.4578em;vertical-align:-0.413em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.0448em;&#34;&gt;&lt;span style=&#34;top:-2.4231em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;ij&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2198em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.413em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.4882em;vertical-align:-1.4382em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.05em;&#34;&gt;&lt;span style=&#34;top:-1.8479em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord text mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;path&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.4382em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;W&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3361em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord text mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;path&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2861em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;⋅&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.3217em;vertical-align:-0.2769em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.0448em;&#34;&gt;&lt;span style=&#34;top:-2.4231em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2198em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3173em;&#34;&gt;&lt;span style=&#34;top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size3 size1 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.143em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2769em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;⊗&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.0361em;vertical-align:-0.2861em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34; style=&#34;margin-right:0.02875em;&#34;&gt;Y&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3361em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0288em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.7079em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathbf&#34;&gt;r&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.0134em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.1944em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;^&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3117em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;ij&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2861em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;⊗&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.4822em;vertical-align:-0.4374em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.00773em;&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3117em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;ij&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2861em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.0448em;&#34;&gt;&lt;span style=&#34;top:-2.3987em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord text mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;path&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2198em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.4374em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;其中张量积$\otimes$通过Clebsch-Gordan系数实现。&lt;/p&gt;
&lt;h4&gt;多版本迭代的技术细节&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;多版本迭代的技术细节&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%a4%9a%e7%89%88%e6%9c%ac%e8%bf%ad%e4%bb%a3%e7%9a%84%e6%8a%80%e6%9c%af%e7%bb%86%e8%8a%82&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;我们的代码中存在四个版本的dx模型，每个版本都解决了特定的技术问题：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;GraphAttentionTransformer_dx（v1）&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;基础的自动微分实现&lt;/li&gt;
&lt;li&gt;直接从边特征预测能量&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;GraphAttentionTransformer_dx_v2&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;改进了聚合机制，使用&lt;code&gt;scatter_mean&lt;/code&gt;替代简单求和&lt;/li&gt;
&lt;li&gt;更好的批处理支持&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;GraphAttentionTransformer_dx_v3&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;优化了梯度流，添加了&lt;code&gt;trace_grad_fn&lt;/code&gt;调试工具&lt;/li&gt;
&lt;li&gt;改进了内存管理&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;GraphAttentionTransformer_dx_v4&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;最终的产品版本，集成了所有改进&lt;/li&gt;
&lt;li&gt;最优的计算效率和数值稳定性&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;4.3 关键技术决策的物理动机&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;43-关键技术决策的物理动机&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#43-%e5%85%b3%e9%94%ae%e6%8a%80%e6%9c%af%e5%86%b3%e7%ad%96%e7%9a%84%e7%89%a9%e7%90%86%e5%8a%a8%e6%9c%ba&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;为什么选择标量输出？&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;为什么选择标量输出&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%b8%ba%e4%bb%80%e4%b9%88%e9%80%89%e6%8b%a9%e6%a0%87%e9%87%8f%e8%be%93%e5%87%ba&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;这个决策背后有深刻的物理原理：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;热力学第一定律&lt;/strong&gt;：能量是状态函数，只依赖于系统的配置&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;变分原理&lt;/strong&gt;：平衡态对应能量极值，所有其他量都是能量的函数&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;微分几何&lt;/strong&gt;：力常数是能量函数的Hessian矩阵，数学上完全确定&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;irreps配置的物理意义&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;irreps配置的物理意义&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#irreps%e9%85%8d%e7%bd%ae%e7%9a%84%e7%89%a9%e7%90%86%e6%84%8f%e4%b9%89&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;irreps_node_embedding&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;128x0e+64x1e+32x2e&amp;#39;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这个配置体现了&lt;strong&gt;物理量的层次结构&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;128x0e&lt;/strong&gt;：大量标量特征，捕获化学环境、电子密度等&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;64x1e&lt;/strong&gt;：中等数量的向量特征，处理偶极矩、局部电场等&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;32x2e&lt;/strong&gt;：少量张量特征，直接关联力常数、应力等&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;数量比例&lt;strong&gt;128:64:32&lt;/strong&gt;反映了一个重要的物理直觉：标量信息最基础，张量信息最稀缺但最重要。&lt;/p&gt;
&lt;h4&gt;正则化策略的选择&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;正则化策略的选择&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%ad%a3%e5%88%99%e5%8c%96%e7%ad%96%e7%95%a5%e7%9a%84%e9%80%89%e6%8b%a9&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;norm_layer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;layer&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;alpha_drop&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;proj_drop&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;out_drop&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这种配置的考虑：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;LayerNorm vs BatchNorm&lt;/strong&gt;：LayerNorm在小批量下更稳定，适合昂贵的物理计算&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;注意力dropout vs 特征dropout&lt;/strong&gt;：只在注意力权重上应用dropout，保持特征的等变性&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;输出层不dropout&lt;/strong&gt;：确保能量预测的确定性&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2&gt;5. 训练策略与损失函数：监督学习的物理化设计&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;5-训练策略与损失函数监督学习的物理化设计&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#5-%e8%ae%ad%e7%bb%83%e7%ad%96%e7%95%a5%e4%b8%8e%e6%8d%9f%e5%a4%b1%e5%87%bd%e6%95%b0%e7%9b%91%e7%9d%a3%e5%ad%a6%e4%b9%a0%e7%9a%84%e7%89%a9%e7%90%86%e5%8c%96%e8%ae%be%e8%ae%a1&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;5.1 监督学习范式：为什么不选择PINN？&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;51-监督学习范式为什么不选择pinn&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#51-%e7%9b%91%e7%9d%a3%e5%ad%a6%e4%b9%a0%e8%8c%83%e5%bc%8f%e4%b8%ba%e4%bb%80%e4%b9%88%e4%b8%8d%e9%80%89%e6%8b%a9pinn&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;在开始详细讨论训练策略之前，我们需要理解一个重要的方法论选择：&lt;strong&gt;为什么采用监督学习而不是物理信息神经网络（PINN）？&lt;/strong&gt;&lt;/p&gt;
&lt;h4&gt;PINN方法的理论吸引力&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;pinn方法的理论吸引力&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pinn%e6%96%b9%e6%b3%95%e7%9a%84%e7%90%86%e8%ae%ba%e5%90%b8%e5%bc%95%e5%8a%9b&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;物理信息神经网络的核心思想是将物理定律直接编码到损失函数中：&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mtext&gt;PINN&lt;/mtext&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mtext&gt;data&lt;/mtext&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mtext&gt;physics&lt;/mtext&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;L_{\text{PINN}} = L_{\text{data}} + \lambda L_{\text{physics}}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8333em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3283em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord text mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;PINN&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8333em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3361em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord text mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;data&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.9805em;vertical-align:-0.2861em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;λ&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3361em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord text mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;physics&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2861em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;其中物理损失可能包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;力的一致性&lt;/strong&gt;：$L_{\text{force}} = |\mathbf{F}&lt;em&gt;{\text{pred}} + \nabla&lt;/em&gt;{\mathbf{r}} E_{\text{pred}}|^2$&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;动力学方程&lt;/strong&gt;：$L_{\text{dynamics}} = |m\ddot{\mathbf{r}} - \mathbf{F}|^2$&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;对称性约束&lt;/strong&gt;：$L_{\text{symmetry}} = |E(g \cdot \mathbf{r}) - E(\mathbf{r})|^2$&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;我们选择监督学习的实际考量&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;我们选择监督学习的实际考量&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%88%91%e4%bb%ac%e9%80%89%e6%8b%a9%e7%9b%91%e7%9d%a3%e5%ad%a6%e4%b9%a0%e7%9a%84%e5%ae%9e%e9%99%85%e8%80%83%e9%87%8f&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;尽管PINN在理论上很吸引人，我们最终选择了监督学习方案，主要基于以下考虑：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1. 数据质量与可用性&lt;/strong&gt;
我们拥有高质量的DFT计算数据，包含：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;精确的晶体结构&lt;/li&gt;
&lt;li&gt;可靠的力常数矩阵&lt;/li&gt;
&lt;li&gt;一致的计算设置&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在这种情况下，利用高质量监督信号比强加物理约束更有效。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2. 等变架构的隐式物理约束&lt;/strong&gt;
我们的E3NN架构本身就编码了重要的物理定律：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;对称性&lt;/strong&gt;：通过群论自动满足&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;局部性&lt;/strong&gt;：通过图结构体现&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;微分关系&lt;/strong&gt;：通过自动微分保证&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;3. 训练稳定性&lt;/strong&gt;
PINN的训练往往面临困难：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;多个损失项的权重平衡&lt;/li&gt;
&lt;li&gt;不同物理约束之间的冲突&lt;/li&gt;
&lt;li&gt;收敛性的不确定性&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;5.2 损失函数的精细设计&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;52-损失函数的精细设计&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#52-%e6%8d%9f%e5%a4%b1%e5%87%bd%e6%95%b0%e7%9a%84%e7%b2%be%e7%bb%86%e8%ae%be%e8%ae%a1&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;FrobeniusNormLoss：矩阵范数的几何直觉&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;frobeniusnormloss矩阵范数的几何直觉&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#frobeniusnormloss%e7%9f%a9%e9%98%b5%e8%8c%83%e6%95%b0%e7%9a%84%e5%87%a0%e4%bd%95%e7%9b%b4%e8%a7%89&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;FrobeniusNormLoss&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;forward&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;target&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;norm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fro&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dim&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                          &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;norm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;target&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fro&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dim&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这个损失函数的设计体现了深刻的几何直觉。Frobenius范数：&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∥&lt;/mi&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;A&lt;/mi&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∥&lt;/mi&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mo&gt;∑&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msubsup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;/msqrt&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\|\mathbf{A}\|_F = \sqrt{\sum_{i,j} A_{ij}^2}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;∥&lt;/span&gt;&lt;span class=&#34;mord mathbf&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;∥&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3283em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;F&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:3.04em;vertical-align:-1.588em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord sqrt&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.452em;&#34;&gt;&lt;span class=&#34;svg-align&#34; style=&#34;top:-5em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;padding-left:1em;&#34;&gt;&lt;span class=&#34;mop op-limits&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.05em;&#34;&gt;&lt;span style=&#34;top:-1.8723em;margin-left:0em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mpunct mtight&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3.05em;&#34;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&#34;mop op-symbol large-op&#34;&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.4138em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.1667em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.7959em;&#34;&gt;&lt;span style=&#34;top:-2.4231em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;ij&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.0448em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.413em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.412em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:5em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;hide-tail&#34; style=&#34;min-width:1.02em;height:3.08em;&#34;&gt;&lt;svg xmlns=&#34;http://www.w3.org/2000/svg&#34; width=&#34;400em&#34; height=&#34;3.08em&#34; viewBox=&#34;0 0 400000 3240&#34; preserveAspectRatio=&#34;xMinYMin slice&#34;&gt;&lt;path d=&#34;M473,2793
c339.3,-1799.3,509.3,-2700,510,-2702 l0 -0
c3.3,-7.3,9.3,-11,18,-11 H400000v40H1017.7
s-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200
c0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26
s76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,
606zM1001 80h400000v40H1017.7z&#34;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.588em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;在力常数矩阵的语境下具有清晰的物理意义：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;总相互作用强度&lt;/strong&gt;：$|\Phi|_F$衡量原子间总的耦合强度&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;旋转不变性&lt;/strong&gt;：Frobenius范数在正交变换下不变&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;尺度感知性&lt;/strong&gt;：能够感知不同原子对贡献的差异&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;EigenLoss：频谱信息的物理洞察&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;eigenloss频谱信息的物理洞察&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#eigenloss%e9%a2%91%e8%b0%b1%e4%bf%a1%e6%81%af%e7%9a%84%e7%89%a9%e7%90%86%e6%b4%9e%e5%af%9f&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;EigenLoss&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;forward&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;target&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;loss_1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;target&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;loss_2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;sum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;norm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dim&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;             &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;norm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;target&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dim&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;loss_1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;loss_2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这个损失函数基于力常数矩阵的&lt;strong&gt;特征值分解&lt;/strong&gt;：&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;Φ&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;Λ&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\Phi = Q \Lambda Q^T&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.6833em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;Φ&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.0858em;vertical-align:-0.1944em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Q&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;Λ&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;Q&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8913em;&#34;&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;其中$\Lambda = \text{diag}(\lambda_1, \lambda_2, \lambda_3)$是特征值矩阵。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;物理动机&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;特征值&lt;/strong&gt;对应正常模式的频率：$\omega_i = \sqrt{\lambda_i/m}$&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;特征向量&lt;/strong&gt;对应振动模式的形状&lt;/li&gt;
&lt;li&gt;这种分解直接关联到&lt;strong&gt;声子谱&lt;/strong&gt;的计算&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;损失函数的两项分别处理：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;loss_1&lt;/code&gt;：特征值的准确性（频率匹配）&lt;/li&gt;
&lt;li&gt;&lt;code&gt;loss_2&lt;/code&gt;：特征向量方向的准确性（模式形状匹配）&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;损失函数选择的实验验证&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;损失函数选择的实验验证&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%8d%9f%e5%a4%b1%e5%87%bd%e6%95%b0%e9%80%89%e6%8b%a9%e7%9a%84%e5%ae%9e%e9%aa%8c%e9%aa%8c%e8%af%81&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;在我们的实验中，我们比较了不同损失函数的效果：&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;损失函数&lt;/th&gt;
          &lt;th&gt;训练稳定性&lt;/th&gt;
          &lt;th&gt;物理一致性&lt;/th&gt;
          &lt;th&gt;计算效率&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;MSE&lt;/td&gt;
          &lt;td&gt;高&lt;/td&gt;
          &lt;td&gt;中&lt;/td&gt;
          &lt;td&gt;高&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;FrobeniusNorm&lt;/td&gt;
          &lt;td&gt;中&lt;/td&gt;
          &lt;td&gt;高&lt;/td&gt;
          &lt;td&gt;中&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;EigenLoss&lt;/td&gt;
          &lt;td&gt;中&lt;/td&gt;
          &lt;td&gt;最高&lt;/td&gt;
          &lt;td&gt;低&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;组合损失&lt;/td&gt;
          &lt;td&gt;最高&lt;/td&gt;
          &lt;td&gt;高&lt;/td&gt;
          &lt;td&gt;中&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;最终我们采用了&lt;strong&gt;自适应组合策略&lt;/strong&gt;：
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mtext&gt;MSE&lt;/mtext&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;β&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mtext&gt;Frobenius&lt;/mtext&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;γ&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mtext&gt;Eigen&lt;/mtext&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;L = \alpha L_{\text{MSE}} + \beta L_{\text{Frobenius}} + \gamma L_{\text{Eigen}}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.6833em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8333em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;α&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3283em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord text mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;MSE&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8889em;vertical-align:-0.1944em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05278em;&#34;&gt;β&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3361em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord text mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;Frobenius&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.9694em;vertical-align:-0.2861em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05556em;&#34;&gt;γ&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3283em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord text mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;Eigen&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2861em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;其中权重$\alpha, \beta, \gamma$在训练过程中动态调整。&lt;/p&gt;
&lt;h3&gt;5.3 优化策略的系统化设计&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;53-优化策略的系统化设计&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#53-%e4%bc%98%e5%8c%96%e7%ad%96%e7%95%a5%e7%9a%84%e7%b3%bb%e7%bb%9f%e5%8c%96%e8%ae%be%e8%ae%a1&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;AdamW：修正的Adam优化器&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;adamw修正的adam优化器&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#adamw%e4%bf%ae%e6%ad%a3%e7%9a%84adam%e4%bc%98%e5%8c%96%e5%99%a8&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;我们选择AdamW而不是标准Adam，主要考虑：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;optimizer&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;optim&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;AdamW&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;parameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;lr&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;5e-5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;weight_decay&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;5e-3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;betas&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.999&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;eps&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1e-8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;AdamW的技术优势&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;解耦权重衰减&lt;/strong&gt;：$\theta_{t+1} = \theta_t - \eta(\frac{m_t}{\sqrt{v_t} + \epsilon} + \lambda\theta_t)$&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;更好的泛化性能&lt;/strong&gt;：避免了Adam中权重衰减与梯度的耦合&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;稳定的收敛性&lt;/strong&gt;：在大规模模型上表现更稳定&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;余弦退火学习率：模拟物理退火过程&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;余弦退火学习率模拟物理退火过程&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%bd%99%e5%bc%a6%e9%80%80%e7%81%ab%e5%ad%a6%e4%b9%a0%e7%8e%87%e6%a8%a1%e6%8b%9f%e7%89%a9%e7%90%86%e9%80%80%e7%81%ab%e8%bf%87%e7%a8%8b&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;scheduler&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;optim&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lr_scheduler&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CosineAnnealingLR&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;optimizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;T_max&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;epochs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;eta_min&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1e-6&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;余弦退火策略模拟了&lt;strong&gt;物理退火过程&lt;/strong&gt;：
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;η&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;η&lt;/mi&gt;&lt;mtext&gt;min&lt;/mtext&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;η&lt;/mi&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/msub&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;η&lt;/mi&gt;&lt;mtext&gt;min&lt;/mtext&gt;&lt;/msub&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;π&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\eta_t = \eta_{\text{min}} + \frac{1}{2}(\eta_{\text{max}} - \eta_{\text{min}})(1 + \cos(\frac{t\pi}{T}))&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.625em;vertical-align:-0.1944em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;η&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2806em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.7778em;vertical-align:-0.1944em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;η&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3175em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord text mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;min&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.0074em;vertical-align:-0.686em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.3214em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.686em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;η&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.1514em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord text mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;max&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;−&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;η&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3175em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord text mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;min&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.9781em;vertical-align:-0.686em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mop&#34;&gt;cos&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.2921em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;π&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.686em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;))&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;&lt;strong&gt;物理类比&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;高温阶段&lt;/strong&gt;（大学习率）：允许大幅参数调整，跳出局部极值&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;降温阶段&lt;/strong&gt;（学习率衰减）：逐渐细化，寻找精确解&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;低温阶段&lt;/strong&gt;（小学习率）：微调参数，达到最终平衡&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;EMA：指数移动平均的统计力学解释&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;ema指数移动平均的统计力学解释&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#ema%e6%8c%87%e6%95%b0%e7%a7%bb%e5%8a%a8%e5%b9%b3%e5%9d%87%e7%9a%84%e7%bb%9f%e8%ae%a1%e5%8a%9b%e5%ad%a6%e8%a7%a3%e9%87%8a&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;model_ema&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ModelEmaV2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;decay&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.9999&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;device&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;cpu&amp;#39;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model_ema_force_cpu&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;EMA可以从&lt;strong&gt;统计力学&lt;/strong&gt;的角度理解：
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;θ&lt;/mi&gt;&lt;mtext&gt;ema&lt;/mtext&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;θ&lt;/mi&gt;&lt;mtext&gt;ema&lt;/mtext&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;θ&lt;/mi&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\theta_{\text{ema}}^{(t)} = \alpha \theta_{\text{ema}}^{(t-1)} + (1-\alpha) \theta^{(t)}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.185em;vertical-align:-0.247em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;θ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.938em;&#34;&gt;&lt;span style=&#34;top:-2.453em;margin-left:-0.0278em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord text mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;ema&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.247em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.185em;vertical-align:-0.247em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;α&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;θ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.938em;&#34;&gt;&lt;span style=&#34;top:-2.453em;margin-left:-0.0278em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord text mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;ema&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mbin mtight&#34;&gt;−&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.247em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;−&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.188em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.0037em;&#34;&gt;α&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;θ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.938em;&#34;&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;这相当于在参数空间中维护一个&lt;strong&gt;热平衡态的系综平均&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;减少随机梯度的噪声影响&lt;/li&gt;
&lt;li&gt;提供更稳定的模型性能&lt;/li&gt;
&lt;li&gt;类似于分子动力学中的&lt;strong&gt;温度控制器&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;梯度裁剪：防止数值不稳定&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;梯度裁剪防止数值不稳定&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%a2%af%e5%ba%a6%e8%a3%81%e5%89%aa%e9%98%b2%e6%ad%a2%e6%95%b0%e5%80%bc%e4%b8%8d%e7%a8%b3%e5%ae%9a&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;clip_grad&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;utils&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clip_grad_norm_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;parameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;max_norm&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clip_grad&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;在物理系统的深度学习中，梯度爆炸是常见问题，特别是涉及：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;长程相互作用&lt;/strong&gt;：导致梯度在空间上快速传播&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;多尺度动力学&lt;/strong&gt;：不同时间尺度的耦合&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;临界现象&lt;/strong&gt;：接近相变点时的敏感性&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;梯度裁剪提供了数值稳定性的保障。&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;6. 自动微分与物理验证：从数学到物理的桥梁&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;6-自动微分与物理验证从数学到物理的桥梁&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#6-%e8%87%aa%e5%8a%a8%e5%be%ae%e5%88%86%e4%b8%8e%e7%89%a9%e7%90%86%e9%aa%8c%e8%af%81%e4%bb%8e%e6%95%b0%e5%ad%a6%e5%88%b0%e7%89%a9%e7%90%86%e7%9a%84%e6%a1%a5%e6%a2%81&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;6.1 三种计算策略的技术对比&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;61-三种计算策略的技术对比&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#61-%e4%b8%89%e7%a7%8d%e8%ae%a1%e7%ae%97%e7%ad%96%e7%95%a5%e7%9a%84%e6%8a%80%e6%9c%af%e5%af%b9%e6%af%94&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;我们的项目实现了三种不同的Hessian矩阵计算方法，每种方法都有其独特的技术特点和适用场景。&lt;/p&gt;
&lt;h4&gt;6.1.1 train_one_epoch_dx：精确自动微分&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;611-train_one_epoch_dx精确自动微分&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#611-train_one_epoch_dx%e7%b2%be%e7%a1%ae%e8%87%aa%e5%8a%a8%e5%be%ae%e5%88%86&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;这是我们的主要方法，基于PyTorch的自动微分机制：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;train_one_epoch_dx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;criterion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data_loader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;optimizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;device&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;epoch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;step&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;enumerate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data_loader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;requires_grad_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 逐样本处理确保梯度隔离&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sample_idx&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unique&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;sample_mask&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sample_idx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;sample_pos&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sample_mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# 第一步：能量预测&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;energy&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sample_mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# 第二步：力计算（一阶导数）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;forces&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;autograd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grad&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;energy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sample_pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;create_graph&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# 第三步：力常数计算（二阶导数）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;force_constants_list&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;alpha&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;n&#34;&gt;grad&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;autograd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grad&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;n&#34;&gt;forces&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;alpha&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sample_pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;n&#34;&gt;retain_graph&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;create_graph&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;n&#34;&gt;force_constants_list&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grad&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;技术优势&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;数学精确性&lt;/strong&gt;：精度仅受浮点数表示限制&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;自动一致性&lt;/strong&gt;：力与力常数的微分关系自动满足&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;内存效率&lt;/strong&gt;：动态计算图，只保存必要的中间结果&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;计算复杂度分析&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;时间复杂度：$O(N^2 \cdot C)$，其中$N$是原子数，$C$是模型计算复杂度&lt;/li&gt;
&lt;li&gt;空间复杂度：$O(N^2 \cdot P)$，其中$P$是模型参数数量&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;6.1.2 train_one_epoch_fd：有限差分方法&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;612-train_one_epoch_fd有限差分方法&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#612-train_one_epoch_fd%e6%9c%89%e9%99%90%e5%b7%ae%e5%88%86%e6%96%b9%e6%b3%95&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;作为对比基线，我们实现了有限差分版本：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;compute_hessian_finite_difference&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;epsilon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1e-6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clone&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;detach&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;zeros&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;alpha&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# 正向扰动&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;pos_plus&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clone&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;pos_plus&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;alpha&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;epsilon&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;energy_plus&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos_plus&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# 负向扰动&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;pos_minus&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clone&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;pos_minus&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;alpha&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;epsilon&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;energy_minus&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos_minus&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# 中心差分&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;beta&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;n&#34;&gt;pos_plus_plus&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos_plus&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clone&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;n&#34;&gt;pos_plus_plus&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;beta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;epsilon&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;n&#34;&gt;energy_plus_plus&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos_plus_plus&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;c1&#34;&gt;# ... (其他三个点的计算)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;alpha&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;beta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;n&#34;&gt;energy_plus_plus&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;energy_plus_minus&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        &lt;span class=&#34;n&#34;&gt;energy_minus_plus&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;energy_minus_minus&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;epsilon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;数值分析考虑&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;截断误差&lt;/strong&gt;：$O(\epsilon^2)$对于中心差分&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;舍入误差&lt;/strong&gt;：$O(\frac{\text{machine_eps}}{\epsilon^2})$&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;最优步长&lt;/strong&gt;：$\epsilon_{\text{opt}} = (\text{machine_eps})^{1/4}$&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;6.1.3 train_one_epoch_kfac：Kronecker分解近似&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;613-train_one_epoch_kfackronecker分解近似&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#613-train_one_epoch_kfackronecker%e5%88%86%e8%a7%a3%e8%bf%91%e4%bc%bc&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;K-FAC（Kronecker-factored Approximate Curvature）方法基于以下近似：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;kfac_hessian_approximation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model_pred_fn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sample_pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;damping&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1e-2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 计算雅可比矩阵&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;jacobian&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;autograd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;functional&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;jacobian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model_pred_fn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sample_pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# K-FAC近似：假设Hessian可以分解为Kronecker积&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# H ≈ A ⊗ B，其中A和B是低维矩阵&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 对于我们的应用，使用对角近似&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sample_pos&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;diag_approx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;zeros&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;alpha&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# 只计算对角块&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;diag_approx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;alpha&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;alpha&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;jacobian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;alpha&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;jacobian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;alpha&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;damping&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;diag_approx&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;理论基础&lt;/strong&gt;：
K-FAC基于&lt;strong&gt;Gauss-Newton近似&lt;/strong&gt;：
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;H&lt;/mi&gt;&lt;mo&gt;≈&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;J&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;J&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;mi mathvariant=&#34;bold&#34;&gt;I&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\mathbf{H} \approx \mathbf{J}^T \mathbf{J} + \lambda \mathbf{I}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.6861em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathbf&#34;&gt;H&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;≈&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.9747em;vertical-align:-0.0833em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathbf&#34;&gt;J&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8913em;&#34;&gt;&lt;span style=&#34;top:-3.113em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.13889em;&#34;&gt;T&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathbf&#34;&gt;J&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.6944em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;λ&lt;/span&gt;&lt;span class=&#34;mord mathbf&#34;&gt;I&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;其中$\mathbf{J}$是雅可比矩阵，$\lambda$是阻尼参数。&lt;/p&gt;
&lt;h3&gt;6.2 evaluate_dx：物理一致性的实时验证&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;62-evaluate_dx物理一致性的实时验证&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#62-evaluate_dx%e7%89%a9%e7%90%86%e4%b8%80%e8%87%b4%e6%80%a7%e7%9a%84%e5%ae%9e%e6%97%b6%e9%aa%8c%e8%af%81&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;评估函数不仅计算预测精度，更重要的是验证物理一致性：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;evaluate_dx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data_loader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;device&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;amp_autocast&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;logger&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;eval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;step&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;enumerate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data_loader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;requires_grad_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;no_grad&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 评估时不需要梯度&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sample_idx&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unique&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;sample_pos&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sample_mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;sample_pos&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;requires_grad_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;c1&#34;&gt;# 使用函数式接口计算Hessian&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;model_pred&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;autograd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;functional&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;n&#34;&gt;model_pred&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sample_pos&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;c1&#34;&gt;# 物理一致性检查&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;symmetry_error&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;check_symmetry&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;positivity_error&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;check_positive_definiteness&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;logger&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Symmetry error: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;symmetry_error&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.6f&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;logger&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Positivity violation: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;positivity_error&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.6f&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;h4&gt;物理一致性检查的具体实现&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;物理一致性检查的具体实现&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%89%a9%e7%90%86%e4%b8%80%e8%87%b4%e6%80%a7%e6%a3%80%e6%9f%a5%e7%9a%84%e5%85%b7%e4%bd%93%e5%ae%9e%e7%8e%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;1. 对称性验证&lt;/strong&gt;：
力常数矩阵必须满足$\Phi_{ij} = \Phi_{ji}^T$&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;check_symmetry&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;//&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;reshaped&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;view&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;symmetry_error&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;reshaped&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;reshaped&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;transpose&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;transpose&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;symmetry_error&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;2. 正定性检查&lt;/strong&gt;：
对于稳定的晶体，力常数矩阵应该是正半定的&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;check_positive_definiteness&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;eigenvals&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;linalg&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;eigvals&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;negative_eigenvals&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;eigenvals&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;eigenvals&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1e-6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;negative_eigenvals&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;h3&gt;6.3 计算效率的系统化优化&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;63-计算效率的系统化优化&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#63-%e8%ae%a1%e7%ae%97%e6%95%88%e7%8e%87%e7%9a%84%e7%b3%bb%e7%bb%9f%e5%8c%96%e4%bc%98%e5%8c%96&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;内存管理策略&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;内存管理策略&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%86%85%e5%ad%98%e7%ae%a1%e7%90%86%e7%ad%96%e7%95%a5&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;自动微分的内存消耗可能很大，我们采用了多种优化策略：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1. 分块计算&lt;/strong&gt;：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 对于大系统，分块计算Hessian&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;chunk_size&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;64&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 根据GPU内存调整&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;chunk_start&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;total_size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;chunk_size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;chunk_end&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;min&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;chunk_start&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;chunk_size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;total_size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;chunk_hessian&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;compute_hessian_chunk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;chunk_start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;chunk_end&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;full_hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;chunk_start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;chunk_end&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;chunk_hessian&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;2. 梯度检查点&lt;/strong&gt;：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;torch.utils.checkpoint&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;checkpoint&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 使用梯度检查点减少内存使用&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;forward_with_checkpoint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inputs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;checkpoint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inputs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;use_reentrant&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;3. 稀疏性利用&lt;/strong&gt;：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 利用力常数矩阵的稀疏性&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;sparse_hessian_computation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cutoff_distance&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;8.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 只计算距离小于cutoff的原子对&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;distances&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cdist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;active_pairs&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;distances&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cutoff_distance&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nonzero&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;sparse_hessian&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sparse_coo_tensor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;active_pairs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;compute_partial_hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;active_pairs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sparse_hessian&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;h4&gt;批处理优化&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;批处理优化&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%89%b9%e5%a4%84%e7%90%86%e4%bc%98%e5%8c%96&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;为了提高训练效率，我们设计了专门的批处理策略：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;efficient_batch_processing&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data_loader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data_loader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 按原子数量对样本分组&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;samples_by_size&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;group_by_atom_count&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;samples&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;samples_by_size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;items&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# 相同大小的样本可以真正并行处理&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;samples&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;parallel_hessian_computation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;samples&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;sequential_hessian_computation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;samples&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这种策略显著提高了训练效率，特别是对于包含不同大小晶体的数据集。&lt;/p&gt;
&lt;h3&gt;6.4 数值稳定性的深层考虑&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;64-数值稳定性的深层考虑&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#64-%e6%95%b0%e5%80%bc%e7%a8%b3%e5%ae%9a%e6%80%a7%e7%9a%84%e6%b7%b1%e5%b1%82%e8%80%83%e8%99%91&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;病态矩阵的处理&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;病态矩阵的处理&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%97%85%e6%80%81%e7%9f%a9%e9%98%b5%e7%9a%84%e5%a4%84%e7%90%86&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;在实际计算中，我们经常遇到&lt;strong&gt;条件数很大的系统&lt;/strong&gt;：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;stabilized_hessian_computation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;regularization&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1e-6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;compute_hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 检查条件数&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;condition_number&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;linalg&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cond&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;condition_number&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;1e12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 添加正则化项&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;regularization&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;eye&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;device&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;device&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;logger&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;warning&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;High condition number &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;condition_number&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.2e&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;, &amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                      &lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;added regularization &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;regularization&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;h4&gt;多精度计算策略&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;多精度计算策略&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%a4%9a%e7%b2%be%e5%ba%a6%e8%ae%a1%e7%ae%97%e7%ad%96%e7%95%a5&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;对于特别敏感的计算，我们实现了混合精度策略：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;mixed_precision_hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 前向传播使用半精度&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;autocast&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;cuda&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dtype&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;float16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;energy&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 梯度计算使用单精度&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;autocast&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;cuda&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;enabled&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;forces&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;autograd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grad&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;energy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;create_graph&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# Hessian计算使用双精度&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;pos_double&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;double&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;forces_double&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;forces&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;double&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;autograd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;functional&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;lambda&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;double&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos_double&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这种策略在保持数值精度的同时，尽可能减少了计算时间和内存使用。&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;7. 技术挑战与解决方案：从理论到实践的鸿沟&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;7-技术挑战与解决方案从理论到实践的鸿沟&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#7-%e6%8a%80%e6%9c%af%e6%8c%91%e6%88%98%e4%b8%8e%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88%e4%bb%8e%e7%90%86%e8%ae%ba%e5%88%b0%e5%ae%9e%e8%b7%b5%e7%9a%84%e9%b8%bf%e6%b2%9f&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;7.1 内存爆炸：自动微分的阿喀琉斯之踵&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;71-内存爆炸自动微分的阿喀琉斯之踵&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#71-%e5%86%85%e5%ad%98%e7%88%86%e7%82%b8%e8%87%aa%e5%8a%a8%e5%be%ae%e5%88%86%e7%9a%84%e9%98%bf%e5%96%80%e7%90%89%e6%96%af%e4%b9%8b%e8%b8%b5&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;挑战的本质&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;挑战的本质&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%8c%91%e6%88%98%e7%9a%84%e6%9c%ac%e8%b4%a8&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;在实际实现中，我们遇到的最大挑战是&lt;strong&gt;内存消耗的指数级增长&lt;/strong&gt;。对于包含$N$个原子的系统，计算完整的Hessian矩阵需要存储$3N \times 3N$的二阶导数信息。当$N=50$时，这已经是一个$150 \times 150 = 22,500$元素的矩阵。&lt;/p&gt;
&lt;p&gt;更严重的是，PyTorch的自动微分机制需要维护&lt;strong&gt;完整的计算图&lt;/strong&gt;：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 问题代码：会导致内存爆炸&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;alpha&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;grad&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;autograd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grad&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;forces&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;alpha&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sample_pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;retain_graph&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;create_graph&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 保持完整计算图！&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;每次&lt;code&gt;retain_graph=True&lt;/code&gt;调用都会在内存中保留从输入到输出的全部中间计算结果。对于深度为6层的等变网络，这种累积效应是灾难性的。&lt;/p&gt;
&lt;h4&gt;解决方案的演进&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;解决方案的演进&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88%e7%9a%84%e6%bc%94%e8%bf%9b&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;第一次尝试：梯度检查点&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;torch.utils.checkpoint&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;checkpoint&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;checkpointed_forward&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inputs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;checkpoint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inputs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;use_reentrant&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这种方法通过&lt;strong&gt;时间换空间&lt;/strong&gt;——在反向传播时重新计算前向结果，而不是存储所有中间值。内存使用降低了约60%，但计算时间增加了约40%。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;第二次迭代：分块计算&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;chunked_hessian_computation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;chunk_size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;hessian_blocks&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;chunk_size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;chunk_end&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;min&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;chunk_size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;chunk_hessian&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;compute_hessian_chunk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;chunk_end&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;hessian_blocks&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;chunk_hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hessian_blocks&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dim&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;最终解决方案：稀疏性感知计算&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;sparse_aware_hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cutoff&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;8.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 只计算物理上有意义的原子对&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;distances&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cdist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;active_mask&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;distances&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cutoff&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 稀疏计算，内存使用降低90%&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;sparse_hessian&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;compute_sparse_hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;active_mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sparse_hessian&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;h3&gt;7.2 数值稳定性：双精度的必要性&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;72-数值稳定性双精度的必要性&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#72-%e6%95%b0%e5%80%bc%e7%a8%b3%e5%ae%9a%e6%80%a7%e5%8f%8c%e7%b2%be%e5%ba%a6%e7%9a%84%e5%bf%85%e8%a6%81%e6%80%a7&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;病态系统的普遍性&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;病态系统的普遍性&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%97%85%e6%80%81%e7%b3%bb%e7%bb%9f%e7%9a%84%e6%99%ae%e9%81%8d%e6%80%a7&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;在晶体系统中，&lt;strong&gt;病态矩阵&lt;/strong&gt;（条件数很大的矩阵）是常态而非例外。这源于：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;多尺度相互作用&lt;/strong&gt;：强共价键($\sim 10^2$ eV/Å²)与弱范德华力($\sim 10^{-2}$ eV/Å²)共存&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;几何敏感性&lt;/strong&gt;：原子位置的微小变化可能导致相互作用的剧烈变化&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;对称性破缺&lt;/strong&gt;：结构缺陷附近的力常数急剧变化&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;数值精度的级联失效&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;数值精度的级联失效&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%95%b0%e5%80%bc%e7%b2%be%e5%ba%a6%e7%9a%84%e7%ba%a7%e8%81%94%e5%a4%b1%e6%95%88&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 问题示例：单精度的累积误差&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;energy&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# ~1e-7相对误差&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;forces&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;autograd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grad&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;energy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# ~1e-6相对误差&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;compute_hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;forces&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# ~1e-4相对误差！&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;在单精度下，每次微分操作都会放大数值误差。二阶导数的相对误差可能达到$10^{-4}$量级，这对于精确的物理预测是不可接受的。&lt;/p&gt;
&lt;h4&gt;混合精度的精妙平衡&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;混合精度的精妙平衡&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%b7%b7%e5%90%88%e7%b2%be%e5%ba%a6%e7%9a%84%e7%b2%be%e5%a6%99%e5%b9%b3%e8%a1%a1&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;我们开发了一套&lt;strong&gt;自适应混合精度策略&lt;/strong&gt;：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;adaptive_precision_hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 前向传播：半精度（性能优先）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;autocast&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;cuda&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dtype&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;float16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;energy&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 检查数值稳定性&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;isnan&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;energy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;isinf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;energy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 回退到单精度&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;autocast&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;cuda&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dtype&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;float32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;energy&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 梯度计算：根据系统大小选择精度&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;30&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 大系统，使用双精度&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;pos_double&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;double&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;energy_double&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;energy&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;double&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;autograd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;functional&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;lambda&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;double&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos_double&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 小系统，单精度足够&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;autograd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;functional&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;lambda&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;h3&gt;7.3 批处理的几何挑战&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;73-批处理的几何挑战&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#73-%e6%89%b9%e5%a4%84%e7%90%86%e7%9a%84%e5%87%a0%e4%bd%95%e6%8c%91%e6%88%98&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;变长图的批处理困境&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;变长图的批处理困境&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%8f%98%e9%95%bf%e5%9b%be%e7%9a%84%e6%89%b9%e5%a4%84%e7%90%86%e5%9b%b0%e5%a2%83&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;与图像或文本不同，晶体图没有固定的大小。一个硅晶体可能有32个原子，而一个蛋白质晶体可能有几百个原子。传统的批处理方法无法直接应用。&lt;/p&gt;
&lt;p&gt;PyTorch Geometric的解决方案是&lt;strong&gt;图拼接&lt;/strong&gt;：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 多个图合并成一个大图&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;batch_1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nodes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;edges&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;batch_2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nodes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;edges&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 合并后: nodes=[1,2,3,4,5], edges=[(1,2), (2,3), (4,5)]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;但这种方法在自动微分中引入了新问题：&lt;strong&gt;梯度串扰&lt;/strong&gt;。&lt;/p&gt;
&lt;h4&gt;梯度隔离的工程实现&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;梯度隔离的工程实现&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%a2%af%e5%ba%a6%e9%9a%94%e7%a6%bb%e7%9a%84%e5%b7%a5%e7%a8%8b%e5%ae%9e%e7%8e%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;isolated_gradient_computation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;batch_hessians&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 逐样本处理，确保梯度完全隔离&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sample_idx&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch_data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unique&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;sample_mask&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch_data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sample_idx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 创建独立的子图&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;sample_pos&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch_data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sample_mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;detach&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clone&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;sample_pos&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;requires_grad_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 独立计算，无梯度干扰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;sample_hessian&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;compute_single_hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sample_pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;batch_hessians&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sample_hessian&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;batch_hessians&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dim&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这种方法牺牲了部分并行性，但保证了每个样本的梯度计算完全独立，避免了微妙的数值错误。&lt;/p&gt;
&lt;h3&gt;7.4 等变性验证：理论与实践的差距&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;74-等变性验证理论与实践的差距&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#74-%e7%ad%89%e5%8f%98%e6%80%a7%e9%aa%8c%e8%af%81%e7%90%86%e8%ae%ba%e4%b8%8e%e5%ae%9e%e8%b7%b5%e7%9a%84%e5%b7%ae%e8%b7%9d&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;离散化误差的累积&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;离散化误差的累积&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%a6%bb%e6%95%a3%e5%8c%96%e8%af%af%e5%b7%ae%e7%9a%84%e7%b4%af%e7%a7%af&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;尽管E3NN在理论上严格等变，但在实际计算中，&lt;strong&gt;离散化误差&lt;/strong&gt;会逐步累积：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;test_equivariance_violation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 测试旋转等变性&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;rotation_matrix&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;o3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rand_matrix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 随机旋转&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 原始预测&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;energy_original&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 旋转后预测&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;pos_rotated&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;matmul&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rotation_matrix&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;energy_rotated&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos_rotated&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 理论上应该相等，但实际存在小误差&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;violation&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;abs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;energy_original&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;energy_rotated&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Equivariance violation: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;violation&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;max&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.2e&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 典型输出：1e-6 到 1e-4&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;h4&gt;等变性保护的软约束&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;等变性保护的软约束&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ad%89%e5%8f%98%e6%80%a7%e4%bf%9d%e6%8a%a4%e7%9a%84%e8%bd%af%e7%ba%a6%e6%9d%9f&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;我们在训练中添加了&lt;strong&gt;软等变性约束&lt;/strong&gt;：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;equivariance_loss&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lambda_eq&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1e-3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 标准能量损失&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;energy&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 等变性约束&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;rotation&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;o3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rand_matrix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;pos_rotated&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;matmul&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rotation&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;energy_rotated&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos_rotated&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;batch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;equivariance_violation&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;energy&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;energy_rotated&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;energy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lambda_eq&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;equivariance_violation&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这种方法在实践中将等变性违背控制在$10^{-7}$量级。&lt;/p&gt;
&lt;h3&gt;7.5 超参数敏感性：炼金术到科学&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;75-超参数敏感性炼金术到科学&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#75-%e8%b6%85%e5%8f%82%e6%95%b0%e6%95%8f%e6%84%9f%e6%80%a7%e7%82%bc%e9%87%91%e6%9c%af%e5%88%b0%e7%a7%91%e5%ad%a6&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;学习率的临界调节&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;学习率的临界调节&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ad%a6%e4%b9%a0%e7%8e%87%e7%9a%84%e4%b8%b4%e7%95%8c%e8%b0%83%e8%8a%82&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;我们发现力常数预测对学习率极其敏感：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 学习率扫描实验&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;lr_results&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;mf&#34;&gt;1e-3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;发散，梯度爆炸&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;mf&#34;&gt;5e-4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;震荡，无法收敛&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;mf&#34;&gt;1e-4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;缓慢收敛，性能中等&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;mf&#34;&gt;5e-5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;稳定收敛，最佳性能&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 最终选择&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;mf&#34;&gt;1e-5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;过慢收敛，欠拟合&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;mf&#34;&gt;1e-6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;几乎无学习&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;物理解释&lt;/strong&gt;：力常数作为二阶导数，对参数变化极其敏感。过大的学习率会导致能量面的剧烈振荡。&lt;/p&gt;
&lt;h4&gt;自适应超参数策略&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;自适应超参数策略&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%87%aa%e9%80%82%e5%ba%94%e8%b6%85%e5%8f%82%e6%95%b0%e7%ad%96%e7%95%a5&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;PhysicsAwareLRScheduler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;optimizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;patience&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;optimizer&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;optimizer&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;patience&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;patience&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;best_symmetry_error&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;inf&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;step&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mae_loss&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;symmetry_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 同时考虑预测误差和物理一致性&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;symmetry_error&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;1e-4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# 物理一致性差，降低学习率&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;param_group&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;optimizer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param_groups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;param_group&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;lr&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mae_loss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;best_mae&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.99&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# 性能改善，可以尝试增大学习率&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;param_group&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;optimizer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param_groups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;param_group&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;lr&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;1.05&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;hr&gt;
&lt;h2&gt;8. 实验结果与性能分析&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;8-实验结果与性能分析&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#8-%e5%ae%9e%e9%aa%8c%e7%bb%93%e6%9e%9c%e4%b8%8e%e6%80%a7%e8%83%bd%e5%88%86%e6%9e%90&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;8.1 核心性能指标&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;81-核心性能指标&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#81-%e6%a0%b8%e5%bf%83%e6%80%a7%e8%83%bd%e6%8c%87%e6%a0%87&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;我们的最终模型在力常数预测任务上取得了显著的性能提升：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;关键结果&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;MAE (Mean Absolute Error)&lt;/strong&gt;：从初始的 &lt;strong&gt;0.3 eV/Å²&lt;/strong&gt; 降低到 &lt;strong&gt;0.15 eV/Å²&lt;/strong&gt;，提升了&lt;strong&gt;50%&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;物理一致性&lt;/strong&gt;：对称性误差控制在 &lt;strong&gt;1e-6&lt;/strong&gt; 量级&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;计算效率&lt;/strong&gt;：相比传统DFT计算，速度提升 &lt;strong&gt;1000倍&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;性能演进路径&lt;/strong&gt;：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;pre&gt;&lt;code&gt;GraphTransformer (baseline):        MAE = 0.45 eV/Å²
GraphAttentionTransformer:          MAE = 0.32 eV/Å²  
GraphAttentionTransformer_dx_v1:    MAE = 0.28 eV/Å²
GraphAttentionTransformer_dx_v3:    MAE = 0.18 eV/Å²
GraphAttentionTransformer_dx_v4:    MAE = 0.15 eV/Å²  (最终版本)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;每个版本的改进都解决了特定的技术问题：v1引入自动微分、v3优化内存管理、v4实现数值稳定性。&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;9. 未来展望与改进方向&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;9-未来展望与改进方向&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#9-%e6%9c%aa%e6%9d%a5%e5%b1%95%e6%9c%9b%e4%b8%8e%e6%94%b9%e8%bf%9b%e6%96%b9%e5%90%91&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;9.1 方法论的进一步发展&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;91-方法论的进一步发展&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#91-%e6%96%b9%e6%b3%95%e8%ae%ba%e7%9a%84%e8%bf%9b%e4%b8%80%e6%ad%a5%e5%8f%91%e5%b1%95&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;高阶等变网络的探索&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;高阶等变网络的探索&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e9%ab%98%e9%98%b6%e7%ad%89%e5%8f%98%e7%bd%91%e7%bb%9c%e7%9a%84%e6%8e%a2%e7%b4%a2&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;当前的E3NN框架主要处理2阶张量（力常数），但许多重要的物理性质需要更高阶的表示：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;三阶张量&lt;/strong&gt;：非线性光学系数、压电系数
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;χ&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\chi^{(3)}_{ijkl} = \frac{\partial^3 P_i}{\partial E_j \partial E_k \partial E_l}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.4822em;vertical-align:-0.4374em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;χ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.0448em;&#34;&gt;&lt;span style=&#34;top:-2.3987em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;ijk&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.2198em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mopen mtight&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mtight&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;mclose mtight&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.4374em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.4632em;vertical-align:-0.9721em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.4911em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05764em;&#34;&gt;E&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3117em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2861em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05764em;&#34;&gt;E&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3361em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05764em;&#34;&gt;E&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3361em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3117em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.9721em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;&lt;strong&gt;四阶张量&lt;/strong&gt;：弹性模量、拉曼张量
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;σ&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;ϵ&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;C_{ijkl} = \frac{\partial^2 \sigma_{ij}}{\partial \epsilon_{kl}}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.9694em;vertical-align:-0.2861em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.07153em;&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3361em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;ijk&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2861em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.3271em;vertical-align:-0.836em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.4911em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;ϵ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3361em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;σ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3117em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;ij&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2861em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.836em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;&lt;strong&gt;技术挑战&lt;/strong&gt;：高阶张量的Clebsch-Gordan耦合计算复杂度呈指数增长。未来需要开发&lt;strong&gt;稀疏张量积算法&lt;/strong&gt;和&lt;strong&gt;近似耦合方法&lt;/strong&gt;。&lt;/p&gt;
&lt;h4&gt;多尺度建模的集成&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;多尺度建模的集成&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%a4%9a%e5%b0%ba%e5%ba%a6%e5%bb%ba%e6%a8%a1%e7%9a%84%e9%9b%86%e6%88%90&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;目前的方法主要处理原子尺度的相互作用，但真实材料的性质往往涉及多个尺度：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 未来的多尺度架构概念&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;MultiScaleEquivariantNetwork&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;atomic_scale&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;E3NN_AtomicLevel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;# 1-10 Å&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mesoscale&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;E3NN_GrainLevel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;# 10-1000 Å  &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;macroscale&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ContinuumModel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;# &amp;gt; 1 μm&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;forward&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;structure&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;atomic_features&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;atomic_scale&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;structure&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;meso_features&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mesoscale&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;atomic_features&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;macro_properties&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;macroscale&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;meso_features&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;macro_properties&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;h3&gt;9.2 PINN集成的第二次尝试&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;92-pinn集成的第二次尝试&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#92-pinn%e9%9b%86%e6%88%90%e7%9a%84%e7%ac%ac%e4%ba%8c%e6%ac%a1%e5%b0%9d%e8%af%95&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;软物理约束的现代实现&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;软物理约束的现代实现&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%bd%af%e7%89%a9%e7%90%86%e7%ba%a6%e6%9d%9f%e7%9a%84%e7%8e%b0%e4%bb%a3%e5%ae%9e%e7%8e%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;虽然我们最初选择了纯监督学习，但随着模型成熟，重新考虑PINN方法变得有意义：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;PhysicsInformedE3NN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;base_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;base_model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;base_model&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;compute_physics_loss&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;predicted_energy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 1. 平移不变性&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;pos_shifted&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;randn_like&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;energy_shifted&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;base_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos_shifted&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;translation_loss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;abs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;predicted_energy&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;energy_shifted&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 2. 晶格周期性&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;lattice_vectors&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;extract_lattice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;periodic_loss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;check_periodicity&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;predicted_energy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lattice_vectors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 3. 热力学关系&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;thermodynamic_loss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;check_maxwell_relations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;predicted_energy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;translation_loss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;periodic_loss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;thermodynamic_loss&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;优势&lt;/strong&gt;：在数据稀缺的体系（如新型材料）中，物理约束可以提供强大的正则化效果。&lt;/p&gt;
&lt;h4&gt;微分几何的深度应用&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;微分几何的深度应用&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%be%ae%e5%88%86%e5%87%a0%e4%bd%95%e7%9a%84%e6%b7%b1%e5%ba%a6%e5%ba%94%e7%94%a8&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;力常数矩阵的几何性质远比我们目前利用的更丰富：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Riemann几何视角&lt;/strong&gt;：
&lt;/p&gt;
&lt;span class=&#34;katex-display&#34;&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34; display=&#34;block&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;Φ&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\Phi_{ij} = \frac{\partial^2 E}{\partial r_i \partial r_j}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.9694em;vertical-align:-0.2861em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;Φ&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3117em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;ij&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2861em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:2.4632em;vertical-align:-0.9721em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mopen nulldelimiter&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mfrac&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:1.4911em;&#34;&gt;&lt;span style=&#34;top:-2.314em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3117em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3117em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.05724em;&#34;&gt;j&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2861em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.23em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;frac-line&#34; style=&#34;border-bottom-width:0.04em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3.677em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.05556em;&#34;&gt;∂&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05764em;&#34;&gt;E&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.9721em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose nulldelimiter&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;p&gt;可以视为配置空间上的度量张量，定义了能量景观的曲率。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;拓扑不变量&lt;/strong&gt;：
某些材料性质与拓扑保护的量子态相关，如拓扑绝缘体的表面态。未来的模型需要能够识别和利用这些拓扑特征。&lt;/p&gt;
&lt;h3&gt;9.3 基础科学问题的探索&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;93-基础科学问题的探索&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#93-%e5%9f%ba%e7%a1%80%e7%a7%91%e5%ad%a6%e9%97%ae%e9%a2%98%e7%9a%84%e6%8e%a2%e7%b4%a2&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;机器学习的物理可解释性&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;机器学习的物理可解释性&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e7%9a%84%e7%89%a9%e7%90%86%e5%8f%af%e8%a7%a3%e9%87%8a%e6%80%a7&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;深层问题&lt;/strong&gt;：为什么E3NN能够学习到正确的物理规律？是否存在更深层的数学结构？&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;研究方向&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;表示学习理论&lt;/strong&gt;：等变特征空间的几何结构&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;泛化界理论&lt;/strong&gt;：物理对称性如何改善泛化性能&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;信息论分析&lt;/strong&gt;：物理约束对信息容量的影响&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;新物理现象的发现&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;新物理现象的发现&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%96%b0%e7%89%a9%e7%90%86%e7%8e%b0%e8%b1%a1%e7%9a%84%e5%8f%91%e7%8e%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;训练好的模型可能揭示人类尚未发现的物理规律：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;PhysicsDiscovery&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;find_scaling_laws&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;material_database&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 在大规模材料数据库中寻找标度律&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;predictions&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;material_database&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 寻找意外的相关性&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;correlations&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;analyze_correlations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;predictions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 提取可能的新物理定律&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;candidate_laws&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;extract_scaling_relations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;correlations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;candidate_laws&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;hr&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/research/dl/wavelet-conv/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/research/dl/wavelet-conv/</guid>
      <description>
        
        
        &lt;h1&gt;WPTCN: 基于小波包变换的联邦异构人体活动识别模型&lt;/h1&gt;&lt;h2&gt;引言：为什么我们需要重新思考HAR？&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;引言为什么我们需要重新思考har&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%bc%95%e8%a8%80%e4%b8%ba%e4%bb%80%e4%b9%88%e6%88%91%e4%bb%ac%e9%9c%80%e8%a6%81%e9%87%8d%e6%96%b0%e6%80%9d%e8%80%83har&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;想象一下这样的场景：你戴着智能手表跑步，手表需要准确识别你是在慢跑、快跑还是走路。这看似简单的任务，实际上包含了深度学习、信号处理、隐私保护等多个复杂技术问题。更重要的是，传统的解决方案往往要求将你的私人运动数据上传到云端服务器，这既带来了隐私风险，也造成了巨大的网络传输开销（这听起来非常BME，刘清君老师的穿戴式传感设备emmm）。&lt;/p&gt;
&lt;p&gt;本文将从第一性原理出发，逐步构建一个现代化的人体活动识别(HAR)系统。我们将从最简单的概念开始，逐渐添加小波变换、时间卷积网络、联邦学习等高级技术，最终实现一个既保护隐私又高效准确的分布式HAR（Human Activity Recognition，人类活动识别）系统。&lt;/p&gt;
&lt;h2&gt;1. 前期调研&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;1-前期调研&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#1-%e5%89%8d%e6%9c%9f%e8%b0%83%e7%a0%94&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;在动手实现之前，让我们先了解当前HAR和时序建模领域的研究现状。这将帮助我们理解为什么需要设计新的架构，以及我们的技术选择有何依据。&lt;/p&gt;
&lt;h3&gt;HAR领域的发展脉络&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;har领域的发展脉络&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#har%e9%a2%86%e5%9f%9f%e7%9a%84%e5%8f%91%e5%b1%95%e8%84%89%e7%bb%9c&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;人体活动识别经历了从传统机器学习到深度学习的演进过程。早期研究主要依赖手工特征工程，通过统计特征、频域特征等方式来描述人体活动模式。然而，这种方法面临特征设计复杂、泛化能力差等问题。&lt;/p&gt;
&lt;p&gt;深度学习的兴起为HAR带来了新的机遇。卷积神经网络(CNN)能够自动学习时序特征，循环神经网络(RNN)擅长捕获长期依赖关系。但随着应用场景的复杂化，单一的网络架构已经难以满足多样化的需求。&lt;/p&gt;
&lt;h3&gt;时序建模的技术演进&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;时序建模的技术演进&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%97%b6%e5%ba%8f%e5%bb%ba%e6%a8%a1%e7%9a%84%e6%8a%80%e6%9c%af%e6%bc%94%e8%bf%9b&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;通过文献调研，我们可以看到时序建模领域近年来出现了许多突破性进展：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Transformer架构的时序应用&lt;/strong&gt;：从Informer到Autoformer，研究者们探索了如何将注意力机制应用到长序列预测中。Informer提出了稀疏注意力机制来降低计算复杂度，而Autoformer则引入了序列分解的思想，将趋势和季节性分离处理。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;频域分析的复兴&lt;/strong&gt;：FEDformer和频域MLP的出现表明，频域分析在时序建模中仍然具有重要价值。通过在频域中进行计算，可以更高效地捕获全局依赖关系。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;现代卷积网络的进展&lt;/strong&gt;：ModernTCN的研究显示，经过精心设计的卷积网络在许多时序任务中仍能与Transformer媲美，且具有更好的计算效率。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;混合架构的探索&lt;/strong&gt;：TimeMixer和TimesNet等工作尝试将多种技术融合，通过分解、多尺度建模等方式来处理复杂的时序模式。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;轻量化模型设计&lt;/strong&gt;：FITS等工作专注于参数高效的模型设计，这对于移动设备部署具有重要意义。&lt;/p&gt;
&lt;h3&gt;我们的技术选择动机&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;我们的技术选择动机&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%88%91%e4%bb%ac%e7%9a%84%e6%8a%80%e6%9c%af%e9%80%89%e6%8b%a9%e5%8a%a8%e6%9c%ba&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;基于以上调研，我们的技术选择有了清晰的依据：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;为什么选择小波变换？&lt;/strong&gt; 小波变换能够同时提供时域和频域信息，这对于HAR任务至关重要。不同的人体活动在频谱特征上有显著差异，而小波包变换能够提供更细致的频域分解。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;为什么选择时间卷积网络？&lt;/strong&gt; 相比于RNN，TCN具有并行计算的优势；相比于Transformer，TCN在移动设备上的计算效率更高。ModernTCN的成功验证了卷积网络在时序建模中的潜力。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;为什么需要联邦学习？&lt;/strong&gt; 在隐私保护日益重要的今天，联邦学习提供了在不暴露原始数据的前提下进行协作训练的可能性。对于HAR这样涉及个人隐私的应用场景，联邦学习几乎是唯一可行的大规模训练方案。&lt;/p&gt;
&lt;p&gt;现在，让我们从最基础的概念开始，逐步构建我们的系统。&lt;/p&gt;
&lt;h2&gt;2. 从一个简单的想法开始：如何让机器理解人体活动？&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;2-从一个简单的想法开始如何让机器理解人体活动&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#2-%e4%bb%8e%e4%b8%80%e4%b8%aa%e7%ae%80%e5%8d%95%e7%9a%84%e6%83%b3%e6%b3%95%e5%bc%80%e5%a7%8b%e5%a6%82%e4%bd%95%e8%ae%a9%e6%9c%ba%e5%99%a8%e7%90%86%e8%a7%a3%e4%ba%ba%e4%bd%93%e6%b4%bb%e5%8a%a8&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;在深入复杂的技术细节之前，让我们先思考一个基本问题：机器如何理解人体活动？&lt;/p&gt;
&lt;p&gt;当你在跑步时，智能手表的传感器会产生一系列数据：加速度计记录你的运动加速度，陀螺仪记录旋转角度，磁力计记录方向信息。这些数据本质上是时间序列信号，包含了丰富的运动模式信息。&lt;/p&gt;
&lt;h3&gt;第一步：最简单的分类器&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第一步最简单的分类器&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e4%b8%80%e6%ad%a5%e6%9c%80%e7%ae%80%e5%8d%95%e7%9a%84%e5%88%86%e7%b1%bb%e5%99%a8&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;让我们从最简单的想法开始。假设我们有一个传感器数据序列，最直观的方法是使用一个简单的神经网络：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;SimpleHAR&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;input_size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_classes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Linear&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;input_size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_classes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;forward&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 简单地将时序数据拍平&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;view&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这个方法虽然简单，但有明显的问题：它完全忽略了时间信息，把时序数据当作静态特征处理。人体活动的本质是时间序列模式，我们需要保留时间维度的信息。&lt;/p&gt;
&lt;h3&gt;第二步：引入时间感知&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第二步引入时间感知&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e4%ba%8c%e6%ad%a5%e5%bc%95%e5%85%a5%e6%97%b6%e9%97%b4%e6%84%9f%e7%9f%a5&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;既然需要处理时序信息，自然想到使用卷积神经网络。一维卷积能够捕获局部的时序模式：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;TimeCNN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;input_channels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_classes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;conv1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Conv1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;input_channels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;kernel_size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;padding&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;conv2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Conv1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;128&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;kernel_size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;padding&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pool&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;AdaptiveAvgPool1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Linear&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;128&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_classes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;forward&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;relu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;conv1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;relu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;conv2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;squeeze&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这已经是一个相当不错的HAR模型了。但是，我们还可以做得更好。&lt;/p&gt;
&lt;h3&gt;第三步：发现频域的秘密&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第三步发现频域的秘密&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e4%b8%89%e6%ad%a5%e5%8f%91%e7%8e%b0%e9%a2%91%e5%9f%9f%e7%9a%84%e7%a7%98%e5%af%86&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;人体活动在频域中有着独特的特征。走路、跑步、跳跃等不同活动具有不同的频率特征。这让我们想到：能否同时在时域和频域中分析信号？&lt;/p&gt;
&lt;p&gt;这就是小波变换的用武之地。小波变换能够提供时频分析，既保留时间信息，又能分析频率成分。&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;simple_wavelet_transform&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;signal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;简单的小波变换实现概念&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 使用低通和高通滤波器分解信号&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;low_freq&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;low_pass_filter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;signal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;   &lt;span class=&#34;c1&#34;&gt;# 保留低频成分&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;high_freq&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;high_pass_filter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;signal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# 保留高频成分&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;low_freq&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;high_freq&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;但我们的想法更进一步：如果滤波器的参数也能学习呢？这样网络就能自动找到最适合HAR任务的频域分解方式。&lt;/p&gt;
&lt;h3&gt;第四步：可学习的频域分解&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第四步可学习的频域分解&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e5%9b%9b%e6%ad%a5%e5%8f%af%e5%ad%a6%e4%b9%a0%e7%9a%84%e9%a2%91%e5%9f%9f%e5%88%86%e8%a7%a3&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;这就是我们WPTCN的核心创新点。我们让小波滤波器的参数变得可学习：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;LearnableWavelet&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;channels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;wavelet_type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;db1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 初始化为传统小波滤波器&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;wavelet&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pywt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Wavelet&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;wavelet_type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;low_filter&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Parameter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tensor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;wavelet&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dec_lo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;high_filter&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Parameter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tensor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;wavelet&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dec_hi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;forward&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 使用可学习的滤波器进行分解&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;low_freq&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;conv1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;low_filter&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;view&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;padding&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;same&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;high_freq&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;conv1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;high_filter&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;view&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;padding&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;same&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;low_freq&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;high_freq&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这个想法很有趣：我们从传统的小波变换开始，但允许网络在训练过程中调整滤波器参数，以找到最适合特定HAR任务的频域分解方式。&lt;/p&gt;
&lt;h3&gt;第五步：构建完整的WTTCN块&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第五步构建完整的wttcn块&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e4%ba%94%e6%ad%a5%e6%9e%84%e5%bb%ba%e5%ae%8c%e6%95%b4%e7%9a%84wttcn%e5%9d%97&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;现在我们可以将这些想法组合成一个完整的模块。我们的WTTCNBlock不仅包含可学习的小波变换，还加入了深度卷积和前馈网络：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;WTTCNBlock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;channels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_levels&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;channels&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;channels&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_levels&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_levels&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 可学习的小波滤波器&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;wavelet&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pywt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Wavelet&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;db1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dec_lo&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Parameter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tensor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;wavelet&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dec_lo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[::&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dtype&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;float32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dec_hi&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Parameter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tensor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;wavelet&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dec_hi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[::&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dtype&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;float32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 深度卷积处理各频带&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dw_conv&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Conv1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;channels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;channels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;kernel_size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;channels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;padding&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;same&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bn&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;BatchNorm1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;channels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 前馈网络&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ffn&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Sequential&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Conv1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;channels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;channels&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;kernel_size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;GELU&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Conv1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;channels&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;channels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;kernel_size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这个设计的精妙之处在于：它从简单的卷积开始，逐步添加了频域分析能力，最终形成了一个既能处理时域特征又能捕获频域特征的强大模块。&lt;/p&gt;
&lt;h3&gt;第六步：面临新的挑战 - 隐私问题&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第六步面临新的挑战---隐私问题&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e5%85%ad%e6%ad%a5%e9%9d%a2%e4%b8%b4%e6%96%b0%e7%9a%84%e6%8c%91%e6%88%98---%e9%9a%90%e7%a7%81%e9%97%ae%e9%a2%98&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;到现在为止，我们已经有了一个相当强大的HAR模型。但在实际应用中，我们面临一个新的挑战：隐私保护。&lt;/p&gt;
&lt;p&gt;传统的机器学习需要将所有用户数据收集到中央服务器进行训练。但对于HAR这样涉及个人行为模式的敏感数据，用户越来越不愿意将原始数据上传到云端。&lt;/p&gt;
&lt;p&gt;这就引出了我们的下一个核心技术：联邦学习。&lt;/p&gt;
&lt;h2&gt;3. 联邦学习：在保护隐私的前提下协作训练&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;3-联邦学习在保护隐私的前提下协作训练&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#3-%e8%81%94%e9%82%a6%e5%ad%a6%e4%b9%a0%e5%9c%a8%e4%bf%9d%e6%8a%a4%e9%9a%90%e7%a7%81%e7%9a%84%e5%89%8d%e6%8f%90%e4%b8%8b%e5%8d%8f%e4%bd%9c%e8%ae%ad%e7%bb%83&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;联邦学习的核心思想很简单：不是让数据去找模型，而是让模型去找数据。每个设备在本地训练模型，只分享模型参数而不分享原始数据。&lt;/p&gt;
&lt;h3&gt;从最简单的联邦学习开始&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;从最简单的联邦学习开始&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%bb%8e%e6%9c%80%e7%ae%80%e5%8d%95%e7%9a%84%e8%81%94%e9%82%a6%e5%ad%a6%e4%b9%a0%e5%bc%80%e5%a7%8b&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;让我们先实现一个最基本的联邦学习系统。假设我们有两个用户，Alice和Bob，他们都想训练一个HAR模型，但不愿意分享自己的运动数据。&lt;/p&gt;
&lt;p&gt;传统方式需要他们将数据上传到服务器：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 传统集中式训练 - 隐私风险&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;centralized_training&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;alice_data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;alice&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;upload_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 隐私泄露！&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;bob_data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bob&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;upload_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;# 隐私泄露！&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;combined_data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;merge&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;alice_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bob_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;train_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;combined_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;联邦学习的方式则完全不同：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 联邦学习 - 保护隐私&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;federated_training&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;global_model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;initialize_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 每轮训练&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;round&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_rounds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 1. 服务器发送全局模型给客户端&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;alice&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;receive_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;bob&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;receive_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 2. 客户端本地训练（数据不离开设备）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;alice_update&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;alice&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_train&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;bob_update&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bob&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_train&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 3. 服务器聚合模型更新&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;global_model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;aggregate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;alice_update&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bob_update&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;global_model&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这个简单的框架就是联邦学习的基础。但在实际应用中，我们需要考虑更多复杂情况。&lt;/p&gt;
&lt;h3&gt;三种不同的分工策略&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;三种不同的分工策略&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%b8%89%e7%a7%8d%e4%b8%8d%e5%90%8c%e7%9a%84%e5%88%86%e5%b7%a5%e7%ad%96%e7%95%a5&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;在实际的HAR联邦学习中，不同设备的计算能力差异很大。智能手机的计算能力强，智能手环的计算能力弱。我们需要根据设备能力来分配计算任务。&lt;/p&gt;
&lt;h4&gt;策略一：传统联邦学习(TFL) - 大家都是&amp;quot;全才&amp;quot;&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;策略一传统联邦学习tfl---大家都是全才&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ad%96%e7%95%a5%e4%b8%80%e4%bc%a0%e7%bb%9f%e8%81%94%e9%82%a6%e5%ad%a6%e4%b9%a0tfl---%e5%a4%a7%e5%ae%b6%e9%83%bd%e6%98%af%e5%85%a8%e6%89%8d&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;在TFL模式下，每个设备都运行完整的WPTCN模型：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;TraditionalFederatedClient&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;device_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data_loader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;device_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;device_id&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data_loader&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data_loader&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 每个客户端都有完整的WPTCN模型&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;WPTCN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;input_channels&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_classes&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;local_train&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;在本地训练完整模型&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;labels&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data_loader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;predictions&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;loss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;compute_loss&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;predictions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;loss&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backward&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;optimizer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;step&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 只返回模型参数，不暴露数据&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state_dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这种方式的优点是简单，每个设备都是&amp;quot;全才&amp;quot;，能独立完成所有计算。缺点是对设备要求高，不适合资源受限的设备。&lt;/p&gt;
&lt;h4&gt;策略二：分层联邦学习(HFL) - &amp;ldquo;专业分工&amp;rdquo;&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;策略二分层联邦学习hfl---专业分工&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ad%96%e7%95%a5%e4%ba%8c%e5%88%86%e5%b1%82%e8%81%94%e9%82%a6%e5%ad%a6%e4%b9%a0hfl---%e4%b8%93%e4%b8%9a%e5%88%86%e5%b7%a5&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;在HFL模式下，我们将模型分成两部分：设备端负责数据预处理和初步特征提取，服务器端负责复杂的推理计算。&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;HierarchicalClient&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;device_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data_loader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;device_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;device_id&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data_loader&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data_loader&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 设备端只运行模型的前半部分&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;device_model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;DeviceModel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 包含标准化和初始卷积&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;local_train&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;labels&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data_loader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# 设备端前向传播&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;features&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;device_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# 将特征发送到边缘服务器（而不是原始数据）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;predictions&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;send_to_edge_server&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;features&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# 从服务器获取梯度并更新本地模型&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;gradients&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;receive_gradients_from_server&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;update_device_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;gradients&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这种方式巧妙地平衡了隐私保护和计算效率。设备只需要传输抽象的特征向量，而不是原始的传感器数据，既保护了隐私，又减少了通信开销。&lt;/p&gt;
&lt;h4&gt;策略三：边缘计算联邦学习(FedMEC) - &amp;ldquo;动态分工&amp;rdquo;&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;策略三边缘计算联邦学习fedmec---动态分工&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ad%96%e7%95%a5%e4%b8%89%e8%be%b9%e7%bc%98%e8%ae%a1%e7%ae%97%e8%81%94%e9%82%a6%e5%ad%a6%e4%b9%a0fedmec---%e5%8a%a8%e6%80%81%e5%88%86%e5%b7%a5&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;FedMEC更进一步，它能够根据网络条件和设备性能动态调整分工点：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;AdaptiveFederatedClient&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;device_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data_loader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;device_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;device_id&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data_loader&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data_loader&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;full_model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;WPTCN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;current_partition_point&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;tcn_1&amp;#39;&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 动态调整&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;adapt_partition_point&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;根据设备状态动态调整分区点&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;cpu_usage&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;get_cpu_usage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;network_bandwidth&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;get_network_bandwidth&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cpu_usage&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;80&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;network_bandwidth&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 高CPU低带宽&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;current_partition_point&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;wavelet&amp;#39;&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 更多计算转移到服务器&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cpu_usage&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;30&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;network_bandwidth&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 低CPU低带宽&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;current_partition_point&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;tcn_3&amp;#39;&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;# 更多计算保留在设备&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;update_device_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这种自适应的方式使得系统能够根据实际情况优化性能，在不同的网络和设备条件下都能良好工作。&lt;/p&gt;
&lt;h3&gt;处理真实世界的复杂性&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;处理真实世界的复杂性&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%a4%84%e7%90%86%e7%9c%9f%e5%ae%9e%e4%b8%96%e7%95%8c%e7%9a%84%e5%a4%8d%e6%9d%82%e6%80%a7&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;在实验室里，我们可以假设所有设备都有相似的数据分布。但在真实世界中，每个用户的行为模式都不同。Alice可能是一个马拉松跑者，她的数据主要是跑步；Bob可能是上班族，他的数据主要是走路和坐着。&lt;/p&gt;
&lt;p&gt;这种数据分布的不均匀性被称为Non-IID（非独立同分布）问题。我们需要在数据处理阶段就考虑这个问题：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;simulate_real_world_distribution&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_clients&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;模拟真实世界的数据分布不均匀性&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 使用Dirichlet分布模拟数据量的不平衡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;data_ratios&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dirichlet&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ones&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_clients&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 不同客户端有不同的窗口大小和重叠率&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;client_configs&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_clients&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;config&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;s1&#34;&gt;&amp;#39;window_size&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;choice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;120&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;s1&#34;&gt;&amp;#39;overlap_rate&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;choice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.25&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;s1&#34;&gt;&amp;#39;data_ratio&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data_ratios&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;client_configs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;client_configs&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;通过这种方式，我们的实验更贴近真实应用场景，训练出的模型也更加鲁棒。&lt;/p&gt;
&lt;h2&gt;4. 技术实现的精妙之处：模型分区的艺术&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;4-技术实现的精妙之处模型分区的艺术&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#4-%e6%8a%80%e6%9c%af%e5%ae%9e%e7%8e%b0%e7%9a%84%e7%b2%be%e5%a6%99%e4%b9%8b%e5%a4%84%e6%a8%a1%e5%9e%8b%e5%88%86%e5%8c%ba%e7%9a%84%e8%89%ba%e6%9c%af&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;现在让我们深入了解三种联邦学习策略的技术实现细节。这里的关键挑战是：如何将一个完整的深度学习模型巧妙地分割，使得不同部分能在不同设备上运行，同时还能进行端到端的训练？&lt;/p&gt;
&lt;h3&gt;模型分区的基本思想&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;模型分区的基本思想&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%a8%a1%e5%9e%8b%e5%88%86%e5%8c%ba%e7%9a%84%e5%9f%ba%e6%9c%ac%e6%80%9d%e6%83%b3&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;想象一下，我们有一个完整的WPTCN模型，它包含几个主要组件：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;WPTCN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;normalization&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CustomNormalization&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;     &lt;span class=&#34;c1&#34;&gt;# 数据标准化&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;initial_conv&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Conv1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;             &lt;span class=&#34;c1&#34;&gt;# 初始特征提取&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backbone&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ModuleList&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;                &lt;span class=&#34;c1&#34;&gt;# 多个WTTCN块&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;WTTCNBlock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_layers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global_pool&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;AdaptiveAvgPool1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;     &lt;span class=&#34;c1&#34;&gt;# 全局池化&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Linear&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;                       &lt;span class=&#34;c1&#34;&gt;# 最终分类&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;现在的问题是：在哪里&amp;quot;切一刀&amp;quot;，将模型分成设备端和服务器端两部分？&lt;/p&gt;
&lt;h3&gt;策略一：传统联邦学习 - 不切割&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;策略一传统联邦学习---不切割&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ad%96%e7%95%a5%e4%b8%80%e4%bc%a0%e7%bb%9f%e8%81%94%e9%82%a6%e5%ad%a6%e4%b9%a0---%e4%b8%8d%e5%88%87%e5%89%b2&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;最简单的方法是不切割，每个设备运行完整模型：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;TraditionalClient&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 设备上运行完整模型&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;complete_model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;WPTCN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;train_locally&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;设备上的完整训练流程&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;predictions&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;complete_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;loss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;compute_loss&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;predictions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;loss&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backward&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;optimizer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;step&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 只发送模型参数更新&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;complete_model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;state_dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这种方式的好处是每个设备都是独立的，坏处是对设备性能要求很高。&lt;/p&gt;
&lt;h3&gt;策略二：在小波变换后切割&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;策略二在小波变换后切割&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ad%96%e7%95%a5%e4%ba%8c%e5%9c%a8%e5%b0%8f%e6%b3%a2%e5%8f%98%e6%8d%a2%e5%90%8e%e5%88%87%e5%89%b2&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;更聪明的做法是在合适的地方切割。我们发现，在小波变换之后切割是一个很好的选择：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;PartitionedModel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 设备端：轻量级预处理&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;device_part&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Sequential&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;CustomNormalization&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Conv1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;input_channels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;hidden_dim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;kernel_size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 服务器端：计算密集的部分&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;server_part&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Sequential&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WTTCNBlock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num_layers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)],&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 多个WTTCN块&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;AdaptiveAvgPool1d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Linear&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hidden_dim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num_classes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;forward_on_device&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;设备端前向传播&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;device_part&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;forward_on_server&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;features&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;服务器端前向传播&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;server_part&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;features&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这样分工的逻辑很清楚：设备端负责基础的数据预处理和特征提取，服务器端负责复杂的模式识别和分类。&lt;/p&gt;
&lt;h3&gt;策略三：动态分区 - 智能切割&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;策略三动态分区---智能切割&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ad%96%e7%95%a5%e4%b8%89%e5%8a%a8%e6%80%81%e5%88%86%e5%8c%ba---%e6%99%ba%e8%83%bd%e5%88%87%e5%89%b2&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;最高级的方法是根据实际情况动态决定切割点：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;AdaptivePartition&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;full_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;full_model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;full_model&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;current_partition&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;tcn_1&amp;#39;&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 当前分区点&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;adjust_partition&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;device_load&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;network_speed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;根据设备状态动态调整分区点&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;device_load&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 设备负载高&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;network_speed&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 网络好&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;current_partition&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;wavelet&amp;#39;&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 更多工作给服务器&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;current_partition&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;tcn_2&amp;#39;&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;# 平衡分配&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;device_load&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 设备负载低&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;current_partition&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;tcn_3&amp;#39;&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;# 设备做更多工作&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_recreate_partitioned_models&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;_recreate_partitioned_models&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;根据新的分区点重新创建模型&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;current_partition&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;wavelet&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# 在小波变换后分割&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;device_model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_create_device_model_wavelet&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;server_model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_create_server_model_wavelet&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;current_partition&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;startswith&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tcn_&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# 在指定TCN层后分割&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;layer_idx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;current_partition&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;split&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;device_model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_create_device_model_tcn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;layer_idx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;server_model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_create_server_model_tcn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;layer_idx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这种动态分区的思想很有趣：系统能够根据实时状况自动调整工作分配，就像一个智能的项目经理，能够根据团队成员的能力和工作负载来分配任务。&lt;/p&gt;
&lt;h3&gt;跨设备训练的技术挑战&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;跨设备训练的技术挑战&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%b7%a8%e8%ae%be%e5%a4%87%e8%ae%ad%e7%bb%83%e7%9a%84%e6%8a%80%e6%9c%af%e6%8c%91%e6%88%98&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;分区之后的一个关键问题是：如何进行端到端的训练？毕竟梯度需要从服务器端流回设备端。&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;distributed_training_step&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;跨设备的训练步骤&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 1. 设备端前向传播&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;device_output&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;device_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 2. 将中间特征发送到服务器&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;server_input&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;send_to_server&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;device_output&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 3. 服务器端前向传播和损失计算&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;predictions&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;server_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;server_input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;loss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cross_entropy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;predictions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 4. 服务器端反向传播&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;loss&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backward&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;server_gradients&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;server_input&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grad&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 5. 将梯度发送回设备&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;device_gradients&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;receive_from_server&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;server_gradients&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 6. 设备端反向传播&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;device_output&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backward&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;device_gradients&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;device_optimizer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;step&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这个过程看起来复杂，但逻辑很清晰：前向传播从设备流向服务器，反向传播从服务器流回设备，形成一个完整的训练循环。&lt;/p&gt;
&lt;p&gt;通过这种方式，我们实现了真正的分布式深度学习：不同的网络层运行在不同的设备上，但整个系统仍然能够进行端到端的训练。&lt;/p&gt;
&lt;h2&gt;5. 监控系统：让分布式训练变得可观测&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;5-监控系统让分布式训练变得可观测&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#5-%e7%9b%91%e6%8e%a7%e7%b3%bb%e7%bb%9f%e8%ae%a9%e5%88%86%e5%b8%83%e5%bc%8f%e8%ae%ad%e7%bb%83%e5%8f%98%e5%be%97%e5%8f%af%e8%a7%82%e6%b5%8b&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;在分布式系统中，监控和观测是至关重要的。我们需要实时了解每个设备的资源使用情况，网络通信状态，以及训练进展。&lt;/p&gt;
&lt;h3&gt;构建资源监控系统&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;构建资源监控系统&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%9e%84%e5%bb%ba%e8%b5%84%e6%ba%90%e7%9b%91%e6%8e%a7%e7%b3%bb%e7%bb%9f&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;让我们先构建一个简单的资源监控器：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;ResourceMonitor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;监控设备资源的小助手&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sampling_interval&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sampling_interval&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sampling_interval&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_monitoring&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;metrics&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;s1&#34;&gt;&amp;#39;cpu_usage&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;s1&#34;&gt;&amp;#39;memory_usage&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;s1&#34;&gt;&amp;#39;network_io&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;start_monitoring&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;开始监控&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_monitoring&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;monitoring_thread&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;threading&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Thread&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;target&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_monitor_loop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;monitoring_thread&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;_monitor_loop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;监控主循环&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_monitoring&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# 收集CPU使用率&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;cpu_percent&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;psutil&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cpu_percent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;metrics&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;cpu_usage&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cpu_percent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# 收集内存使用率&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;memory&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;psutil&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;virtual_memory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;metrics&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;memory_usage&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;memory&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;percent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;# 收集网络IO&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;net_io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;psutil&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;net_io_counters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;metrics&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;network_io&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;s1&#34;&gt;&amp;#39;bytes_sent&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;net_io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bytes_sent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;s1&#34;&gt;&amp;#39;bytes_recv&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;net_io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bytes_recv&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sampling_interval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这个监控系统能够实时跟踪设备的关键性能指标。在联邦学习过程中，这些数据帮助我们了解不同策略的资源消耗特点。&lt;/p&gt;
&lt;h3&gt;实验结果与技术验证&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;实验结果与技术验证&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ae%9e%e9%aa%8c%e7%bb%93%e6%9e%9c%e4%b8%8e%e6%8a%80%e6%9c%af%e9%aa%8c%e8%af%81&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;我们基于项目实际进展进行了系统性的实验验证，重点关注WPTCN架构的核心创新点。&lt;/p&gt;
&lt;h4&gt;5.1 数据集与实验设置&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;51-数据集与实验设置&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#51-%e6%95%b0%e6%8d%ae%e9%9b%86%e4%b8%8e%e5%ae%9e%e9%aa%8c%e8%ae%be%e7%bd%ae&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;我们的实验涵盖了具有不同特性的多个标准HAR数据集：&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;数据集&lt;/th&gt;
          &lt;th&gt;传感器类型&lt;/th&gt;
          &lt;th&gt;采样率&lt;/th&gt;
          &lt;th&gt;活动类别&lt;/th&gt;
          &lt;th&gt;参与者&lt;/th&gt;
          &lt;th&gt;数据特点&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;WISDM&lt;/td&gt;
          &lt;td&gt;3轴加速度计&lt;/td&gt;
          &lt;td&gt;20Hz&lt;/td&gt;
          &lt;td&gt;6类&lt;/td&gt;
          &lt;td&gt;29人&lt;/td&gt;
          &lt;td&gt;基础活动，数据相对简单&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;PAMAP2&lt;/td&gt;
          &lt;td&gt;3个IMU单元&lt;/td&gt;
          &lt;td&gt;100Hz&lt;/td&gt;
          &lt;td&gt;12类&lt;/td&gt;
          &lt;td&gt;9人&lt;/td&gt;
          &lt;td&gt;复杂日常活动，多传感器融合&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Opportunity&lt;/td&gt;
          &lt;td&gt;72个传感器&lt;/td&gt;
          &lt;td&gt;30Hz&lt;/td&gt;
          &lt;td&gt;17类&lt;/td&gt;
          &lt;td&gt;4人&lt;/td&gt;
          &lt;td&gt;高维多模态，复杂环境交互&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;UCI-HAR&lt;/td&gt;
          &lt;td&gt;3轴加速度+陀螺仪&lt;/td&gt;
          &lt;td&gt;50Hz&lt;/td&gt;
          &lt;td&gt;6类&lt;/td&gt;
          &lt;td&gt;30人&lt;/td&gt;
          &lt;td&gt;标准基准，预处理特征&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h4&gt;5.2 核心技术组件验证&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;52-核心技术组件验证&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#52-%e6%a0%b8%e5%bf%83%e6%8a%80%e6%9c%af%e7%bb%84%e4%bb%b6%e9%aa%8c%e8%af%81&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;小波包变换vs传统方法&lt;/strong&gt;：
我们重点验证了可学习小波包变换的有效性。通过消融实验对比了不同频域分析方法：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;传统FFT方法：固定频域分解，无法适应HAR信号的非平稳特性&lt;/li&gt;
&lt;li&gt;标准小波变换：多尺度分析，但频域分辨率固定&lt;/li&gt;
&lt;li&gt;可学习小波包变换：自适应多尺度分解，能够学习任务特定的频域特征&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;实验表明，可学习滤波器在训练过程中确实能够适应HAR任务的频谱特征，相比固定滤波器有显著提升。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;联邦学习架构验证&lt;/strong&gt;：
我们实现了三种联邦学习策略（TFL、HFL、FedMEC），并在实际的分布式环境中进行了测试。重点验证了：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;模型分区策略的可行性&lt;/li&gt;
&lt;li&gt;跨设备通信的效率&lt;/li&gt;
&lt;li&gt;不同资源约束下的性能表现&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;资源监控与性能评估&lt;/strong&gt;：
通过实际的资源监控系统，我们收集了各策略在训练过程中的关键指标：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CPU/内存使用情况&lt;/li&gt;
&lt;li&gt;网络通信开销&lt;/li&gt;
&lt;li&gt;训练收敛速度&lt;/li&gt;
&lt;li&gt;模型准确率变化&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;5.3 技术挑战与解决方案验证&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;53-技术挑战与解决方案验证&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#53-%e6%8a%80%e6%9c%af%e6%8c%91%e6%88%98%e4%b8%8e%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88%e9%aa%8c%e8%af%81&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;Non-IID数据处理&lt;/strong&gt;：
我们使用Dirichlet分布（α=0.3）模拟真实联邦学习场景中的数据异构性，验证了我们的方法在数据分布不均衡情况下的鲁棒性。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;模型分区的通信效率&lt;/strong&gt;：
通过实际部署测试，验证了不同分区策略在各种网络条件下的表现，证明了动态分区策略的有效性。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;端到端训练的梯度传播&lt;/strong&gt;：
验证了跨设备梯度传播的正确性，确保分区模型能够进行有效的端到端训练。&lt;/p&gt;
&lt;p&gt;这些实验验证了WPTCN架构设计的合理性和技术路径的可行性，为后续的深入研究和实际应用奠定了基础。&lt;/p&gt;
&lt;h2&gt;6. 技术创新的深度剖析：从信号处理到个性化联邦学习&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;6-技术创新的深度剖析从信号处理到个性化联邦学习&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#6-%e6%8a%80%e6%9c%af%e5%88%9b%e6%96%b0%e7%9a%84%e6%b7%b1%e5%ba%a6%e5%89%96%e6%9e%90%e4%bb%8e%e4%bf%a1%e5%8f%b7%e5%a4%84%e7%90%86%e5%88%b0%e4%b8%aa%e6%80%a7%e5%8c%96%e8%81%94%e9%82%a6%e5%ad%a6%e4%b9%a0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;基于我们在时序建模和联邦学习领域的深入研究，WPTCN的技术创新体现在多个层面的突破。&lt;/p&gt;
&lt;h3&gt;6.1 频域分析的理论突破&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;61-频域分析的理论突破&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#61-%e9%a2%91%e5%9f%9f%e5%88%86%e6%9e%90%e7%9a%84%e7%90%86%e8%ae%ba%e7%aa%81%e7%a0%b4&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;传统的HAR方法主要依赖FFT进行频域分析，但我们发现这种方法在处理非平稳HAR信号时存在固有局限性。通过深入研究小波理论，我们实现了几个关键突破：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;小波包分解的自适应性&lt;/strong&gt;：与固定的FFT频带划分不同，小波包变换能够根据信号特性自适应地调整频域分辨率。在低频段提供更细的分辨率（适合捕捉缓慢的步行模式），在高频段提供粗糙的分辨率（适合捕捉快速的运动变化）。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;可学习滤波器的理论基础&lt;/strong&gt;：我们创新性地将小波滤波器参数设为可学习变量。从数学角度，这等价于在小波空间中进行参数优化：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 理论框架：在小波域中的优化&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;learnable_wavelet_optimization&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;    目标函数：min L(f_θ(WT(x)), y)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;    其中：WT是小波变换，θ是可学习的小波参数
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;    约束：θ必须满足小波的正交性和紧框架条件
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;    &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 正交性约束&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;orthogonality_loss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;θ_lo&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;θ_hi&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 重构完美性约束  &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;reconstruction_loss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;IWT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 总损失&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;total_loss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;classification_loss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;λ1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;orthogonality_loss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;λ2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;reconstruction_loss&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;这种设计确保了滤波器在学习过程中仍然保持小波的数学性质，同时能够适应特定的HAR任务需求。&lt;/p&gt;
&lt;h3&gt;6.2 现代时序建模架构的融合创新&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;62-现代时序建模架构的融合创新&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#62-%e7%8e%b0%e4%bb%a3%e6%97%b6%e5%ba%8f%e5%bb%ba%e6%a8%a1%e6%9e%b6%e6%9e%84%e7%9a%84%e8%9e%8d%e5%90%88%e5%88%9b%e6%96%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;我们的研究深入分析了当前时序建模的三大流派：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Transformer-based方法的局限性&lt;/strong&gt;：通过对iTransformer的深入分析，我们发现其在HAR任务中的主要问题是注意力机制对于短时序的HAR数据（通常2-10秒）过于复杂，存在过参数化问题。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;MLP+频域方法的启发&lt;/strong&gt;：FITS和FreTS的成功给了我们重要启发。这些方法证明了频域特征提取的重要性，但FFT的固定频带划分限制了其在非平稳信号上的表现。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;现代TCN的计算效率&lt;/strong&gt;：ModernTCN展示了卷积网络在时序任务中的潜力，但其固定的卷积核限制了多尺度特征提取能力。&lt;/p&gt;
&lt;p&gt;我们的WPTCN融合了这些方法的优势：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;采用小波包变换替代FFT，提供自适应频域分析&lt;/li&gt;
&lt;li&gt;保持卷积网络的计算效率，避免Transformer的过度复杂性&lt;/li&gt;
&lt;li&gt;通过可学习滤波器实现端到端优化&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;6.3 联邦学习中的个性化技术深化&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;63-联邦学习中的个性化技术深化&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#63-%e8%81%94%e9%82%a6%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e4%b8%aa%e6%80%a7%e5%8c%96%e6%8a%80%e6%9c%af%e6%b7%b1%e5%8c%96&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;基于我们在联邦学习方面的研究，我们发现传统FedAvg在HAR任务中面临严重的数据异构性问题。不同用户的行为模式差异巨大，需要更精细的个性化策略。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;分层个性化架构&lt;/strong&gt;：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;PersonalizedFederatedWPTCN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 共享特征提取层（小波变换参数全局共享）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shared_wavelet_params&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;GloballySharedParams&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 个性化表示层（TCN参数客户端特定）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;personalized_tcn&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ClientSpecificParams&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 全局分类器（跨客户端共享）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global_classifier&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;GloballySharedParams&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;federated_update&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;global_model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;个性化联邦更新策略&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 1. 更新共享的小波参数&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shared_wavelet_params&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;update_from_global&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global_model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;wavelet&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 2. 本地训练个性化TCN层&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;personalized_tcn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_train&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 3. 聚合全局分类器&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;classifier_update&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;compute_classifier_gradient&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;classifier_update&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;元学习增强的快速适应&lt;/strong&gt;：
受Per-FedAvg启发，我们设计了基于梯度的快速适应机制：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;meta_learning_adaptation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;support_set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;query_set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;    元学习快速适应新客户端
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;    支持集：少量本地数据用于快速适应
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;    查询集：评估适应后性能
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;    &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 一阶梯度适应&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;adapted_params&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global_params&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;α&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;grad&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;loss&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;support_set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# 二阶优化全局参数&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;meta_loss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;loss&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;query_set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;adapted_params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global_params&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;β&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;grad&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;meta_loss&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global_params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;h3&gt;6.4 缺陷传感器环境下的鲁棒性设计&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;64-缺陷传感器环境下的鲁棒性设计&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#64-%e7%bc%ba%e9%99%b7%e4%bc%a0%e6%84%9f%e5%99%a8%e7%8e%af%e5%a2%83%e4%b8%8b%e7%9a%84%e9%b2%81%e6%a3%92%e6%80%a7%e8%ae%be%e8%ae%a1&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;基于对&amp;quot;Flawed Wearable Sensor Data&amp;quot;相关工作的研究，我们在WPTCN中集成了处理传感器缺陷的机制：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;传感器故障检测与补偿&lt;/strong&gt;：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;RobustSensorFusion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sensor_types&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;acc_x&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;acc_y&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;acc_z&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;gyro_x&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;gyro_y&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;gyro_z&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sensor_reliability&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Parameter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ones&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sensor_types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;compensation_network&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ModuleDict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;sensor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Linear&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;input_dim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;output_dim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sensor&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sensor_types&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;forward&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sensor_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sensor_mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;        sensor_data: [batch, channels, time]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;        sensor_mask: [batch, channels] - 0表示传感器故障
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;        &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 自适应权重调整&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;reliability_weights&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sigmoid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sensor_reliability&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;weighted_data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sensor_data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;reliability_weights&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsqueeze&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 缺失传感器补偿&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;compensated_data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;compensate_missing_sensors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;weighted_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sensor_mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;compensated_data&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;h3&gt;6.5 跨模态联邦HAR前沿进展：MCARN模型深度解析&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;65-跨模态联邦har前沿进展mcarn模型深度解析&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#65-%e8%b7%a8%e6%a8%a1%e6%80%81%e8%81%94%e9%82%a6har%e5%89%8d%e6%b2%bf%e8%bf%9b%e5%b1%95mcarn%e6%a8%a1%e5%9e%8b%e6%b7%b1%e5%ba%a6%e8%a7%a3%e6%9e%90&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;近期IEEE TPAMI 2024发表的跨模态联邦人体活动识别（CM-FHAR）研究代表了该领域的最新突破。该工作首次系统性地解决了联邦学习场景下不同客户端持有不同模态数据的挑战。&lt;/p&gt;
&lt;h4&gt;CM-FHAR问题定义与挑战&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;cm-fhar问题定义与挑战&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#cm-fhar%e9%97%ae%e9%a2%98%e5%ae%9a%e4%b9%89%e4%b8%8e%e6%8c%91%e6%88%98&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;传统联邦学习假设所有客户端拥有相同类型的数据，但现实中客户端往往具有异构的模态：某些设备提供运动传感器数据，其他设备则仅有视频数据。这种模态异构性带来三大核心挑战：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;分布式跨模态特征学习&lt;/strong&gt;：在隐私约束下构建不同模态间的公共特征子空间&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;模态相关判别特征学习&lt;/strong&gt;：学习每种模态特有的判别模式&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;模态不平衡问题&lt;/strong&gt;：处理某些模态数据稀缺导致的训练偏差&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;MCARN架构创新&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;mcarn架构创新&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#mcarn%e6%9e%b6%e6%9e%84%e5%88%9b%e6%96%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;双编码器设计&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Altruistic Encoder（利他编码器）&lt;/strong&gt;：学习模态无关的共享特征表示&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Egocentric Encoder（自我中心编码器）&lt;/strong&gt;：捕获模态特定的判别特征&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;双分类器机制&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;全局共享分类器&lt;/strong&gt;：基于模态无关特征进行活动分类&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;模态私有分类器&lt;/strong&gt;：利用模态特定特征增强判别能力&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;关键技术组件&lt;/strong&gt;：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;对抗模态判别器&lt;/strong&gt;：通过对抗学习引导编码器产生模态不变特征&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;分离损失约束&lt;/strong&gt;：确保模态无关和模态特定特征的正交性&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;角度边距调整机制&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;对主导模态增加较大角度边距，增强类内紧凑性&lt;/li&gt;
&lt;li&gt;对稀少模态使用较小边距，提高模态间区分度&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;关系感知全局-本地校准&lt;/strong&gt;：约束共享分类器和私有分类器的类级配对关系&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;实验验证与性能表现&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;实验验证与性能表现&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ae%9e%e9%aa%8c%e9%aa%8c%e8%af%81%e4%b8%8e%e6%80%a7%e8%83%bd%e8%a1%a8%e7%8e%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;MCARN在多个跨模态数据集上验证了其有效性：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Stanford-ECM数据集&lt;/strong&gt;：包含传感器和视频数据的复合活动识别&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Ego-Exo-AR数据集&lt;/strong&gt;：第一人称视角与外部视角的跨模态数据&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Epic-Kitchens数据集&lt;/strong&gt;：厨房活动的多模态识别任务&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;实验结果表明，MCARN在所有测试场景中都显著优于现有方法，特别是在模态不平衡情况下表现尤为突出。&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/research/llm/realhitbench/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/research/llm/realhitbench/</guid>
      <description>
        
        
        &lt;h1&gt;超越扁平：RealHiTBench 如何为大语言模型（LLM）的表格处理能力设立新标杆&lt;/h1&gt;&lt;p&gt;随着大语言模型（LLMs）的飞速发展，它们在文本生成、摘要和对话方面的能力已经令人印象深刻。然而，当我们把目光从非结构化的文本转向结构化的表格数据时，一个更深层次的挑战浮现了：LLMs 真的能“理解”现实世界中那些复杂的、多层次的表格吗？&lt;/p&gt;
&lt;p&gt;《RealHiTBench: A Comprehensive Realistic Hierarchical Table Benchmark》里，我们不仅指出了当前评测基准的局限性，还通过构建一个极具挑战性的新基准，揭示了 SOTA 模型在真实复杂表格分析任务中的能力边界。&lt;/p&gt;
&lt;h2&gt;问题的根源：为什么我们需要一个新的表格评测基准？&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;问题的根源为什么我们需要一个新的表格评测基准&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e9%97%ae%e9%a2%98%e7%9a%84%e6%a0%b9%e6%ba%90%e4%b8%ba%e4%bb%80%e4%b9%88%e6%88%91%e4%bb%ac%e9%9c%80%e8%a6%81%e4%b8%80%e4%b8%aa%e6%96%b0%e7%9a%84%e8%a1%a8%e6%a0%bc%e8%af%84%e6%b5%8b%e5%9f%ba%e5%87%86&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;长期以来，许多流行的表格问答（TableQA）评测基准，比如 TAT-QA 和 TableBench，大多依赖于结构简单的“扁平表格” (flat tables)。这类表格中，每一行代表一个记录，每一列代表一个属性，结构清晰明了。&lt;/p&gt;
&lt;p&gt;但在经济、科学、社会等多个领域的实际应用中，表格的结构远比这复杂。为了在二维空间内呈现多维信息，人们创造了大量包含层级结构的表格。虽然已有一些工作（比如 HiTab）开始关注层级表格，但它们往往存在领域局限、格式有损（比如预处理成 JSON 破坏了原始结构）、或层级结构过于简单等问题。&lt;/p&gt;
&lt;p&gt;这种评测基准与现实应用之间的脱节，让我们无法准确评估 LLM 在处理真实世界复杂表格时的真正实力。而 RealHiTBench，正是我们为了填补这一空白所开发的工具。&lt;/p&gt;
&lt;h2&gt;RealHiTBench 的核心创新：定义并挑战“真·复杂”&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;realhitbench-的核心创新定义并挑战真复杂&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#realhitbench-%e7%9a%84%e6%a0%b8%e5%bf%83%e5%88%9b%e6%96%b0%e5%ae%9a%e4%b9%89%e5%b9%b6%e6%8c%91%e6%88%98%e7%9c%9f%e5%a4%8d%e6%9d%82&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;RealHiTBench 的核心贡献，在于我们对“复杂表格结构”的系统性定义和应用。它不只是数据的堆砌，更是对复杂性的深刻解构。在论文中，我们定义了五种典型的复杂结构，大家可以通过论文中的核心示例图（Figure 1）直观理解：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;层级列头 (Hierarchical Column Header)&lt;/strong&gt;：这可能是最常见的复杂结构。通过单元格合并，列头被组织成一个树状层级。比如在 Figure 1 中，“Average hours per day” 这个一级表头下，又分出了“Both full time”和“Mother part time &amp;amp; Father full time”两个二级表头，每个二级表头下还细分了“Mothers”和“Fathers”。这种结构要求模型必须理解列与列之间的从属关系。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;层级行头 (Hierarchical Row Header)&lt;/strong&gt;：与列头类似，行头也能通过缩进或多列分组来表示层级。在 Figure 1 中，“Household”这一项下面，通过缩进展示了“Housework”“Food”“Lawn”等多个子项，清晰表达了它们之间的包含关系。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;嵌套子表 (Nested Sub-Tables)&lt;/strong&gt;：有时，一个大表内部会由横跨整个表格宽度的特殊行（通常是标题行）分割成多个语义上独立的子区域。Figure 1 中，“Children under 18”“Children under 6”等橙色背景的行，就将整个表格划分成了针对不同年龄段儿童的独立统计区域。模型需要理解，对“所有儿童”的提问，可能并不意味着对所有数字进行简单加总。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;隐式多表连接 (Implicit Multi-Table Join)&lt;/strong&gt;：这是一种非常巧妙且在现实中常见的设计。从表面看，它可能只是一个大表，但实际上它并列了多个结构完全相同的子表，目的是实现数据间的直观对比。Figure 1 的左右两侧分别展示了“Children under 18”和“Children 7-12”等不同群组的数据，它们的列结构完全一致，这本身就蕴含了对比的语义。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;任务设计：不止于查找，更考验深度理解&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;任务设计不止于查找更考验深度理解&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%bb%bb%e5%8a%a1%e8%ae%be%e8%ae%a1%e4%b8%8d%e6%ad%a2%e4%ba%8e%e6%9f%a5%e6%89%be%e6%9b%b4%e8%80%83%e9%aa%8c%e6%b7%b1%e5%ba%a6%e7%90%86%e8%a7%a3&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;为了全面评估模型的能力，我们为 RealHiTBench 设计了五大类、包含多个子类的复杂任务：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;事实核查 (Fact Checking)&lt;/strong&gt;：包括需要整合多处信息进行验证的“多跳核查”，以及需要基于表格信息进行逻辑推理的“推理核查”。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;数值推理 (Numerical Reasoning)&lt;/strong&gt;：涵盖了计数、排序、比较和复杂计算等多种需要数学能力的任务。这要求模型不仅要定位数据，还要正确执行数学运算。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;数据分析 (Data Analysis)&lt;/strong&gt;：这是更高阶的任务，要求模型进行初步分析、总结、预测，甚至探索性分析和异常检测。比如，模型需要根据表格数据总结趋势或发现异常值。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;图表生成 (Chart Generation)&lt;/strong&gt;：要求模型根据数据生成可执行的代码来绘制图表，比如条形图、折线图等。这直接考验了模型将结构化数据转换为可视化代码的能力。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;结构理解 (Structure Comprehending)&lt;/strong&gt;：这是我们专为复杂表格设计的创新任务类型。我们会通过修改（比如交换）表格的某些结构部分，然后对新旧两个表格问同一个问题，以此评测模型是否真正理解结构变化对答案的决定性影响。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;TreeThinker：从“看”表格到“理解”表格结构&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;treethinker从看表格到理解表格结构&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#treethinker%e4%bb%8e%e7%9c%8b%e8%a1%a8%e6%a0%bc%e5%88%b0%e7%90%86%e8%a7%a3%e8%a1%a8%e6%a0%bc%e7%bb%93%e6%9e%84&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;在 RealHiTBench 中提出评测难题后，我们还探索了解决思路，设计了一个名为 &lt;strong&gt;TreeThinker&lt;/strong&gt; 的理解增强流水线。这个方案的核心思想很直观：在让 LLM 直接回答问题前，先引导它把表格的层级结构显式地解析成“树”的形式，从而将隐式的结构信息转化为显式的、可供模型直接利用的知识。&lt;/p&gt;
&lt;h3&gt;第一步：树生成 (Tree Generation) - 绘制“结构蓝图”&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第一步树生成-tree-generation---绘制结构蓝图&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e4%b8%80%e6%ad%a5%e6%a0%91%e7%94%9f%e6%88%90-tree-generation---%e7%bb%98%e5%88%b6%e7%bb%93%e6%9e%84%e8%93%9d%e5%9b%be&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;TreeThinker 首先会引导模型对表格进行结构化的自我解析，具体分为两步：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;编码与解释&lt;/strong&gt;：我们引导模型将每个表头（无论是行还是列）编码为一个包含四元素的元组 &lt;code&gt;T=(t1, t2, t3, t4)&lt;/code&gt;。这个元组能精确描述表头的全部信息：&lt;code&gt;t1&lt;/code&gt; 代表类型（行/列）和层级，&lt;code&gt;t2&lt;/code&gt; 和 &lt;code&gt;t3&lt;/code&gt; 代表它在表格中的起始和结束位置，&lt;code&gt;t4&lt;/code&gt; 则是单元格的具体内容。比如 &lt;code&gt;(R0, 1, 2, City)&lt;/code&gt; 就表示这是一个0级行头，从第1行跨越到第2行，内容是“City”。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;构建层级树&lt;/strong&gt;：得到所有表头的元组列表后，模型会根据它们的层级和跨越范围（起始、结束位置）确定父子关系。如果一个低层级的表头，其位置范围被一个高层级表头完全包含，那么它们之间就构成了父子关系。通过这种方式，原本扁平的表头列表会被组织成等级分明的“表头树”。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;第二步：基于树的推理 (Tree-based Reasoning) - 精准定位与思考&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第二步基于树的推理-tree-based-reasoning---精准定位与思考&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e4%ba%8c%e6%ad%a5%e5%9f%ba%e4%ba%8e%e6%a0%91%e7%9a%84%e6%8e%a8%e7%90%86-tree-based-reasoning---%e7%b2%be%e5%87%86%e5%ae%9a%e4%bd%8d%e4%b8%8e%e6%80%9d%e8%80%83&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;有了这张“结构蓝图”，推理过程会变得更精准高效，具体分为三步：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;分解与对齐&lt;/strong&gt;：模型首先会将用户的问题分解成一组关键词 &lt;code&gt;K=[k1, k2, ..., km]&lt;/code&gt;。之后，它会执行对齐操作，计算每个关键词 &lt;code&gt;k&lt;/code&gt; 与表头树中每个节点 &lt;code&gt;T&lt;/code&gt; 的匹配度 (&lt;code&gt;Align_LM(T,k)&lt;/code&gt;)。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;定位子表&lt;/strong&gt;：我们会设定一个特定阈值，只有匹配度超过阈值的表头节点才会被选中，形成一个与问题高度相关的“关键词-表头子树” (&lt;code&gt;H&#39;&lt;/code&gt;)。这个子树会指导模型从原始表格中精确抽取出回答问题所需的核心信息。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;迭代求精&lt;/strong&gt;：最后，TreeThinker 还采用了一种类似 ReAct 的多轮“思考-行动-结果”精炼策略，对抽出的信息进行迭代处理，最终生成答案。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;从实验结果来看，TreeThinker 的效果很显著。比如，在使用该方法后，GPT-4o 在图表生成任务上的 PASS@1 指标提升了惊人的 134.7%。这也印证了我们的判断：显式地理解表格结构，是解锁 LLM 更高阶表格处理能力的关键。&lt;/p&gt;
&lt;h2&gt;实验结果揭示的真相&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;实验结果揭示的真相&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ae%9e%e9%aa%8c%e7%bb%93%e6%9e%9c%e6%8f%ad%e7%a4%ba%e7%9a%84%e7%9c%9f%e7%9b%b8&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;我们用 RealHiTBench 对 25 个当前主流的 LLM 和 MLLM 进行了全面评测，得出的结果很值得思考：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;普遍表现不佳&lt;/strong&gt;：即便是像 GPT-4o 这样的顶级模型，在多数任务上的表现也远未达到理想状态，精确匹配率（EM）最高没超过 70。这说明 RealHiTBench 确实是一个极具挑战性的基准，也印证了我们构建它的价值。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;文本优于图像&lt;/strong&gt;：在处理复杂表格结构时，基于文本（尤其是 LaTeX 格式）的输入，平均表现要优于图像（PNG）输入。我们推测，这可能是因为文本格式能更无损地保留精细的结构信息。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;模型越大，推理越强&lt;/strong&gt;：拥有 671B MoE 架构的 DeepSeek-R1 在所有模型中表现最出色。这在一定程度上表明，强大的通用推理能力，对于攻克复杂表格结构至关重要。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;结语与展望&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;结语与展望&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%bb%93%e8%af%ad%e4%b8%8e%e5%b1%95%e6%9c%9b&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;这个工作给我最大的启发是：我们对 LLM 的评估，需要从“通用能力”转向“特定领域的深度能力”。在表格分析领域，这就意味着我们必须正视并量化“结构复杂性”这一核心挑战。&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/research/llm/vllm-optimization/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/research/llm/vllm-optimization/</guid>
      <description>
        
        
        &lt;h1&gt;VLLM 优化研究&lt;/h1&gt;&lt;p&gt;不愿提及&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/self-study/ai/agent/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/self-study/ai/agent/</guid>
      <description>
        
        
        &lt;h2&gt;实习&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;实习&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ae%9e%e4%b9%a0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://v2ex.com/member/sskyy&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://v2ex.com/member/sskyy&lt;/a&gt;
&lt;a href=&#34;https://chat.deepseek.com/share/c29wwvrc986fuudeyn&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://chat.deepseek.com/share/c29wwvrc986fuudeyn&lt;/a&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/self-study/ai/ai4sci/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/self-study/ai/ai4sci/</guid>
      <description>
        
        
        
      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/self-study/ai/gat/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/self-study/ai/gat/</guid>
      <description>
        
        
        &lt;h2&gt;1. 新的世界：图 (Graph) - 万物皆可连&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;1-新的世界图-graph---万物皆可连&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#1-%e6%96%b0%e7%9a%84%e4%b8%96%e7%95%8c%e5%9b%be-graph---%e4%b8%87%e7%89%a9%e7%9a%86%e5%8f%af%e8%bf%9e&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;到目前为止，我们处理的都是序列 (Sequence)，就像一串珍珠，有明确的前后顺序。但现实世界中，更多的数据结构长得像一张网，而不是一条线。&lt;/p&gt;
&lt;h3&gt;什么是图？&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;什么是图&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%bb%80%e4%b9%88%e6%98%af%e5%9b%be&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;节点 (Nodes/Vertices)：&lt;/strong&gt; 代表实体。可以是社交网络里的用户、分子结构里的原子、论文引用网络里的论文&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;边 (Edges)：&lt;/strong&gt; 代表实体之间的关系。可以是用户之间的&amp;quot;好友关系&amp;quot;、原子之间的&amp;quot;化学键&amp;quot;、论文之间的&amp;quot;引用关系&amp;quot;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;图结构的数据无处不在。它的核心在于连接性 (Connectivity)——谁和谁相连，以及如何相连，这其中蕴含着海量的信息。&lt;/p&gt;
&lt;h2&gt;2. 为什么不能把&amp;quot;大力&amp;quot;的Transformer直接&amp;quot;出奇迹&amp;quot;？&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;2-为什么不能把大力的transformer直接出奇迹&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#2-%e4%b8%ba%e4%bb%80%e4%b9%88%e4%b8%8d%e8%83%bd%e6%8a%8a%e5%a4%a7%e5%8a%9b%e7%9a%84transformer%e7%9b%b4%e6%8e%a5%e5%87%ba%e5%a5%87%e8%bf%b9&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;我们强大的Transformer，能让序列中任何两个词直接对话。那么，我们能不能把图里的所有节点粗暴地&amp;quot;拉直&amp;quot;成一个1D序列，然后直接扔给Transformer呢？&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;答案是：绝对不行！&lt;/strong&gt; 这会引发两个灾难性的问题。&lt;/p&gt;
&lt;h3&gt;2.1 灾难一：计算的&amp;quot;维度爆炸&amp;quot;&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;21-灾难一计算的维度爆炸&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#21-%e7%81%be%e9%9a%be%e4%b8%80%e8%ae%a1%e7%ae%97%e7%9a%84%e7%bb%b4%e5%ba%a6%e7%88%86%e7%82%b8&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Transformer的本质：&lt;/strong&gt; 是全局注意力 (All-to-All)，它的计算复杂度是 $O(N^2)$，其中N是序列长度&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;图的尺度：&lt;/strong&gt; 对于一个包含100个单词的句子，计算 $100^2 = 10000$ 次注意力还可以接受。但对于一个真实的图，节点数可以轻易达到数万、数百万！&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;具体例子：&lt;/strong&gt; 一个中等大小的社交网络可能有10万用户。N=100,000，那么 $N^2 = 100$亿！这会让任何现代GPU都瞬间崩溃&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;全局注意力在图的世界里，计算成本高到无法承受。&lt;/p&gt;
&lt;h3&gt;2.2 灾难二：最宝贵信息的丢失&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;22-灾难二最宝贵信息的丢失&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#22-%e7%81%be%e9%9a%be%e4%ba%8c%e6%9c%80%e5%ae%9d%e8%b4%b5%e4%bf%a1%e6%81%af%e7%9a%84%e4%b8%a2%e5%a4%b1&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;这是更致命的问题。图的灵魂在于它的结构。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&amp;ldquo;邻居&amp;quot;的概念：&lt;/strong&gt; 在图中，&amp;ldquo;节点A和节点B是邻居&amp;quot;是一个至关重要的信息&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;拉直操作的破坏性：&lt;/strong&gt; 当你把一个图（比如上面的分子结构）强行拉成一个1D序列时，原本的邻居关系就被彻底打乱了&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;pre&gt;&lt;code&gt;[碳原子1, 碳原子2, 氧原子, 氢原子1, ...]&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;在这个序列里，模型无法知道&amp;quot;碳原子1&amp;quot;的直接邻居是&amp;quot;碳原子2&amp;quot;和&amp;quot;氧原子&amp;rdquo;，而不是&amp;quot;氢原子1&amp;rdquo;。它失去了所有的局部结构信息。把图拉直，就像把一张藏宝图剪成碎片再随机排成一行，地图本身已经失去了意义。&lt;/p&gt;
&lt;h2&gt;3. GAT的破局点：从&amp;quot;全局关注&amp;quot;到&amp;quot;邻里聚焦&amp;quot;&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;3-gat的破局点从全局关注到邻里聚焦&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#3-gat%e7%9a%84%e7%a0%b4%e5%b1%80%e7%82%b9%e4%bb%8e%e5%85%a8%e5%b1%80%e5%85%b3%e6%b3%a8%e5%88%b0%e9%82%bb%e9%87%8c%e8%81%9a%e7%84%a6&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;面对这两个灾难，图注意力网络 (GAT) 提出了一个极其优雅且直观的解决方案：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;既然全局关注不可行，那我们就只关注重要的！在图里，谁最重要？当然是我的邻居！&lt;/strong&gt;&lt;/p&gt;
&lt;h3&gt;3.1 GAT的核心思想&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;31-gat的核心思想&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#31-gat%e7%9a%84%e6%a0%b8%e5%bf%83%e6%80%9d%e6%83%b3&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;注意力计算不再是&amp;quot;All-to-All&amp;quot;，而是被图的结构所约束，只发生在有边直接连接的节点之间。&lt;/p&gt;
&lt;h3&gt;3.2 两大优势&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;32-两大优势&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#32-%e4%b8%a4%e5%a4%a7%e4%bc%98%e5%8a%bf&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;计算的拯救&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;计算的拯救&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%ae%a1%e7%ae%97%e7%9a%84%e6%8b%af%e6%95%91&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;图通常是稀疏的。一个节点平均可能只有几个或几十个邻居，而不是数万个。计算量从 $O(N^2)$ 急剧下降到 $O(|E|)$，其中 $|E|$ 是边的数量，这在计算上是完全可行的。&lt;/p&gt;
&lt;h4&gt;结构的保留&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;结构的保留&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%bb%93%e6%9e%84%e7%9a%84%e4%bf%9d%e7%95%99&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;通过只在邻居间计算注意力，模型天然地就尊重并利用了图的局部结构信息。它不再是一个&amp;quot;扁平&amp;quot;的世界，而是一个有远近、有亲疏的结构化世界。&lt;/p&gt;
&lt;h2&gt;4. edge_index：GAT的&amp;quot;注意力计算指南&amp;quot;&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;4-edge_indexgat的注意力计算指南&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#4-edge_indexgat%e7%9a%84%e6%b3%a8%e6%84%8f%e5%8a%9b%e8%ae%a1%e7%ae%97%e6%8c%87%e5%8d%97&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;现在我们解决了&amp;quot;应该在哪计算注意力&amp;quot;的问题，但还有一个技术问题：我们如何告诉计算机这个&amp;quot;计算模板&amp;quot;呢？&lt;/p&gt;
&lt;p&gt;这就是 edge_index 发挥作用的地方。你问过，&amp;ldquo;图就算用邻接矩阵都是2D的啊&amp;rdquo;，这个观察非常敏锐！但邻接矩阵对于稀疏图来说空间效率很低。edge_index 是一种更高效的稀疏表示。&lt;/p&gt;
&lt;h3&gt;4.1 edge_index 是什么？&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;41-edge_index-是什么&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#41-edge_index-%e6%98%af%e4%bb%80%e4%b9%88&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;它不是一个2D的&amp;quot;图像&amp;quot;矩阵，而是一个形状为 &lt;code&gt;[2, num_edges]&lt;/code&gt; 的张量。你可以把它理解成一个**&amp;ldquo;连接清单&amp;rdquo;**。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;第0行：&lt;/strong&gt; 所有边的源节点 (source) 索引&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;第1行：&lt;/strong&gt; 所有边的目标节点 (target) 索引&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;4.2 举个例子&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;42-举个例子&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#42-%e4%b8%be%e4%b8%aa%e4%be%8b%e5%ad%90&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;对于一个图：0 &amp;ndash; 1, 1 &amp;ndash; 2, 0 &amp;ndash; 2
它的 edge_index 就是：&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;tensor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;   &lt;span class=&#34;c1&#34;&gt;# 源节点&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]])&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 目标节点  (假设边是有向的)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;[0, 1]&lt;/code&gt; 这一列代表一条从节点0指向节点1的边&lt;/li&gt;
&lt;li&gt;&lt;code&gt;[1, 2]&lt;/code&gt; 这一列代表一条从节点1指向节点2的边&lt;/li&gt;
&lt;li&gt;&lt;code&gt;[0, 2]&lt;/code&gt; 这一列代表一条从节点0指向节点2的边&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;GAT就是拿着这份&amp;quot;连接清单&amp;quot;，精确地、只为清单上列出的这些节点对计算注意力。edge_index 成为了注意力机制的&amp;quot;导航地图&amp;quot;，完美地将图的结构信息注入到了计算流程中。&lt;/p&gt;
&lt;h2&gt;5. 场景设定：论文引用网络中的节点分类&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;5-场景设定论文引用网络中的节点分类&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#5-%e5%9c%ba%e6%99%af%e8%ae%be%e5%ae%9a%e8%ae%ba%e6%96%87%e5%bc%95%e7%94%a8%e7%bd%91%e7%bb%9c%e4%b8%ad%e7%9a%84%e8%8a%82%e7%82%b9%e5%88%86%e7%b1%bb&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;领域交叉：&lt;/strong&gt; 我们现在是计算机科学家，同时也是图书情报专家。&lt;/p&gt;
&lt;h3&gt;5.1 任务描述&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;51-任务描述&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#51-%e4%bb%bb%e5%8a%a1%e6%8f%8f%e8%bf%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;我们有一个包含7篇学术论文的引用网络。每篇论文本身有一个主题（比如&amp;quot;机器学习&amp;quot;、&amp;ldquo;生物学&amp;rdquo;、&amp;ldquo;物理学&amp;rdquo;），这是我们需要模型预测的标签。&lt;/p&gt;
&lt;h3&gt;5.2 图的构建&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;52-图的构建&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#52-%e5%9b%be%e7%9a%84%e6%9e%84%e5%bb%ba&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;节点 (Node)：&lt;/strong&gt; 一篇论文&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;边 (Edge)：&lt;/strong&gt; 如果论文A引用了论文B，就有一条从A指向B的边 (A -&amp;gt; B)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;节点特征 (Node Feature)：&lt;/strong&gt; 为了简单起见，我们假设通过论文摘要的关键词提取，为每篇论文生成了一个2维的特征向量&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;5.3 GAT要解决的问题&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;53-gat要解决的问题&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#53-gat%e8%a6%81%e8%a7%a3%e5%86%b3%e7%9a%84%e9%97%ae%e9%a2%98&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;一篇论文的学术影响力，不应该由所有引用它的论文平均决定。一篇来自同领域顶级会议的引用，其&amp;quot;价值&amp;quot;远高于一篇来自不相关领域的跨界引用。我们希望模型能自动学会，为不同重要性的邻居（引用/被引论文）分配不同的注意力权重。&lt;/p&gt;
&lt;h3&gt;5.4 具体实例：一个7节点的引用网络&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;54-具体实例一个7节点的引用网络&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#54-%e5%85%b7%e4%bd%93%e5%ae%9e%e4%be%8b%e4%b8%80%e4%b8%aa7%e8%8a%82%e7%82%b9%e7%9a%84%e5%bc%95%e7%94%a8%e7%bd%91%e7%bb%9c&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;节点 (7篇论文)：&lt;/strong&gt; P0, P1, P2, P3, P4, P5, P6&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;真实类别：&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;机器学习 (ML): P0, P1, P2&lt;/li&gt;
&lt;li&gt;生物学 (Bio): P3, P4&lt;/li&gt;
&lt;li&gt;物理学 (Phy): P5, P6&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;引用关系 (边)：&lt;/strong&gt; 如上图所示。注意 P0 是一篇&amp;quot;明星论文&amp;quot;，被多篇其他论文引用。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;初始特征 (2维)：&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;P0:[1, 1], P1:[1, 2], P2:[2, 1], P3:[8, 7], P4:[7, 8], P5:[1, 8], P6:[2, 7]&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;(我们故意让同类别的论文特征在空间上更接近)&lt;/p&gt;
&lt;h2&gt;6. 数学公式详解：以更新节点P0为例&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;6-数学公式详解以更新节点p0为例&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#6-%e6%95%b0%e5%ad%a6%e5%85%ac%e5%bc%8f%e8%af%a6%e8%a7%a3%e4%bb%a5%e6%9b%b4%e6%96%b0%e8%8a%82%e7%82%b9p0%e4%b8%ba%e4%be%8b&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;我们的目标是利用其邻居 P1, P2, P3, P5 的信息，来更新 P0 的特征。&lt;/p&gt;
&lt;h3&gt;6.1 第零步：初始特征变换&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;61-第零步初始特征变换&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#61-%e7%ac%ac%e9%9b%b6%e6%ad%a5%e5%88%9d%e5%a7%8b%e7%89%b9%e5%be%81%e5%8f%98%e6%8d%a2&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;首先，所有节点的特征都会经过一个共享的线性变换（乘以权重矩阵W），将它们投影到一个更高维的特征空间。假设W将2维特征变为4维。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;公式：&lt;/strong&gt; $h&amp;rsquo;_i = Wh_i$&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;示例：&lt;/strong&gt; P0的新特征 $h&amp;rsquo;_{P0} = W \cdot [1,1]^T$&lt;/p&gt;
&lt;h3&gt;6.2 第一步：计算注意力系数 $e_{ij}$&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;62-第一步计算注意力系数-e_ij&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#62-%e7%ac%ac%e4%b8%80%e6%ad%a5%e8%ae%a1%e7%ae%97%e6%b3%a8%e6%84%8f%e5%8a%9b%e7%b3%bb%e6%95%b0-e_ij&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;现在，P0要依次&amp;quot;评估&amp;quot;它与每个邻居的相关性。我们以邻居P1为例。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;公式：&lt;/strong&gt; $e_{P0,P1} = LeakyReLU(a^T [h&amp;rsquo;&lt;em&gt;{P0} || h&amp;rsquo;&lt;/em&gt;{P1}])$&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;解释：&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$[h&amp;rsquo;&lt;em&gt;{P0} || h&amp;rsquo;&lt;/em&gt;{P1}]$: 将P0和P1的4维变换后特征拼接成一个8维向量&lt;/li&gt;
&lt;li&gt;$a^T$: 用一个可学习的注意力向量 $a$ (8维) 与这个拼接向量做点积，得到一个标量分数&lt;/li&gt;
&lt;li&gt;$LeakyReLU$: 对这个分数进行非线性激活&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;结果：&lt;/strong&gt; P0会得到4个分数：$e_{P0,P1}, e_{P0,P2}, e_{P0,P3}, e_{P0,P5}$&lt;/p&gt;
&lt;h3&gt;6.3 第二步：邻域Softmax归一化&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;63-第二步邻域softmax归一化&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#63-%e7%ac%ac%e4%ba%8c%e6%ad%a5%e9%82%bb%e5%9f%9fsoftmax%e5%bd%92%e4%b8%80%e5%8c%96&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;这是GAT的灵魂！Softmax只在P0的邻居集合 P1, P2, P3, P5 上进行。&lt;/p&gt;
&lt;p&gt;公式: α_P0,P1=
exp(e_P0,P1)+exp(e_P0,P2)+exp(e_P0,P3)+exp(e_P0,P5)
exp(e_P0,P1)
​&lt;/p&gt;
&lt;p&gt;结果: 我们得到4个注意力权重 α_P0,P1,α_P0,P2,α_P0,P3,α_P0,P5，它们的和为1。&lt;/p&gt;
&lt;h3&gt;6.4 第三步：加权聚合&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;64-第三步加权聚合&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#64-%e7%ac%ac%e4%b8%89%e6%ad%a5%e5%8a%a0%e6%9d%83%e8%81%9a%e5%90%88&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;P0的新特征是其邻居特征的加权平均，权重就是我们刚刚算出的 α。&lt;/p&gt;
&lt;p&gt;公式: h
′′
∗P0=ReLU(∑∗j∈P1,P2,P3,P5α_P0,jh
′
_j)&lt;/p&gt;
&lt;p&gt;结果: h
′′
_P0 就是P0更新后的特征向量。它吸收了邻居的信息，并且是“有选择性”地吸收——对它认为更重要的邻居（α值高的），吸收得更多。&lt;/p&gt;
&lt;h2&gt;7. 代码实现与结果分析 (PyTorch Geometric)&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;7-代码实现与结果分析-pytorch-geometric&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#7-%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0%e4%b8%8e%e7%bb%93%e6%9e%9c%e5%88%86%e6%9e%90-pytorch-geometric&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;现在，我们用代码来复现这个过程，并看看模型到底学到了什么。&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;torch&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;torch.nn.functional&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;F&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;torch_geometric.data&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Data&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;torch_geometric.nn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;GATConv&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;numpy&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# --- 1. 构建我们的7节点引用网络图 ---&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 节点特征 (7个节点, 2维特征)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tensor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# ML papers (P0, P1, P2)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;# Bio papers (P3, P4)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;           &lt;span class=&#34;c1&#34;&gt;# Phy papers (P5, P6)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dtype&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 边 (引用关系, 注意是 source -&amp;gt; target)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# P1-&amp;gt;P0, P2-&amp;gt;P0, P3-&amp;gt;P0, P5-&amp;gt;P0, P3-&amp;gt;P4, P4-&amp;gt;P3, P5-&amp;gt;P6, P6-&amp;gt;P5&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;edge_index&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tensor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 源节点&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;   &lt;span class=&#34;c1&#34;&gt;# 目标节点&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dtype&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;long&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 创建图数据对象&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;edge_index&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;edge_index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# --- 2. 定义一个简单的GAT模型 ---&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;SimpleGAT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;torch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nn&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;super&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;fm&#34;&gt;__init__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 定义一个GAT层。&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# in_channels=2 (原始特征维度)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# out_channels=4 (输出特征维度)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# heads=2 (使用2个注意力头)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# concat=True (拼接2个头的结果，最终输出维度为 4*2=8)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;gat_layer&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;GATConv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;in_channels&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;out_channels&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;heads&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;concat&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;forward&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# return_attention_weights=True 是关键！&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;# 它会额外返回一个包含(edge_index, attention_weights)的元组&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;edge_idx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;attention_weights&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;gat_layer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;edge_index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;return_attention_weights&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;edge_idx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;attention_weights&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# --- 3. 运行模型并分析结果 ---&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 实例化并运行模型&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SimpleGAT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;eval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# 使用评估模式，不进行训练&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;final_embeddings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;attn_edge_idx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;attn_weights&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;--- 初始节点特征 ---&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;round&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;numpy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;--- GAT更新后的节点嵌入 (2个头拼接，8维) ---&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;round&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;final_embeddings&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;detach&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;numpy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;--- 学到的注意力权重 (2个头) ---&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 打印每个头为每条边学到的权重&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;src&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tgt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;enumerate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;attn_edge_idx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Edge &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;src&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; -&amp;gt; &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tgt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;: Head 1 Alpha = &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;attn_weights&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.3f&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;, Head 2 Alpha = &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;attn_weights&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.3f&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# --- 4. 深入分析：看看节点P0的邻居获得了多少注意力 ---&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;--- 深入分析：P0的邻居注意力分配 ---&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# P0是目标节点(target=0)的边有 P1-&amp;gt;P0, P2-&amp;gt;P0, P3-&amp;gt;P0, P5-&amp;gt;P0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 它们在edge_index中的索引分别是 0, 1, 2, 3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p0_neighbors_indices&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p0_neighbor_nodes&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;目标节点: P0&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;node_idx&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;enumerate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p0_neighbors_indices&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;src_node&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p0_neighbor_nodes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;head1_alpha&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;attn_weights&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;node_idx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;head2_alpha&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;attn_weights&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;node_idx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;  - 来自邻居 P&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;src_node&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; 的注意力: Head 1 = &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;head1_alpha&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.3f&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;, Head 2 = &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;head2_alpha&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.3f&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;结果解读&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;你的具体数值会因为模型参数的随机初始化而略有不同&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;，&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;但趋势和结论是类似的&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;。&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;输出示例&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;：&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;---&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;深入分析&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;：&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;P0的邻居注意力分配&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;---&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;目标节点&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;来自邻居&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P1&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;的注意力&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Head&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.352&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Head&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.401&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;来自邻居&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P2&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;的注意力&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Head&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.361&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Head&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.388&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;来自邻居&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P3&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;的注意力&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Head&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.135&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Head&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.095&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;来自邻居&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P5&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;的注意力&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Head&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.152&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Head&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.116&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;分析结论&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;：&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;同类更重要&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;：&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;模型&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;（&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;即使是未经训练的&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;）&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;也倾向于给特征更相似的邻居更高的权重&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;。&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;P0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P2&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;都是&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;“&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;机器学习&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;”&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;论文&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;，&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;它们的初始特征很接近&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;。&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;因此&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;，&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;模型给&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;P0&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;和&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;P0&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;的引用分配了非常高的注意力权重&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;（&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;比如&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Head&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;中&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;，&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.352&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;和&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.361&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;）。&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;异类被抑制&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;：&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;P3&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;（&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;生物学&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;）&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;和&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P5&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;（&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;物理学&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;）&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;与&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P0&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;的特征差异很大&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;。&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;因此&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;，&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;模型认为这两篇跨领域的引用对于确定&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P0&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;的身份不那么重要&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;，&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;所以分配了较低的注意力权重&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;（&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;比如&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Head&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;中&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;，&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.135&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;和&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.152&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;）。&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;多头学不同&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;：&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;注意&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Head&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;和&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Head&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;的权重分配并不完全相同&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;。&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;这表明两个头可能在学习不同的&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;“&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;邻里关系&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;”&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;模式&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;。&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;经过训练后&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;，&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;这种差异会更明显&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;。&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;最终&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;，&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;P0的新特征向量&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;P0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;$，&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;就是由&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P5&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;的变换后特征&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;，&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;按照上述这些权重加权求和得到的&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;。&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;它更多地吸收了来自同领域论文&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P1&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;和&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P2&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;的信息&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;，&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;而相对忽略了来自&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P3&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;和&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P5&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;的信息&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;，&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;从而使得更新后的&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;P0&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;特征能够更好地代表其&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;机器学习&amp;#34;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;的本质&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;。&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;## 8. Transformer vs GAT 对比总结&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;对比维度&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;标准Transformer&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Encoder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;图注意力网络&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;GAT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;|---------|-------------------------|-------------------|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;输入数据结构&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;**&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;D序列&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Sequence&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;br&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;例如&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;：&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;一句话中的单词序列&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;图结构&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Graph&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;br&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;例如&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;：&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;分子中的原子&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;（&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;节点&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;）&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;和化学键&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;（&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;边&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;）&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;注意力范围&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Scope&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;**&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;全局&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Global&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;All&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;All&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;br&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;序列中每个元素都会关注所有其他元素&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;局部&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;稀疏&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Local&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Sparse&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;br&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;节点只关注与它有边直接相连的邻居&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Softmax归一化范围&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;**&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;在整个输入序列上进行归一化&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;只在节点的局部邻域&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Neighborhood&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;内进行归一化&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;结构&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;位置信息&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;**&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;需要外部注入&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;br&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;本身无法感知顺序&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;，&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;必须依赖位置编码&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Positional&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Encoding&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;天然利用图结构&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;br&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;通过&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;edge_index&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;定义的连接关系&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;，&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;天然地利用了图的拓扑结构&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;计算复杂度&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;**&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;O&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;^&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; \&lt;span class=&#34;n&#34;&gt;cdot&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;br&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;N是序列长度&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;，&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;计算量随长度平方增长&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;O&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;E&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; \&lt;span class=&#34;n&#34;&gt;cdot&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;br&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;E&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;是边的数量&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;，&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;对于稀疏图效率更高&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;核心应用&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;**&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;自然语言处理&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;NLP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;、&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;时间序列预测&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;、&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;计算机视觉&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ViT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;分子建模&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;、&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;社交网络分析&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;、&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;推荐系统&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;、&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;知识图谱&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/self-study/ai/graphics/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/self-study/ai/graphics/</guid>
      <description>
        
        
        
      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/self-study/ai/llm/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/self-study/ai/llm/</guid>
      <description>
        
        
        &lt;p&gt;等我有空了基于&lt;a href=&#34;https://github.com/bbruceyuan/LLMs-Zero-to-Hero&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;LLM zero2hero&lt;/a&gt;这个来学习手写LLM，当然作者主页也给了中文翻译的 Hands-On-Large-Language-Models (hands-on-llms)值得一看，但是现在的主线不是这个，每日也分不出多余的时间出来
原理手撕差不多了之后，可以到(&lt;a href=&#34;https://github.com/Shubhamsaboo/awesome-llm-apps&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/Shubhamsaboo/awesome-llm-apps&lt;/a&gt;)找点喜欢的项目&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/self-study/ai/multimodal/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/self-study/ai/multimodal/</guid>
      <description>
        
        
        
      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/self-study/ai/nlp/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/self-study/ai/nlp/</guid>
      <description>
        
        
        &lt;h2&gt;学习资源&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;学习资源&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ad%a6%e4%b9%a0%e8%b5%84%e6%ba%90&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;CS224N 斯坦福课程&lt;/li&gt;
&lt;li&gt;《自然语言处理综论》&lt;/li&gt;
&lt;li&gt;Hugging Face 课程&lt;/li&gt;
&lt;li&gt;Papers With Code NLP 任务&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;&lt;em&gt;本页面内容正在完善中&amp;hellip;&lt;/em&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/self-study/embodied/llm4x/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/self-study/embodied/llm4x/</guid>
      <description>
        
        
        
      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/self-study/embodied/vla/act/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/self-study/embodied/vla/act/</guid>
      <description>
        
        
        &lt;p&gt;import CollapsibleBlock from &amp;lsquo;@site/src/components/CollapsibleBlock&amp;rsquo;;
import { NoteBlock } from &amp;lsquo;@site/src/components/HighlightBlock&amp;rsquo;;&lt;/p&gt;
&lt;p&gt;来入门一下 &lt;strong&gt;VLA&lt;/strong&gt; 这篇吹的神乎其神的&lt;a href=&#34;https://arxiv.org/pdf/2304.13705&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;《Learning Fine-Grained Bimanual Manipulation with Low-Cost Hardware》&lt;/a&gt;，是在 &lt;strong&gt;2023年&lt;/strong&gt; 提出的 &lt;strong&gt;Action Chunking with Transformers&lt;/strong&gt;（基于 Transformer 的动作分块算法），所谓 &lt;strong&gt;VLA 领域的鼻祖级动作生成算法&lt;/strong&gt;（但是他们自吹自擂为元宇宙）&lt;/p&gt;
&lt;p&gt;该 &lt;strong&gt;ACT 算法&lt;/strong&gt;是 VLA 领域首个以 &lt;strong&gt;&amp;ldquo;动作分块（Action Chunking）&amp;rdquo;&lt;/strong&gt; 为核心的 &lt;strong&gt;Transformer 模型&lt;/strong&gt;，专门解决机器人从 &lt;strong&gt;&amp;ldquo;V-L指令&amp;rdquo;&lt;/strong&gt; 到 &lt;strong&gt;&amp;ldquo;精准动作执行&amp;rdquo;&lt;/strong&gt; 的端到端映射问题 —— 这正是 &lt;strong&gt;VLA 的核心目标&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;找这玩意不太容易，Arxiv结果里面还有 &lt;strong&gt;cogACT&lt;/strong&gt;、&lt;strong&gt;MM-ACT&lt;/strong&gt; 这些，其中 &lt;strong&gt;CogACT&lt;/strong&gt; 是将 OpenVLA 的离散动作预测替换为 &lt;strong&gt;DiT&lt;/strong&gt;（让我想起cognav了）&lt;strong&gt;MM-ACT&lt;/strong&gt; 是通过多模态协同优化 VLA 的感知 - 执行效率&lt;/p&gt;
&lt;p&gt;而所谓的 &lt;strong&gt;ALOHA&lt;/strong&gt; 就是 &lt;strong&gt;A LOW-COST OPEN-SOURCE HARDWARE SYSTEM FOR BIMANUAL TELEOPERATION&lt;/strong&gt;，项目地址在 &lt;a href=&#34;https://tonyzhaozh.github.io/aloha/&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://tonyzhaozh.github.io/aloha/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;其核心贡献是一个&lt;strong&gt;遥操作（teleoperation）系统&lt;/strong&gt;和一个&lt;strong&gt;IL算法&lt;/strong&gt;，这样就能不用昂贵的硬件去做到下面的一些事情，比如开瓶盖啥的：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/img/vla/act-cando.png&#34; alt=&#34;&#34;  loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;通过遥操作演示收集数据（&lt;strong&gt;视觉+动作&lt;/strong&gt;）之后，就开始用收集的数据训练 &lt;strong&gt;ACT 算法&lt;/strong&gt;，从而训练好的模型可以自主完成任务。然而现有&lt;strong&gt;模仿学习算法&lt;/strong&gt;在需要&lt;strong&gt;高频控制和闭环反馈&lt;/strong&gt;的细粒度任务中表现不佳&lt;/p&gt;
&lt;CollapsibleBlock title=&#34;什么是PID控制器？&#34;&gt;
&lt;p&gt;&lt;strong&gt;PID控制器&lt;/strong&gt;（Proportional-Integral-Derivative Controller）是一种经典的&lt;strong&gt;闭环反馈控制算法&lt;/strong&gt;，用于让系统输出精确跟踪目标值。&lt;/p&gt;
&lt;h3&gt;PID的三个组成部分&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;pid的三个组成部分&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pid%e7%9a%84%e4%b8%89%e4%b8%aa%e7%bb%84%e6%88%90%e9%83%a8%e5%88%86&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;P（比例项，Proportional）&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;根据当前误差（目标值 - 实际值）产生控制信号&lt;/li&gt;
&lt;li&gt;误差越大，控制力度越大&lt;/li&gt;
&lt;li&gt;问题：可能产生稳态误差（永远达不到目标）&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;I（积分项，Integral）&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;累积历史误差，消除稳态误差&lt;/li&gt;
&lt;li&gt;如果长时间有误差，积分项会逐渐增大控制力度&lt;/li&gt;
&lt;li&gt;问题：可能导致系统响应过慢或振荡&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;D（微分项，Derivative）&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;根据误差变化率预测未来趋势&lt;/li&gt;
&lt;li&gt;提前&amp;quot;刹车&amp;quot;，防止超调&lt;/li&gt;
&lt;li&gt;问题：对噪声敏感&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;PID输出公式：&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;pre&gt;&lt;code&gt;u(t) = Kp × e(t) &amp;#43; Ki × ∫e(t)dt &amp;#43; Kd × de(t)/dt&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;其中：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;e(t)&lt;/code&gt; = 误差（目标值 - 实际值）&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Kp, Ki, Kd&lt;/code&gt; = 三个可调参数&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;在ALOHA/ACT中的作用&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;在alohaact中的作用&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%9c%a8alohaact%e4%b8%ad%e7%9a%84%e4%bd%9c%e7%94%a8&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;在 &lt;strong&gt;ALOHA&lt;/strong&gt; 系统中，&lt;strong&gt;PID控制器&lt;/strong&gt;有两个层面的应用：&lt;/p&gt;
&lt;h4&gt;1. &lt;strong&gt;底层关节控制（Dynamixel电机内置PID）&lt;/strong&gt;&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;1-底层关节控制dynamixel电机内置pid&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#1-%e5%ba%95%e5%b1%82%e5%85%b3%e8%8a%82%e6%8e%a7%e5%88%b6dynamixel%e7%94%b5%e6%9c%ba%e5%86%85%e7%bd%aepid&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;作用&lt;/strong&gt;：让机械臂关节精确到达目标位置&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;输入&lt;/strong&gt;：&lt;strong&gt;ACT模型&lt;/strong&gt;预测的目标关节位置（如&amp;quot;关节1应该转到45度&amp;quot;）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;过程&lt;/strong&gt;：&lt;strong&gt;PID控制器&lt;/strong&gt;实时计算：
&lt;ul&gt;
&lt;li&gt;读取当前关节实际位置（如&amp;quot;现在在40度&amp;quot;）&lt;/li&gt;
&lt;li&gt;计算误差 = 45° - 40° = 5°&lt;/li&gt;
&lt;li&gt;根据PID算法计算电机应该施加的力矩&lt;/li&gt;
&lt;li&gt;电机转动，关节向目标位置移动&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;输出&lt;/strong&gt;：关节实际位置逐渐接近目标位置&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;为什么需要PID？&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ACT模型&lt;/strong&gt;只给出&amp;quot;目标位置&amp;quot;，但实际执行会有误差（摩擦力、负载变化等）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;PID控制器&lt;/strong&gt;通过&lt;strong&gt;高频反馈&lt;/strong&gt;（通常几百到几千Hz）实时调整，确保关节精确到达目标&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;2. &lt;strong&gt;主从遥操作中的力控制&lt;/strong&gt;&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;2-主从遥操作中的力控制&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#2-%e4%b8%bb%e4%bb%8e%e9%81%a5%e6%93%8d%e4%bd%9c%e4%b8%ad%e7%9a%84%e5%8a%9b%e6%8e%a7%e5%88%b6&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;在数据收集阶段：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;主臂&lt;/strong&gt;：人类操作员手动控制&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;从臂&lt;/strong&gt;：跟随主臂动作&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;PID作用&lt;/strong&gt;：通过主从臂关节位置的&lt;strong&gt;差异&lt;/strong&gt;来间接控制施加的力
&lt;ul&gt;
&lt;li&gt;如果从臂位置落后主臂，PID会增加力矩让从臂跟上&lt;/li&gt;
&lt;li&gt;这样就能&amp;quot;感受&amp;quot;到操作时的力反馈&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/CollapsibleBlock&gt;
&lt;h2&gt;A. Action Chunking and Temporal Ensemble&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;a-action-chunking-and-temporal-ensemble&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#a-action-chunking-and-temporal-ensemble&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;通过 &lt;strong&gt;ALOHA&lt;/strong&gt; 采集人类演示数据过程会导致&lt;strong&gt;误差积累&lt;/strong&gt;：前序动作的误差会不断叠加，导致机器人状态偏离训练分布。&lt;/p&gt;
&lt;p&gt;为在&lt;strong&gt;像素到动作的策略框架&lt;/strong&gt;下解决&lt;strong&gt;模仿学习的误差累积问题&lt;/strong&gt;，本文选择将一系列动作组合成一个单元进行存储和执行，以降低高频采集的长轨迹任务的&lt;strong&gt;有效时间跨度&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;在实现中，文章将&lt;strong&gt;分块大小固定为 k&lt;/strong&gt;：每 k 步，智能体接收一次观测，生成后续 k 步动作并依次执行如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/img/vla/act-action-chunk.png&#34; alt=&#34;&#34;  loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;任务的&lt;strong&gt;有效时间跨度被缩短为原来的 1/k&lt;/strong&gt;。具体来说，策略建模的是 &lt;strong&gt;πₜ(at:t+k|st)&lt;/strong&gt;，而非传统的 &lt;strong&gt;πₜ(at|st)&lt;/strong&gt;。&lt;strong&gt;动作分块&lt;/strong&gt;还能处理人类演示中的&lt;strong&gt;非马尔可夫行为&lt;/strong&gt;：单步策略难以应对时间相关的混杂因素（如演示过程中的停顿）因为此类行为不仅依赖当前状态，还与时间步相关；而当混杂因素处于一个分块内时，动作分块可在不引入历史条件策略因果混淆问题的前提下缓解该问题。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;动作分块的朴素实现存在局限性&lt;/strong&gt;：每 k 步才引入新的环境观测，会导致机器人运动卡顿。为提升运动平滑度、避免执行与观测之间的离散切换，我们在每个时间步都查询策略，使得不同动作块相互重叠，单个时间步会存在多个预测动作。所以上面引入了&lt;strong&gt;Temporal Ensemble&lt;/strong&gt;，对这些预测进行融合：采用&lt;strong&gt;指数加权方案&lt;/strong&gt; &lt;strong&gt;wi = exp(−m×i)&lt;/strong&gt;（其中 w₀ 为最早动作的权重）对预测动作进行加权平均。参数 &lt;strong&gt;m&lt;/strong&gt; 控制新观测的融合速度，m 越小，融合速度越快。与传统平滑方法（将当前动作与相邻时间步动作聚合，易引入偏差）不同，我们聚合的是针对同一时间步的预测动作，且无需额外训练成本，仅增加推理阶段的计算量。实践证明，&lt;strong&gt;动作分块与时间集成是 ACT 实现精准平滑运动的关键&lt;/strong&gt;。&lt;/p&gt;
&lt;h2&gt;B. Modeling Human Data&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;b-modeling-human-data&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#b-modeling-human-data&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;另一项挑战是从&lt;strong&gt;含噪声的人类演示&lt;/strong&gt;中学习：面对相同观测，人类可能采用不同轨迹完成任务，且在精度要求较低的区域行为随机性更强。因此，策略需重点关注&lt;strong&gt;高精度需求区域&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;我们通过将&lt;strong&gt;动作分块策略训练为生成模型&lt;/strong&gt;来解决该问题，具体采用**条件变分自编码器（CVAE）**以当前观测为条件生成动作序列。&lt;strong&gt;CVAE&lt;/strong&gt; 包含编码器和解码器两部分：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;编码器&lt;/strong&gt;：仅用于训练解码器（即策略），测试时被舍弃。具体而言，编码器以当前观测和动作序列为输入，预测&lt;strong&gt;风格变量 z&lt;/strong&gt;（服从对角高斯分布）的均值和方差；为加快训练速度，实际训练中仅使用&lt;strong&gt;本体感受观测&lt;/strong&gt;和动作序列，不含图像观测。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;解码器（策略）&lt;/strong&gt;：以 z 和当前完整观测（图像 + 关节位置）为输入预测动作序列；测试时，将 z 设为先验分布的均值（即 0），实现&lt;strong&gt;确定性解码&lt;/strong&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;模型训练目标是最大化演示动作块的对数似然（即 &lt;strong&gt;minθ −∑st,at:t+k∈D log πₜ(at:t+k|st)&lt;/strong&gt;），采用标准 &lt;strong&gt;VAE 损失&lt;/strong&gt;（含重建损失和编码器高斯先验正则化损失），并通过超参数 &lt;strong&gt;β&lt;/strong&gt; 对正则化损失加权。直观来看，β 越大，z 传递的信息越少。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/img/vla/act-architecture.png&#34; alt=&#34;&#34;  loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h3&gt;ACT 架构详解&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;act-架构详解&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#act-%e6%9e%b6%e6%9e%84%e8%af%a6%e8%a7%a3&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;核心目的&lt;/strong&gt;：ACT 要做的是&amp;quot;看当前画面 + 机器人关节状态，预测未来 k 步动作&amp;quot;。上图展示了完整的&amp;quot;输入→处理→输出&amp;quot;流程。&lt;strong&gt;CVAE&lt;/strong&gt; 的作用是处理人类演示的噪声（比如不同人做同一动作的差异），&lt;strong&gt;Transformer&lt;/strong&gt; 的作用是处理&amp;quot;多摄像头图像 + 序列动作&amp;quot;的依赖关系（比如先看顶部摄像头再看腕部摄像头，动作要连贯）。&lt;/p&gt;
&lt;h4&gt;左图：CVAE 编码器（训练时用，测试时丢弃）&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;左图cvae-编码器训练时用测试时丢弃&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%b7%a6%e5%9b%becvae-%e7%bc%96%e7%a0%81%e5%99%a8%e8%ae%ad%e7%bb%83%e6%97%b6%e7%94%a8%e6%b5%8b%e8%af%95%e6%97%b6%e4%b8%a2%e5%bc%83&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;核心功能&lt;/strong&gt;：把&amp;quot;人类演示的动作序列 + 机器人关节状态&amp;quot;压缩成一个&lt;strong&gt;风格变量 z&lt;/strong&gt;。z 就像一个&amp;quot;动作风格密码&amp;quot;，能捕捉人类操作的随机性（比如有人插电池快、有人慢，但都能成功）。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;具体流程&lt;/strong&gt;：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;输入&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;人类演示的&amp;quot;动作块&amp;quot;（比如插电池的 k 步连续动作：at~at+k）&lt;/li&gt;
&lt;li&gt;机器人的关节观测（不含图像，因为图像信息多、训练慢，且关节状态已能反映核心姿态：ōt）&lt;/li&gt;
&lt;li&gt;为了适配 Transformer，会在最前面加一个可学习的 &lt;strong&gt;&amp;quot;[CLS]&amp;quot;&lt;/strong&gt; 标记（和 BERT 一样，用来汇总全局信息）&lt;/li&gt;
&lt;li&gt;最终形成 &lt;strong&gt;&amp;quot;[CLS] + 关节状态 + k 步动作&amp;quot;&lt;/strong&gt; 的序列（长度是 k+2）&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;处理&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;这个序列输入到&amp;quot;类 BERT 的 Transformer 编码器&amp;quot;后，会被逐层提取特征&lt;/li&gt;
&lt;li&gt;重点是把&amp;quot;动作块的规律 + 关节状态的关联&amp;quot;浓缩到 &lt;strong&gt;&amp;quot;[CLS]&amp;quot;&lt;/strong&gt; 标记对应的特征向量里&lt;/li&gt;
&lt;li&gt;然后用这个特征向量预测一个&amp;quot;对角高斯分布&amp;quot;（就是统计里的&amp;quot;均值 + 方差&amp;quot;）&lt;/li&gt;
&lt;li&gt;从这个分布里采样，就得到了&lt;strong&gt;风格变量 z&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;为什么需要编码器？&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;训练时用来&amp;quot;约束 z 的分布&amp;quot;（让 z 接近标准正态分布），这样 z 能高效编码人类动作的&amp;quot;风格差异&amp;quot;，又不会包含无关噪声&lt;/li&gt;
&lt;li&gt;测试时不用它，直接把 z 设为 0（标准正态分布的均值），避免额外计算&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;右图：CVAE 解码器（核心！测试时实际控制机器人的&amp;quot;策略&amp;quot;）&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;右图cvae-解码器核心测试时实际控制机器人的策略&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%8f%b3%e5%9b%becvae-%e8%a7%a3%e7%a0%81%e5%99%a8%e6%a0%b8%e5%bf%83%e6%b5%8b%e8%af%95%e6%97%b6%e5%ae%9e%e9%99%85%e6%8e%a7%e5%88%b6%e6%9c%ba%e5%99%a8%e4%ba%ba%e7%9a%84%e7%ad%96%e7%95%a5&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;核心功能&lt;/strong&gt;：把&amp;quot;当前多摄像头图像 + 机器人关节状态 + 风格变量 z&amp;quot;，转换成&amp;quot;未来 k 步的机器人目标关节动作&amp;quot;——这就是机器人实际要执行的指令。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;具体流程&lt;/strong&gt;（分 3 步）：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;第一步：处理图像（CNN + 位置编码）&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;每路图像先过 &lt;strong&gt;ResNet18&lt;/strong&gt;（一个图像特征提取网络），把 480×640 的图变成 15×20×512 的特征图（缩小尺寸、提取关键信息，比如夹爪位置、电池轮廓）&lt;/li&gt;
&lt;li&gt;然后把特征图展平成 300×512 的序列，再加上&lt;strong&gt;2D 正弦位置编码&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;这一步是为了保留图像的空间信息（比如&amp;quot;电池在画面左上角&amp;quot;这个位置关系），不然 Transformer 不知道像素的位置意义&lt;/li&gt;
&lt;li&gt;4 路图像都这么处理后，拼接成 &lt;strong&gt;1200×512&lt;/strong&gt; 的总图像特征序列&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;第二步：融合所有信息（Transformer 编码器）&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;把&amp;quot;总图像特征序列&amp;quot;和&amp;quot;经线性层投影到 512 维的关节位置 + z&amp;quot;拼接起来，形成 &lt;strong&gt;1202×512&lt;/strong&gt; 的&amp;quot;混合特征序列&amp;quot;（1200 来自 4 路图像，2 来自关节 + z）&lt;/li&gt;
&lt;li&gt;这个混合序列输入到 Transformer 编码器后，会被充分融合&lt;/li&gt;
&lt;li&gt;比如&amp;quot;腕部摄像头看到夹爪快碰到电池（图像特征）+ 关节状态显示夹爪张开（关节特征）+ z 是&amp;rsquo;轻柔风格&amp;rsquo;（z 特征）&amp;quot;，这些信息会被整合在一起，形成&amp;quot;当前状态的全局特征&amp;quot;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;第三步：生成动作序列（Transformer 解码器）&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;解码器的输入是&amp;quot;固定的位置编码&amp;quot;（长度 k，512 维）——相当于告诉模型&amp;quot;要生成 k 步动作，每一步的位置是固定的&amp;quot;&lt;/li&gt;
&lt;li&gt;解码器通过&lt;strong&gt;交叉注意力&lt;/strong&gt;（把编码器的输出当&amp;quot;键和值&amp;quot;，自己的位置编码当&amp;quot;查询&amp;quot;），一步步生成连贯的动作序列&lt;/li&gt;
&lt;li&gt;比如第一步&amp;quot;夹爪对准电池&amp;quot;，第二步&amp;quot;轻微闭合&amp;quot;，…，第 k 步&amp;quot;插入电池&amp;quot;&lt;/li&gt;
&lt;li&gt;最后用一个 &lt;strong&gt;MLP&lt;/strong&gt;（简单的全连接网络）把生成的 512 维特征，映射成 14 维的关节位置（双臂各 7 个自由度）&lt;/li&gt;
&lt;li&gt;最终输出 &lt;strong&gt;k×14&lt;/strong&gt; 的张量（未来 k 步的目标关节动作）&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;输出&lt;/strong&gt;：未来 k 步的机器人目标关节位置——比如&amp;quot;左臂关节 1 角度 30°、关节 2 角度 15°…，右臂关节 1 角度 20°…&amp;quot;，底层 &lt;strong&gt;PID 控制器&lt;/strong&gt;会跟踪这些目标位置，让机器人精准执行。&lt;/p&gt;
&lt;h4&gt;左图和右图的关联：训练时的&amp;quot;闭环&amp;quot;&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;左图和右图的关联训练时的闭环&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%b7%a6%e5%9b%be%e5%92%8c%e5%8f%b3%e5%9b%be%e7%9a%84%e5%85%b3%e8%81%94%e8%ae%ad%e7%bb%83%e6%97%b6%e7%9a%84%e9%97%ad%e7%8e%af&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;训练时，左图的编码器和右图的解码器是一起优化的：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;编码器生成 z，解码器用 z + 实时观测生成&amp;quot;预测动作块&amp;quot;（ât~at+k）&lt;/li&gt;
&lt;li&gt;用&amp;quot;预测动作块&amp;quot;和&amp;quot;人类演示的真实动作块&amp;quot;算&lt;strong&gt;重建损失&lt;/strong&gt;（确保预测动作像人类）&lt;/li&gt;
&lt;li&gt;同时用编码器预测的&amp;quot;高斯分布&amp;quot;和&amp;quot;标准正态分布&amp;quot;算 &lt;strong&gt;KL 散度&lt;/strong&gt;（正则化损失，确保 z 的分布合理）&lt;/li&gt;
&lt;li&gt;两个损失加起来（&lt;strong&gt;L = Lreconst + βLreg&lt;/strong&gt;），用 &lt;strong&gt;Adam 优化器&lt;/strong&gt;更新所有参数&lt;/li&gt;
&lt;li&gt;这样解码器（策略）就能学会&amp;quot;看观测、按风格，生成精准动作块&amp;quot;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;技术细节补充&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;技术细节补充&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%8a%80%e6%9c%af%e7%bb%86%e8%8a%82%e8%a1%a5%e5%85%85&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;观测数据&lt;/strong&gt;包含：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;4 路 480×640 分辨率的 RGB 图像&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;双机械臂关节位置&lt;/strong&gt;（共 7+7=14 个自由度）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;动作空间&lt;/strong&gt;为双机械臂的绝对关节位置（14 维向量），因此动作分块策略的输出为 &lt;strong&gt;k×14 维张量&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;损失函数&lt;/strong&gt;：我们采用 &lt;strong&gt;L1 损失&lt;/strong&gt;而非常用的 &lt;strong&gt;L2 损失&lt;/strong&gt;（MSE），因其能更精准地建模动作序列。实验发现，使用关节位置差值作为动作标签会导致性能下降。训练时使用标准 &lt;strong&gt;VAE 损失&lt;/strong&gt;（重建损失 + KL 散度正则化损失）。&lt;/p&gt;
&lt;h3&gt;训练算法&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;训练算法&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%ae%ad%e7%bb%83%e7%ae%97%e6%b3%95&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;NoteBlock title=&#34;Algorithm 1: ACT Training&#34;&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Demo&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dataset&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;D&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;chunk&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;size&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;weight&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;β&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Let&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;at&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ot&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;represent&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;action&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;observation&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;at&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;timestep&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;err&#34;&gt;¯&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ot&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;represent&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ot&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;without&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;image&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;observations&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Initialize&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;encoder&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;qφ&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;at&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;¯&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Initialize&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;decoder&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;πθ&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ˆat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;iteration&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;   &lt;span class=&#34;n&#34;&gt;Sample&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;at&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;D&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;   &lt;span class=&#34;n&#34;&gt;Sample&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;z&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;qφ&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;at&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;¯&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;   &lt;span class=&#34;n&#34;&gt;Predict&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ˆat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;πθ&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ˆat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;   &lt;span class=&#34;n&#34;&gt;Lreconst&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;MSE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ˆat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;at&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;   &lt;span class=&#34;n&#34;&gt;Lreg&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;DKL&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;qφ&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;at&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;¯&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;∥&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;I&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;  &lt;span class=&#34;n&#34;&gt;Update&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;θ&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;φ&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ADAM&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;L&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Lreconst&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;βLreg&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/NoteBlock&gt;
&lt;h3&gt;推理算法&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;推理算法&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%8e%a8%e7%90%86%e7%ae%97%e6%b3%95&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;NoteBlock title=&#34;Algorithm 2: ACT Inference&#34;&gt;
&lt;div class=&#34;hextra-code-block hx:relative hx:mt-6 hx:first:mt-0 hx:group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;trained&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;πθ&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;episode&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;length&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;weight&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Initialize&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;FIFO&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buffers&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;B&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;where&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;B&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;stores&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;n&#34;&gt;actions&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;predicted&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;timestep&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;timestep&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;T&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;   &lt;span class=&#34;n&#34;&gt;Predict&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ˆat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;πθ&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ˆat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;z&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;where&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;z&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;   &lt;span class=&#34;n&#34;&gt;Add&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ˆat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buffers&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;B&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;respectively&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;   &lt;span class=&#34;n&#34;&gt;Obtain&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;current&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;step&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;actions&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;At&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;B&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;   &lt;span class=&#34;n&#34;&gt;Apply&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;at&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Σi&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;wiAt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Σi&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;wi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;wi&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;exp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;−&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;×&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;end&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx:opacity-0 hx:transition hx:group-hover/code:opacity-100 hx:flex hx:gap-1 hx:absolute hx:m-[11px] hx:right-0 hx:top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx:group/copybtn hx:cursor-pointer hx:transition-all hx:active:opacity-50 hx:bg-primary-700/5 hx:border hx:border-black/5 hx:text-gray-600 hx:hover:text-gray-900 hx:rounded-md hx:p-1.5 hx:dark:bg-primary-300/10 hx:dark:border-white/10 hx:dark:text-gray-400 hx:dark:hover:text-gray-50&#34;
    title=&#34;复制代码&#34;
  &gt;
    &lt;div class=&#34;hextra-copy-icon hx:group-[.copied]/copybtn:hidden hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
&lt;div class=&#34;hextra-success-icon hx:hidden hx:group-[.copied]/copybtn:block hx:pointer-events-none hx:h-4 hx:w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/NoteBlock&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/self-study/embodied/vln/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/self-study/embodied/vln/</guid>
      <description>
        
        
        &lt;p&gt;UniGoal: Towards Universal Zero-shot Goal-oriented Navigation£¨CVPR2025£©
In this paper, we propose a general framework for universal zero-shot goal-oriented navigation. Existing zero-shot methods build inference framework upon large language models (LLM) for specific tasks, which differs a lot in overall pipeline and fails to generalize across different types of goal. Towards the aim of universal zero-shot navigation, we propose a uniform graph representation to unify different goals, including object category, instance image and text description. We also convert the observation of agent into an online maintained scene graph. With this consistent scene and goal representation, we preserve most structural information compared with pure text and are able to leverage LLM for explicit graph-based reasoning. Specifically, we conduct graph matching between the scene graph and goal graph at each time instant and propose different strategies to generate long-term goal of exploration according to different matching states. The agent first iteratively searches subgraph of goal when zero-matched. With partial matching, the agent then utilizes coordinate projection and anchor pair alignment to infer the goal location. Finally scene graph correction and goal verification are applied for perfect matching. We also present a blacklist mechanism to enable robust switch between stages. Extensive experiments on several benchmarks show that our UniGoal achieves state-of-the-art zero-shot performance on three studied navigation tasks with a single model, even outperforming task-specific zero-shot methods and supervised universal methods.&lt;/p&gt;
&lt;p&gt;RoboSpatial: Teaching Spatial Understanding to 2D and 3D Vision-Language Models for Robotics£¨CVPR2025 oral£©
Spatial understanding is a crucial capability that enables robots to perceive their surroundings, reason about their environment, and interact with it meaningfully. In modern robotics, these capabilities are increasingly provided by vision-language models. However, these models face significant challenges in spatial reasoning tasks, as their training data are based on general-purpose image datasets that often lack sophisticated spatial understanding. For example, datasets frequently do not capture reference frame comprehension, yet effective spatial reasoning requires understanding whether to reason from ego-, world, or object-centric perspectives. To address this issue, we introduce ROBOSPATIAL, a large-scale dataset for spatial understanding in robotics. It consists of real indoor and tabletop scenes, captured as 3D scans and egocentric images, and annotated with rich spatial information relevant to robotics. The dataset includes 1M images, 5k 3D scans, and 3M annotated spatial relationships, and the pairing of 2D egocentric images with 3D scans makes it both 2D- and 3D- ready. Our experiments show that models trained with ROBOSPATIAL outperform baselines on downstream tasks such as spatial affordance prediction, spatial relationship prediction, and robot manipulation.&lt;/p&gt;
&lt;p&gt;Vision-and-Language Navigation via Causal Learning£¨CVPR2024£©
In the pursuit of robust and generalizable environment perception and language understanding, the ubiquitous challenge of dataset bias continues to plague vision-andlanguage navigation (VLN) agents, hindering their performance in unseen environments. This paper introduces the generalized cross-modal causal transformer (GOAT), a pioneering solution rooted in the paradigm of causal inference. By delving into both observable and unobservable confounders within vision, language, and history, we propose the back-door and front-door adjustment causal learning (BACL and FACL) modules to promote unbiased learning by comprehensively mitigating potential spurious correlations. Additionally, to capture global confounder features, we propose a cross-modal feature pooling (CFP) module supervised by contrastive learning, which is also shown to be effective in improving cross-modal representations during pre-training. Extensive experiments across multiple VLN datasets (R2R, REVERIE, RxR, and SOON) underscore the superiority of our proposed method over previous state-of-the-art approaches. Code is available at https: //github.com/CrystalSixone/VLN-GOAT.&lt;/p&gt;
&lt;p&gt;NaVILA: Legged Robot Vision-Language-Action Model for Navigation£¨ICLR2025£©
This paper proposes to solve the problem of Visionand-Language Navigation with legged robots, which not only provides a flexible way for humans to command but also allows the robot to navigate through more challenging and cluttered scenes. However, it is non-trivial to translate human language  ? Equal contribution, ordered alphabetically. ? Equal advising.  instructions all the way to low-level leg joint actions. We propose NaVILA, a 2-level framework that unifies a Vision-LanguageAction model (VLA) with locomotion skills. Instead of directly predicting low-level actions from VLA, NaVILA first generates mid-level actions with spatial information in the form of language, (e.g., ¡°moving forward 75cm¡±), which serves as an input for a visual locomotion RL policy for execution. NaVILA substantially  arXiv:2412.04453v2 [cs.RO] 17 Feb 2025 improves previous approaches on existing benchmarks. The same advantages are demonstrated in our newly developed benchmarks with IsaacLab, featuring more realistic scenes, lowlevel controls, and real-world robot experiments.&lt;/p&gt;
&lt;p&gt;NaVid: Video-based VLM Plans the Next Step for Vision-and-Language Navigation&lt;/p&gt;
&lt;p&gt;SG-Nav: Online 3D Scene Graph Prompting for LLM-based Zero-shot Object Navigation
In this paper, we propose a new framework for zero-shot object navigation. Existing zero-shot object navigation methods prompt LLM with the text of spatially closed objects, which lacks enough scene context for in-depth reasoning. To better preserve the information of environment and fully exploit the reasoning ability of LLM, we propose to represent the observed scene with 3D scene graph. The scene graph encodes the relationships between objects, groups and rooms with a LLMfriendly structure, for which we design a hierarchical chain-of-thought prompt to help LLM reason the goal location according to scene context by traversing the nodes and edges. Moreover, benefit from the scene graph representation, we further design a re-perception mechanism to empower the object navigation framework with the ability to correct perception error. We conduct extensive experiments on MP3D, HM3D and RoboTHOR environments, where SG-Nav surpasses previous state-of-the-art zero-shot methods by more than 10% SR on all benchmarks, while the decision process is explainable. To the best of our knowledge, SG-Nav is the first zero-shot method that achieves even higher performance than supervised object navigation methods on the challenging MP3D benchmark. Project page.&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E6%98%A5%E5%A4%8F/%E4%BB%AA%E5%99%A8%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E6%98%A5%E5%A4%8F/%E4%BB%AA%E5%99%A8%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/</guid>
      <description>
        
        
        &lt;h1&gt;仪器系统设计&lt;/h1&gt;&lt;h2&gt;课程内容&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;课程内容&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%af%be%e7%a8%8b%e5%86%85%e5%ae%b9&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;考试形式&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;考试形式&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%80%83%e8%af%95%e5%bd%a2%e5%bc%8f&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;考试总分为100分，分为三大题型：&lt;/p&gt;
&lt;h4&gt;1. 判断辨析题（20分）&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;1-判断辨析题20分&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#1-%e5%88%a4%e6%96%ad%e8%be%a8%e6%9e%90%e9%a2%9820%e5%88%86&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;共10道题，每题2分&lt;/li&gt;
&lt;li&gt;作答时需首先判断对错&lt;/li&gt;
&lt;li&gt;如果判断为&amp;quot;对&amp;quot;，则直接得分&lt;/li&gt;
&lt;li&gt;如果判断为&amp;quot;错&amp;quot;，则除了写&amp;quot;错&amp;quot;之外，必须写出正确的表述（无需长篇大论，抓住关键词即可）&lt;/li&gt;
&lt;li&gt;注意：未判断对错的将至少扣除1分&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;2. 简答题（50分）&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;2-简答题50分&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#2-%e7%ae%80%e7%ad%94%e9%a2%9850%e5%88%86&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;共10道题，每题5分&lt;/li&gt;
&lt;li&gt;作答时无需长篇大论，注重理解而非死记硬背&lt;/li&gt;
&lt;li&gt;题目可能结合平时作业内容进行改编，例如更改测温仪的接口类型，考查对系统原理的理解及变通能力。即使是小组作业，也请确保对整体设计（如测温仪的蓝牙接口、通讯协议、命令协议等）有清晰的理解&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;3. 设计题（30分）&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;3-设计题30分&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#3-%e8%ae%be%e8%ae%a1%e9%a2%9830%e5%88%86&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;共3道设计题，总分30分（每题分值可能为8分、10分、12分不等，但总和为30分）&lt;/li&gt;
&lt;li&gt;设计题注重考察学生的整体设计思路，可能允许学生自定义仪器类型、接口类型以及硬件软件设计&lt;/li&gt;
&lt;li&gt;作答时需要按照设计步骤进行，并且该画图的地方要画图&lt;/li&gt;
&lt;li&gt;考试时无需携带计算器（无复杂计算），但建议携带尺子以方便画图&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;考试内容梳理&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;考试内容梳理&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%80%83%e8%af%95%e5%86%85%e5%ae%b9%e6%a2%b3%e7%90%86&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;考试内容主要围绕以下十讲的理解要点展开：&lt;/p&gt;
&lt;h4&gt;第一讲：仪器系统的设计基础&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第一讲仪器系统的设计基础&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e4%b8%80%e8%ae%b2%e4%bb%aa%e5%99%a8%e7%b3%bb%e7%bb%9f%e7%9a%84%e8%ae%be%e8%ae%a1%e5%9f%ba%e7%a1%80&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;理解仪器系统的基本框图和结构框图&lt;/li&gt;
&lt;li&gt;理解仪器硬件的几个主要部分（包括与人体的类比）&lt;/li&gt;
&lt;li&gt;理解仪器系统的设计要求&lt;/li&gt;
&lt;li&gt;理解仪器系统的设计原则（如经济性原则中的性价比概念）&lt;/li&gt;
&lt;li&gt;理解软件模块化的划分原则（模块化越大越好还是越小越好）&lt;/li&gt;
&lt;li&gt;理解下载和调试的概念与接口（例如调试过程中的焊接顺序）&lt;/li&gt;
&lt;li&gt;理解软件测试中的黑盒测试和白盒测试&lt;/li&gt;
&lt;li&gt;理解测试用例的过程（能自行设计测试用例）&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;第二讲：仪器的输入输出接口设置&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第二讲仪器的输入输出接口设置&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e4%ba%8c%e8%ae%b2%e4%bb%aa%e5%99%a8%e7%9a%84%e8%be%93%e5%85%a5%e8%be%93%e5%87%ba%e6%8e%a5%e5%8f%a3%e8%ae%be%e7%bd%ae&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;理解传感器信号的输出类型&lt;/li&gt;
&lt;li&gt;理解多路开关和多路分配器的概念&lt;/li&gt;
&lt;li&gt;理解信号调理电路的作用&lt;/li&gt;
&lt;li&gt;理解采样定律的应用&lt;/li&gt;
&lt;li&gt;理解AD转换器的分辨率概念&lt;/li&gt;
&lt;li&gt;理解AD转换器的选用原则&lt;/li&gt;
&lt;li&gt;理解DA的性能指标与应用（例如锯齿波、正弦波等波形的生成）&lt;/li&gt;
&lt;li&gt;理解驱动电路的一般概念（如小功率、中功率、大功率驱动电路选用）&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;第三讲：人机交互接口&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第三讲人机交互接口&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e4%b8%89%e8%ae%b2%e4%ba%ba%e6%9c%ba%e4%ba%a4%e4%ba%92%e6%8e%a5%e5%8f%a3&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;理解键盘去抖的原理&lt;/li&gt;
&lt;li&gt;理解键盘单词键入与联机处理的方法&lt;/li&gt;
&lt;li&gt;理解键盘扫描的处理方法&lt;/li&gt;
&lt;li&gt;理解三基色原理（如RGB数值表示颜色）&lt;/li&gt;
&lt;li&gt;理解断码式LED静态显示与动态显示的区别&lt;/li&gt;
&lt;li&gt;理解断码式LCD、点阵式LCD和彩色LCD的区别&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;第四讲：仪器的通讯接口设计&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第四讲仪器的通讯接口设计&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e5%9b%9b%e8%ae%b2%e4%bb%aa%e5%99%a8%e7%9a%84%e9%80%9a%e8%ae%af%e6%8e%a5%e5%8f%a3%e8%ae%be%e8%ae%a1&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;理解内总线和外总线的区别&lt;/li&gt;
&lt;li&gt;理解I²C总线的数据收发方式（一根线还是两根线）&lt;/li&gt;
&lt;li&gt;理解RS232与RS485串行通讯的异同点&lt;/li&gt;
&lt;li&gt;理解串行通讯的通讯协议和命令协议的概念&lt;/li&gt;
&lt;li&gt;理解USB接口的供电方式（总线供电与外供电的时机）&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;第五讲：仪器存储器的接口设计&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第五讲仪器存储器的接口设计&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e4%ba%94%e8%ae%b2%e4%bb%aa%e5%99%a8%e5%ad%98%e5%82%a8%e5%99%a8%e7%9a%84%e6%8e%a5%e5%8f%a3%e8%ae%be%e8%ae%a1&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;理解程序存储器与数据存储器的概念&lt;/li&gt;
&lt;li&gt;理解各类存储器的区别&lt;/li&gt;
&lt;li&gt;理解存储器的掉电保护技术&lt;/li&gt;
&lt;li&gt;理解存储器使用中的技术要点（如数据读写错误、寿命问题及处理方法）&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;第六讲：仪器的自动校准与质检技术&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第六讲仪器的自动校准与质检技术&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e5%85%ad%e8%ae%b2%e4%bb%aa%e5%99%a8%e7%9a%84%e8%87%aa%e5%8a%a8%e6%a0%a1%e5%87%86%e4%b8%8e%e8%b4%a8%e6%a3%80%e6%8a%80%e6%9c%af&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;理解仪器自动校准的过程（包括浮点运算如何转化为整数运算，为何这样做）&lt;/li&gt;
&lt;li&gt;理解仪器自检的一般概念&lt;/li&gt;
&lt;li&gt;理解故障检测与故障诊断的区别（故障检测回答&amp;quot;是否发生故障&amp;quot;，故障诊断回答&amp;quot;哪里发生了故障&amp;quot;）&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;第七讲：软测量与数据融合技术&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第七讲软测量与数据融合技术&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e4%b8%83%e8%ae%b2%e8%bd%af%e6%b5%8b%e9%87%8f%e4%b8%8e%e6%95%b0%e6%8d%ae%e8%9e%8d%e5%90%88%e6%8a%80%e6%9c%af&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;理解软测量技术的原理&lt;/li&gt;
&lt;li&gt;掌握应用软测量技术进行系统分析设计的能力（可能涉及创新设计题）&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;第八讲：虚拟仪器设计&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第八讲虚拟仪器设计&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e5%85%ab%e8%ae%b2%e8%99%9a%e6%8b%9f%e4%bb%aa%e5%99%a8%e8%ae%be%e8%ae%a1&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;理解虚拟仪器的定义与特点&lt;/li&gt;
&lt;li&gt;理解虚拟仪器的组成&lt;/li&gt;
&lt;li&gt;理解虚拟仪器驱动程序的设计原则&lt;/li&gt;
&lt;li&gt;理解GUI软件的设计原则&lt;/li&gt;
&lt;li&gt;理解虚拟仪器应用程序的开发环境&lt;/li&gt;
&lt;li&gt;理解图形化编程平台的特点&lt;/li&gt;
&lt;li&gt;理解虚拟仪器应用程序的软面板设计方法&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;第九讲：嵌入式人工智能技术&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第九讲嵌入式人工智能技术&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e4%b9%9d%e8%ae%b2%e5%b5%8c%e5%85%a5%e5%bc%8f%e4%ba%ba%e5%b7%a5%e6%99%ba%e8%83%bd%e6%8a%80%e6%9c%af&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;理解嵌入式人工智能模型效率的基本指标&lt;/li&gt;
&lt;li&gt;理解嵌入式人工智能的应用原则&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;第十讲：仪器系统的集成与应用&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;第十讲仪器系统的集成与应用&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%ac%e5%8d%81%e8%ae%b2%e4%bb%aa%e5%99%a8%e7%b3%bb%e7%bb%9f%e7%9a%84%e9%9b%86%e6%88%90%e4%b8%8e%e5%ba%94%e7%94%a8&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;理解仪器系统集成的特点与任务&lt;/li&gt;
&lt;li&gt;理解仪器系统集成的步骤（但不会单独考设计步骤，而是融入设计题中）&lt;/li&gt;
&lt;li&gt;掌握应用仪器系统设计技术进行系统集成设计的能力&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;复习笔记&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;复习笔记&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%a4%8d%e4%b9%a0%e7%ac%94%e8%ae%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e4%bb%aa%e5%99%a8%e7%b3%bb%e7%bb%9f%e8%ae%be%e8%ae%a1%e5%a4%8d%e4%b9%a0%e7%ac%94%e8%ae%b0.pdf&#34;&gt;仪器系统设计复习笔记&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;小作业&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;小作业&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%b0%8f%e4%bd%9c%e4%b8%9a&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;blockquote&gt;
  &lt;p&gt;待补充&amp;hellip;&amp;hellip;&lt;/p&gt;

&lt;/blockquote&gt;
&lt;h3&gt;hw1&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;hw1&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#hw1&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h3&gt;hw2&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;hw2&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#hw2&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h3&gt;hw3&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;hw3&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#hw3&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h3&gt;hw4&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;hw4&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#hw4&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h3&gt;hw5&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;hw5&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#hw5&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h3&gt;hw6&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;hw6&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#hw6&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h3&gt;hw7&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;hw7&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#hw7&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h3&gt;hw8&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;hw8&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#hw8&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h3&gt;hw9&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;hw9&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#hw9&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h3&gt;hw10&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;hw10&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#hw10&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h2&gt;大作业&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;大作业&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%a4%a7%e4%bd%9c%e4%b8%9a&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;blockquote&gt;
  &lt;p&gt;待补充&amp;hellip;&amp;hellip;&lt;/p&gt;

&lt;/blockquote&gt;
&lt;h3&gt;pj1&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;pj1&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pj1&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h3&gt;pj2&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;pj2&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pj2&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h3&gt;pj3&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;pj3&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pj3&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h3&gt;project&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;project&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#project&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e4%bb%aa%e5%99%a8%e7%b3%bb%e7%bb%9f%e8%ae%be%e8%ae%a1%e5%a4%a7%e4%bd%9c%e4%b8%9a%e6%8a%a5%e5%91%8a.pdf&#34;&gt;仪器系统设计大作业报告&lt;/a&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E6%98%A5%E5%A4%8F/%E7%94%9F%E4%BA%A7%E5%AE%9E%E4%B9%A0/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E6%98%A5%E5%A4%8F/%E7%94%9F%E4%BA%A7%E5%AE%9E%E4%B9%A0/</guid>
      <description>
        
        
        &lt;h1&gt;生产实习&lt;/h1&gt;&lt;h2&gt;概述&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;概述&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%a6%82%e8%bf%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;大三暑假期间的生产实习经历。&lt;/p&gt;
&lt;h2&gt;实习内容&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;实习内容&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ae%9e%e4%b9%a0%e5%86%85%e5%ae%b9&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;企业实践学习&lt;/li&gt;
&lt;li&gt;项目开发经验&lt;/li&gt;
&lt;li&gt;团队协作能力提升&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;学习收获&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;学习收获&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ad%a6%e4%b9%a0%e6%94%b6%e8%8e%b7&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;通过生产实习，我深入了解了企业的实际工作流程，提升了实践能力和团队协作能力。&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E6%98%A5%E5%A4%8F/%E7%94%9F%E7%89%A9%E5%8C%BB%E5%AD%A6%E4%BC%A0%E6%84%9F%E4%B8%8E%E6%A3%80%E6%B5%8B/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E6%98%A5%E5%A4%8F/%E7%94%9F%E7%89%A9%E5%8C%BB%E5%AD%A6%E4%BC%A0%E6%84%9F%E4%B8%8E%E6%A3%80%E6%B5%8B/</guid>
      <description>
        
        
        &lt;h1&gt;生物医学传感与检测&lt;/h1&gt;&lt;h2&gt;最后一课&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;最后一课&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%9c%80%e5%90%8e%e4%b8%80%e8%af%be&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;课程考核结构&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;课程考核结构&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%af%be%e7%a8%8b%e8%80%83%e6%a0%b8%e7%bb%93%e6%9e%84&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;这门课程的总成绩由两部分构成：笔试成绩占总分的60%，平时成绩占总分的40%。&lt;/p&gt;
&lt;p&gt;笔试为开卷考试，总分100分，不允许携带计算器，也去掉了计算题，并且是英文题目，中英作答皆可。这么宽宏的安排，不得不感谢学院组敢于改革的老师们，也因此没有日常笔记，只有对最后一课的总结。这里也非常欢迎大家通过学生会的学海领航去复习。&lt;/p&gt;
&lt;p&gt;建议携带一本英文教材+一本中文教材+一本高级词典。在去除计算题后，最难的题目就是出现陌生生物医学名词的选择题。&lt;/p&gt;
&lt;h3&gt;笔试内容分布&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;笔试内容分布&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ac%94%e8%af%95%e5%86%85%e5%ae%b9%e5%88%86%e5%b8%83&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;物理传感器 (第1-3章)&lt;/strong&gt;: 占50分。题型包括10个选择题（共20分）和4个简答分析题（共30分），可能需要绘图或运用公式。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;化学传感器 (第4章)&lt;/strong&gt;: 占25分。题型包括5个选择题和2个简答题。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;生物传感器 (第5章)&lt;/strong&gt;: 占25分。&lt;/p&gt;
&lt;h3&gt;物理传感器复习要点 (占50分)&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;物理传感器复习要点-占50分&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%89%a9%e7%90%86%e4%bc%a0%e6%84%9f%e5%99%a8%e5%a4%8d%e4%b9%a0%e8%a6%81%e7%82%b9-%e5%8d%a050%e5%88%86&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;物理传感器部分是考试的重点，内容庞杂但有规律可循。复习时可以围绕以下几个核心模块展开。&lt;/p&gt;
&lt;h4&gt;绪论与基本特性 (第1-2章)&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;绪论与基本特性-第1-2章&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%bb%aa%e8%ae%ba%e4%b8%8e%e5%9f%ba%e6%9c%ac%e7%89%b9%e6%80%a7-%e7%ac%ac1-2%e7%ab%a0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;核心概念&lt;/strong&gt;：传感器定义需要掌握国标和国际行业协会的定义，核心是&amp;quot;将被测量（非电量）按一定规律转换成可用输出信号（电量）的器件&amp;quot;。专业词汇方面需要了解侵入式/非侵入式检测、生物芯片、微流控、生物相容性等。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;传感器特性&lt;/strong&gt;：静态特性需要掌握灵敏度、重复度、迟滞、稳定度等7个关键指标的定义。动态特性需要理解上升时间、超调量等指标，并能区分一阶系统和二阶系统。二阶系统重点理解阻尼系数 (ζ) 在 0.3-0.7 之间系统性能最佳的原因，以及频率响应曲线中&amp;quot;平坦区&amp;quot;和&amp;quot;谐振峰&amp;quot;的不同应用场景（常规测量用平坦区，超声驱动用谐振峰）。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;测量技术&lt;/strong&gt;：了解直接/间接测量、有源/无源测量等概念。熟悉典型的测量系统框图，理解传感器作为信息获取前端在整个系统中的位置。&lt;/p&gt;
&lt;h4&gt;七大类物理传感器 (第3章)&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;七大类物理传感器-第3章&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%b8%83%e5%a4%a7%e7%b1%bb%e7%89%a9%e7%90%86%e4%bc%a0%e6%84%9f%e5%99%a8-%e7%ac%ac3%e7%ab%a0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;这是物理部分的核心，占分最多。复习每一类传感器时，都应遵循以下四个维度的框架：基本原理/机理、分类、重要特性、测量电路与应用。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;电阻式&lt;/strong&gt;：原理需要理解电阻与材料尺寸、电阻率的关系公式。重点掌握金属应变片的工作原理、灵敏度系数（约为2），以及电桥电路（单臂、半桥、全桥）在温度补偿和提高灵敏度中的应用。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;电感式&lt;/strong&gt;：分类包括自感式、互感式、电涡流式。重点掌握**LVDT（差动变压器式）**的结构、工作原理和测量电路，理解其解调过程。掌握电涡流传感器非接触测量的原理。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;电容式&lt;/strong&gt;：原理基于改变极板间距、面积或介电常数。特性是易受分布电容影响。重点掌握差动式电容传感器如何提高灵敏度并减小非线性误差。其独特的充放电式测量电路是难点。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;压电式&lt;/strong&gt;：特性是只能进行动态测量，是容性负载。重点理解正/逆压电效应、材料特性（压电陶瓷、石英晶体）、多片叠层的串并联方式，以及电压/电荷放大器的选择与电缆长度的关系。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;磁电式&lt;/strong&gt;：分类包括电磁感应式（测速度，无需供电）和霍尔式（基于半导体）。重点理解霍尔效应的原理，以及为何要选用半导体材料。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;光电式&lt;/strong&gt;：重点掌握内/外光电效应，理解光电管、光敏二极管/三极管等器件的伏安特性、光照特性和光谱特性图。光纤传感器的全反射原理也是关键。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;热电式&lt;/strong&gt;：重点区分热电阻 (RTD)、热敏电阻 (PTC/NTC) 和热电偶的原理、材料、优缺点和适用范围。热电偶无需外部供电是一大特点。&lt;/p&gt;
&lt;h3&gt;化学传感器 (25分)&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;化学传感器-25分&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%8c%96%e5%ad%a6%e4%bc%a0%e6%84%9f%e5%99%a8-25%e5%88%86&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;这部分内容偏向理论和概念，计算题较少。建议用图表和框图来辅助记忆。&lt;/p&gt;
&lt;h4&gt;化学传感器基础&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;化学传感器基础&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%8c%96%e5%ad%a6%e4%bc%a0%e6%84%9f%e5%99%a8%e5%9f%ba%e7%a1%80&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;核心概念&lt;/strong&gt;：组成需要理解化学传感器的三大模块：识别单元、换能器和信号处理单元。能画出基本框图。分类需要掌握三大类：离子传感器、气体传感器和湿度传感器。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;电化学基础&lt;/strong&gt;：电极体系需要明确工作电极（发生反应）、参比电极（提供稳定电位基准）和对电极（构成电流回路）各自的作用。能斯特方程需要掌握用于计算离子选择性电极电位的核心公式。双电层需要理解其在电极/电解质界面形成的概念，这是电极电位产生的基础。&lt;/p&gt;
&lt;h4&gt;主要化学传感器类型&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;主要化学传感器类型&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%b8%bb%e8%a6%81%e5%8c%96%e5%ad%a6%e4%bc%a0%e6%84%9f%e5%99%a8%e7%b1%bb%e5%9e%8b&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;离子传感器&lt;/strong&gt;：核心是所有类型都基于离子选择性膜和电极电位的测量。重点掌握离子选择性电极 (ISE) 的原理，并了解 ISFET（测沟道电流）和 LAPS（测光电流）是如何将其与半导体技术结合的。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;气体传感器&lt;/strong&gt;：重点理解不同类型气体传感器的检测机制。电化学式测电流，金属氧化物半导体 (MOS) 测电阻（需要高温加热，理解其响应曲线），固体电解质式测电压，声表面波 (SAW) 是质量敏感型。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;湿度传感器&lt;/strong&gt;：概念需要区分绝对湿度和相对湿度。类型需要了解电容式和电阻式湿度传感器（测相对湿度）以及干湿球法（测绝对湿度）的原理。&lt;/p&gt;
&lt;h4&gt;传感器阵列与系统&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;传感器阵列与系统&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%bc%a0%e6%84%9f%e5%99%a8%e9%98%b5%e5%88%97%e4%b8%8e%e7%b3%bb%e7%bb%9f&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;电子鼻 &amp;amp; 电子舌&lt;/strong&gt;：定义是它们是传感器阵列，而非单个传感器。原理是模仿人类嗅觉/味觉，使用交叉敏感、特异性不强的传感器阵列，结合模式识别算法来识别复杂的混合物（气体/液体）。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;微流控&lt;/strong&gt;：了解其在微小尺度上操控流体的概念及其在生物芯片中的应用。&lt;/p&gt;
&lt;h3&gt;生物传感器(25分)&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;生物传感器25分&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%94%9f%e7%89%a9%e4%bc%a0%e6%84%9f%e5%99%a825%e5%88%86&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;刘qj老师讲的比较意识流，而且可能会推销他的便携式柔性传感器的研究，2025学期也没考到。&lt;/p&gt;
&lt;h2&gt;电子教材&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;电子教材&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%94%b5%e5%ad%90%e6%95%99%e6%9d%90&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://pan.baidu.com/s/1NNHc0EFpxacHuUn2roDT3A?pwd=jdtn&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;生物医学传感与检测中文版第4版&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://pan.baidu.com/s/122a-VO8OYquclVSIJBupsA?pwd=x5wh&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;生物医学传感与检测英文版第2版&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;实验报告&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;实验报告&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ae%9e%e9%aa%8c%e6%8a%a5%e5%91%8a&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e4%bc%a0%e6%84%9flab1.pdf&#34;&gt;Lab 1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e4%bc%a0%e6%84%9flab2.pdf&#34;&gt;Lab 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e4%bc%a0%e6%84%9flab3.pdf&#34;&gt;Lab 3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e4%bc%a0%e6%84%9flab4.pdf&#34;&gt;Lab 4&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e4%bc%a0%e6%84%9flab5.pdf&#34;&gt;Lab 5&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e4%bc%a0%e6%84%9flab6.pdf&#34;&gt;Lab 6&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e4%bc%a0%e6%84%9flab7.pdf&#34;&gt;Lab 7&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;lab8&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;lab8&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#lab8&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;对化学和生物传感器仅做体验要求，无实验报告要求。&lt;/p&gt;
&lt;h2&gt;作业&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;作业&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%bd%9c%e4%b8%9a&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e4%bc%a0%e6%84%9fHW1.pdf&#34;&gt;HW 1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e4%bc%a0%e6%84%9fHW2.pdf&#34;&gt;HW 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e4%bc%a0%e6%84%9fhw3.pdf&#34;&gt;HW 3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e4%bc%a0%e6%84%9fhw4.pdf&#34;&gt;HW 4&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e4%bc%a0%e6%84%9fhw5.pdf&#34;&gt;HW 5&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E6%98%A5%E5%A4%8F/%E7%94%9F%E7%89%A9%E5%8C%BB%E5%AD%A6%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E6%98%A5%E5%A4%8F/%E7%94%9F%E7%89%A9%E5%8C%BB%E5%AD%A6%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/</guid>
      <description>
        
        
        &lt;h2&gt;参考教材&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;参考教材&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%8f%82%e8%80%83%e6%95%99%e6%9d%90&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Rafael C. Gonzalez and Richard E. Woods. Digital Image Processing (4th Edition), Pearson Education, Inc, 2019&lt;/li&gt;
&lt;li&gt;Rafael C. Gonzalez, Richard E. Woods, and Steven Eddins. Digital Image Processing with Matlab (4th Edition), Gatesmark Publishing, 2020&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.imageprocessingplace.com/&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Image Processing Place&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;吴丹，何宏建，张祎，赵立，林子暄，丁秋萍。《磁共振成像原理与应用》，科学出版社，2024（第九、十章）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&#34;https://pan.baidu.com/s/1VZXxrpR2LA2l6G-iYdAUNg?pwd=6knm&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;数字图像处理教材&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e6%95%b0%e5%ad%97%e5%9b%be%e5%83%8f%e5%a4%84%e7%90%86%e6%95%99%e6%9d%90.pdf&#34;&gt;数字图像处理教材&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e6%95%b0%e5%ad%97%e5%9b%be%e5%83%8f%e5%a4%84%e7%90%86%e4%b9%a0%e9%a2%98%e8%a7%a3%e7%ad%94.pdf&#34;&gt;数字图像处理习题解答&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;复习笔记&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;复习笔记&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%a4%8d%e4%b9%a0%e7%ac%94%e8%ae%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e7%94%9f%e7%89%a9%e5%8c%bb%e5%ad%a6%e5%9b%be%e5%83%8f%e5%a4%84%e7%90%86%e5%a4%8d%e4%b9%a0%e7%ac%94%e8%ae%b0.pdf&#34;&gt;生物医学图像处理复习笔记&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;大作业&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;大作业&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%a4%a7%e4%bd%9c%e4%b8%9a&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;明年肯定不会是这个垃圾选题了。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e7%94%9f%e7%89%a9%e5%8c%bb%e5%ad%a6%e5%9b%be%e5%83%8f%e5%a4%84%e7%90%86%e5%ae%9e%e9%aa%8c%e6%8a%a5%e5%91%8a.pdf&#34;&gt;生物医学图像处理实验报告&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;小作业&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;小作业&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%b0%8f%e4%bd%9c%e4%b8%9a&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;注：有错误之处&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e9%ab%98%e7%ba%a7%e7%a8%8b%e5%ba%8f%e8%ae%be%e8%ae%a1hw1.pdf&#34;&gt;高级程序设计 HW 1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e9%ab%98%e7%ba%a7%e7%a8%8b%e5%ba%8f%e8%ae%be%e8%ae%a1hw2.pdf&#34;&gt;高级程序设计 HW 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e5%9b%be%e5%83%8fhw1.pdf&#34;&gt;图像处理 HW 1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e5%9b%be%e5%83%8fhw2.pdf&#34;&gt;图像处理 HW 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e5%9b%be%e5%83%8fhw3.pdf&#34;&gt;图像处理 HW 3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e5%9b%be%e5%83%8fhw4.pdf&#34;&gt;图像处理 HW 4&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e5%9b%be%e5%83%8fhw5.pdf&#34;&gt;图像处理 HW 5&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e5%9b%be%e5%83%8fhw6.pdf&#34;&gt;图像处理 HW 6&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;实验报告&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;实验报告&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ae%9e%e9%aa%8c%e6%8a%a5%e5%91%8a&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e5%9b%be%e5%83%8flab1.pdf&#34;&gt;图像处理 Lab 1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e5%9b%be%e5%83%8flab2.pdf&#34;&gt;图像处理 Lab 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e5%9b%be%e5%83%8flab3.pdf&#34;&gt;图像处理 Lab 3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e5%9b%be%e5%83%8flab4.pdf&#34;&gt;图像处理 Lab 4&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e5%9b%be%e5%83%8flab5.pdf&#34;&gt;图像处理 Lab 5&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e5%9b%be%e5%83%8flab6.pdf&#34;&gt;图像处理 Lab 6&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e5%9b%be%e5%83%8flab7.pdf&#34;&gt;图像处理 Lab 7&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E6%98%A5%E5%A4%8F/%E7%94%B5%E5%AD%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E8%B7%B5/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E6%98%A5%E5%A4%8F/%E7%94%B5%E5%AD%90%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E8%B7%B5/</guid>
      <description>
        
        
        &lt;h1&gt;电子系统设计与实践&lt;/h1&gt;&lt;h2&gt;课程内容&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;课程内容&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%af%be%e7%a8%8b%e5%86%85%e5%ae%b9&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;课程分为理论课和实验课两部分，具体内容如下：&lt;/p&gt;
&lt;h3&gt;理论课（Mon 6、7）&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;理论课mon-67&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%90%86%e8%ae%ba%e8%af%bemon-67&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;课程模块&lt;/strong&gt;：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;测量误差分析与实验数据处理&lt;/li&gt;
&lt;li&gt;模拟电子线路基础&lt;/li&gt;
&lt;li&gt;数字逻辑电路基础&lt;/li&gt;
&lt;li&gt;电子线路计算机辅助分析与设计&lt;/li&gt;
&lt;li&gt;低频电子线路应用设计&lt;/li&gt;
&lt;li&gt;高频电子线路应用设计&lt;/li&gt;
&lt;li&gt;数字逻辑电路应用设计&lt;/li&gt;
&lt;li&gt;硬件描述语言及其应用&lt;/li&gt;
&lt;li&gt;高速数字电路设计基础&lt;/li&gt;
&lt;li&gt;综合性电子线路系统设计&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;实验课（Wedn 6、7、8、9）&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;实验课wedn-6789&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ae%9e%e9%aa%8c%e8%af%bewedn-6789&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;平日可去周楼407焊&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;实验课分为两个阶段&lt;/strong&gt;：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;第一阶段&lt;/strong&gt;：包括原理图、印刷电路板、元器件、工具和实验指导，主要任务是安装、调试和设计。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;第二阶段&lt;/strong&gt;：自主设计，包括定义系统、方案设计、硬件设计、软件设计与调试，以及总结报告。&lt;/p&gt;
&lt;h3&gt;实验步骤&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;实验步骤&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ae%9e%e9%aa%8c%e6%ad%a5%e9%aa%a4&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;第一阶段&lt;/strong&gt;：安装及调试（实验一至实验四），第一阶段验收（实验五及附加要求）。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;第二阶段&lt;/strong&gt;：系统设计，包括定义系统、方案设计、硬件设计、软件设计与调试，以及总结报告。&lt;/p&gt;
&lt;h3&gt;关于系统设计&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;关于系统设计&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%85%b3%e4%ba%8e%e7%b3%bb%e7%bb%9f%e8%ae%be%e8%ae%a1&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;系统定义&lt;/strong&gt;：温度测量系统&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;相关技术要求&lt;/strong&gt;：硬件结构设计、软件设计与调试&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;涉及相关知识&lt;/strong&gt;：微机原理、程序语言、信号处理、电子技术&lt;/p&gt;
&lt;h3&gt;注意事项&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;注意事项&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%b3%a8%e6%84%8f%e4%ba%8b%e9%a1%b9&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;实验课需要2-3人一组，分工合作，自主完成。&lt;/p&gt;
&lt;p&gt;实验课的考核成绩占总成绩的45%，理论课的考核成绩也占45%，平时作业占10%。&lt;/p&gt;
&lt;p&gt;课程内容涉及广泛的电子系统设计知识，需要学生具备一定的基础和实践能力。&lt;/p&gt;
&lt;h3&gt;考核指标&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;考核指标&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%80%83%e6%a0%b8%e6%8c%87%e6%a0%87&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;理论课&lt;/strong&gt;：书面考试，45%。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;实验课&lt;/strong&gt;：实验结果和实验报告，45%。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;平时作业&lt;/strong&gt;：包括一般作业和设计分析作业，10%。&lt;/p&gt;
&lt;h2&gt;实验报告&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;实验报告&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ae%9e%e9%aa%8c%e6%8a%a5%e5%91%8a&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;电设记忆示波器&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;电设记忆示波器&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%94%b5%e8%ae%be%e8%ae%b0%e5%bf%86%e7%a4%ba%e6%b3%a2%e5%99%a8&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e7%94%b5%e5%ad%90%e7%b3%bb%e7%bb%9f%e8%ae%be%e8%ae%a1%e4%b8%8e%e5%ae%9e%e8%b7%b5pj1.pdf&#34;&gt;电子系统设计与实践pj1&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;电设红外脉搏仪&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;电设红外脉搏仪&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%94%b5%e8%ae%be%e7%ba%a2%e5%a4%96%e8%84%89%e6%90%8f%e4%bb%aa&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e7%94%b5%e5%ad%90%e7%b3%bb%e7%bb%9f%e8%ae%be%e8%ae%a1%e4%b8%8e%e5%ae%9e%e8%b7%b5pj2.pdf&#34;&gt;电子系统设计与实践pj2&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;复习笔记&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;复习笔记&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%a4%8d%e4%b9%a0%e7%ac%94%e8%ae%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e7%94%b5%e5%ad%90%e7%b3%bb%e7%bb%9f%e8%ae%be%e8%ae%a1%e4%b8%8e%e5%ae%9e%e8%b7%b5.pdf&#34;&gt;电子系统设计与实践&lt;/a&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E6%98%A5%E5%A4%8F/%E7%A1%AC%E4%BB%B6%E6%8F%8F%E8%BF%B0%E8%AF%AD%E8%A8%80/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E6%98%A5%E5%A4%8F/%E7%A1%AC%E4%BB%B6%E6%8F%8F%E8%BF%B0%E8%AF%AD%E8%A8%80/</guid>
      <description>
        
        
        &lt;h1&gt;硬件描述语言&lt;/h1&gt;&lt;h2&gt;课程内容- concepts&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;课程内容--concepts&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%af%be%e7%a8%8b%e5%86%85%e5%ae%b9--concepts&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;- event driven / time driven
- time slots
- parallel process
- design verification
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;program module
&lt;ul&gt;
&lt;li&gt;master slave
&lt;ul&gt;
&lt;li&gt;handshake&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;clock domain&lt;/li&gt;
&lt;li&gt;RTL&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Timing
&lt;ul&gt;
&lt;li&gt;Delay(9种)
&lt;ul&gt;
&lt;li&gt;Best/worst/typical 三类
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;t输出 + tsetup &amp;lt;= T&lt;/code&gt; (worst)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;t输出 &amp;gt;= thold&lt;/code&gt; (best)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;采样窗口&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;程序流程图、Datapath、FSM
采样窗口&lt;/p&gt;
&lt;h2&gt;学习建议&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;学习建议&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ad%a6%e4%b9%a0%e5%bb%ba%e8%ae%ae&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;教学太晦涩，实验太简单，是完美符合【上交生存手册】定义的垃圾课。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://hdlbits.01xz.net/wiki/Main_Page&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;HDLbits刷题&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.runoob.com/w3cnote/verilog-tutorial.html&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;菜鸟教程辅助&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;教材方面以1、3、4、5、7、2的顺序进行教学，推荐英文版教材，但更推荐实验课PPT与学海领航PPT。&lt;/p&gt;
&lt;p&gt;强烈推荐&lt;a href=&#34;https://blog.csdn.net/weixin_60094035/article/details/126532981&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;配置VSCODE的iverilog&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://nc-ai.cn/article/cxnqr517/#digital-ide-all-in-one-vscode-plugin-for-verilog-vhdl-development&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Digital-IDE工作流&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;实验室参观&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;实验室参观&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ae%9e%e9%aa%8c%e5%ae%a4%e5%8f%82%e8%a7%82&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e7%a1%ac%e4%bb%b6%e6%8f%8f%e8%bf%b0%e8%af%ad%e8%a8%80%e4%bd%99%e9%94%8b%e5%ae%9e%e9%aa%8c%e5%ae%a4.pdf&#34;&gt;硬件描述语言余锋实验室&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;英文教材&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;英文教材&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%8b%b1%e6%96%87%e6%95%99%e6%9d%90&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e7%a1%ac%e4%bb%b6%e6%8f%8f%e8%bf%b0%e8%af%ad%e8%a8%80%e6%95%99%e6%9d%90.pdf&#34;&gt;数字图像处理教材&lt;/a&gt;
不要看中文教材，那个不是用自然语言写出来的。&lt;/p&gt;
&lt;h2&gt;复习笔记&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;复习笔记&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%a4%8d%e4%b9%a0%e7%ac%94%e8%ae%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e7%a1%ac%e4%bb%b6%e6%8f%8f%e8%bf%b0%e8%af%ad%e8%a8%80%e5%a4%8d%e4%b9%a0%e7%ac%94%e8%ae%b0.pdf&#34;&gt;硬件描述语言复习笔记&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;实验报告&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;实验报告&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ae%9e%e9%aa%8c%e6%8a%a5%e5%91%8a&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/hdl_lab1.pdf&#34;&gt;HDL Lab 1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/hdl_lab2.pdf&#34;&gt;HDL Lab 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/hdl_lab3.pdf&#34;&gt;HDL Lab 3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/hdl_lab4.pdf&#34;&gt;HDL Lab 4&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/hdl_lab5.pdf&#34;&gt;HDL Lab 5&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/hdl_lab6.pdf&#34;&gt;HDL Lab 6&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/hdl_lab7.pdf&#34;&gt;HDL Lab 7&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E6%98%A5%E5%A4%8F/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E6%98%A5%E5%A4%8F/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/</guid>
      <description>
        
        
        &lt;h1&gt;计算机网络&lt;/h1&gt;&lt;p&gt;成绩：40%作业+60%考试
考试不考应用层（意思意思一点点），相较于计院计网增加了很多物理层的东西，所以最后还是要根据ppt再复习一下&lt;/p&gt;
&lt;h2&gt;复习笔记&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;复习笔记&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%a4%8d%e4%b9%a0%e7%ac%94%e8%ae%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;有的地方不在考纲范围内，注意甄别。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e8%ae%a1%e7%bd%91%e7%ac%94%e8%ae%b0.pdf&#34;&gt;计网笔记&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;作业报告&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;作业报告&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%bd%9c%e4%b8%9a%e6%8a%a5%e5%91%8a&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e8%ae%a1%e7%bd%91lab1.pdf&#34;&gt;Lab 1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e8%ae%a1%e7%bd%91lab2.pdf&#34;&gt;Lab 2&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;lab3&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;lab3&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#lab3&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;这个算大作业？但其实交一份普通的web开发项目上去就OK，和《高级程序设计》类同。&lt;/p&gt;
&lt;h2&gt;参考资料&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;参考资料&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%8f%82%e8%80%83%e8%b5%84%e6%96%99&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://pan.baidu.com/s/1b6FCDBMth9hVlTSq-4nXRg?pwd=7ch2&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;计算机网络（第7版）-谢希仁&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[计算机网络(Andrew Tanenbaum  David Wetheral)](/pdfs/计算机网络(Andrew Tanenbaum  David Wetheral).pdf)&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E7%A7%8B%E5%86%AC/%E4%BF%A1%E5%8F%B7%E4%B8%8E%E7%B3%BB%E7%BB%9F/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E7%A7%8B%E5%86%AC/%E4%BF%A1%E5%8F%B7%E4%B8%8E%E7%B3%BB%E7%BB%9F/</guid>
      <description>
        
        
        &lt;h1&gt;信号与系统&lt;/h1&gt;&lt;h2&gt;最后一课&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;最后一课&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%9c%80%e5%90%8e%e4%b8%80%e8%af%be&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e6%95%b0%e5%ad%97%e4%bf%a1%e5%8f%b7%e5%a4%84%e7%90%86%e6%80%bb%e5%a4%8d%e4%b9%a0.pdf&#34;&gt;数字信号处理总复习&lt;/a&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E7%A7%8B%E5%86%AC/%E5%B5%8C%E5%85%A5%E5%BC%8F%E7%B3%BB%E7%BB%9F/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E7%A7%8B%E5%86%AC/%E5%B5%8C%E5%85%A5%E5%BC%8F%E7%B3%BB%E7%BB%9F/</guid>
      <description>
        
        
        &lt;h1&gt;嵌入式系统&lt;/h1&gt;&lt;p&gt;22级生仪讲的《嵌入式系统》师资暴打同期《生物医学成像技术》，但效果却并不好。
原因是多样化的，一方面在于，在于这门课本应配置大量的实验课，嵌入式开发这种实验学习最终就应该像《电路综合》那样做一个嵌入式的大作业；
另一方面在于，从上下来的角度分析，《嵌入式系统》实际上可以被表示成70%的计组+30%的OS。但是对应的课时却并不多，要命的是还没有HW，只有四个树莓派小实验，对比其和上学期学习的《微机原理》对UART的讲解就能理解它讲的到底有多快。
而且在顺序上也没有讲好嵌入式Linux，没有学到实际产业的东西，非常符合《上交生存手册》定义，其在大三春夏开课的《电子系统设计与实践》更是开历史的倒车。&lt;/p&gt;
&lt;h2&gt;课程内容&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;课程内容&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%af%be%e7%a8%8b%e5%86%85%e5%ae%b9&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;计组部分没什么好说的，不考汇编具体代码的话就是纯背PPT，然而有很多难以理解的概念，需要在平时花时间去研究，不然临考背诵会很痛苦。
研究完历年卷可以发现OS的占比随时间发展越来越低，原先还会考察线程、调度算法、虚拟内存等，现在一年比一年教的少，到后面只剩下银行家算法/producer-comsumer/reader-writer这类非记忆类的考点留下来了。因此前人留下的OS复习大纲与疫情前的回忆卷参考价值都少，需要更新。
考完回来补充，多选的考察真的很细，反而是OS部分不用花太多精力，只要课上理解就行。重点需要把精力放在【存储器管理单元MMU】【JTAG与嵌入式调试结构】【Linux内核驱动】这几节上。&lt;/p&gt;
&lt;h2&gt;最后一课&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;最后一课&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%9c%80%e5%90%8e%e4%b8%80%e8%af%be&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e5%b5%8c%e5%85%a5%e5%bc%8f%e7%b3%bb%e7%bb%9f%e6%9c%80%e5%90%8e%e4%b8%80%e8%af%be.pdf&#34;&gt;嵌入式系统最后一课&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;实验报告&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;实验报告&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ae%9e%e9%aa%8c%e6%8a%a5%e5%91%8a&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e5%b5%8c%e5%85%a5%e5%bc%8f%e7%b3%bb%e7%bb%9flab1.pdf&#34;&gt;Lab 1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e5%b5%8c%e5%85%a5%e5%bc%8f%e7%b3%bb%e7%bb%9flab2.pdf&#34;&gt;Lab 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e5%b5%8c%e5%85%a5%e5%bc%8f%e7%b3%bb%e7%bb%9flab3.pdf&#34;&gt;Lab 3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e5%b5%8c%e5%85%a5%e5%bc%8f%e7%b3%bb%e7%bb%9flab4.pdf&#34;&gt;Lab 4&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E7%A7%8B%E5%86%AC/%E7%94%9F%E7%89%A9%E5%8C%BB%E5%AD%A6%E6%88%90%E5%83%8F%E6%8A%80%E6%9C%AF/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E7%A7%8B%E5%86%AC/%E7%94%9F%E7%89%A9%E5%8C%BB%E5%AD%A6%E6%88%90%E5%83%8F%E6%8A%80%E6%9C%AF/</guid>
      <description>
        
        
        &lt;h1&gt;生物医学成像技术&lt;/h1&gt;&lt;p&gt;这节课大家可能一开始上都会一头雾水，因为直到大三的秋冬学期，我们才真正意义上有了自己专业的第一门专业课。同期仪器的嵌入式系统、高级程序设计（Java web开发）、生物医学信号处理（猴版信号与系统）都大大小小能和其他学院有所交叉。没有领略过《上交生存手册》的同学将在这里了解到其描绘的地狱般的本科教学现况。
不过其实说来这门课程的脉络也挺清晰的。作为本科课程，《生物医学成像技术》并不会介绍研究生领域深入的成像技术，而只是泛泛介绍下列四种：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;超声（超声成像）：
&lt;ul&gt;
&lt;li&gt;原理：利用高频声波，声波在遇到不同组织时会反射，形成图像。&lt;/li&gt;
&lt;li&gt;应用：广泛用于腹部、心脏、孕妇产检、血管等的成像，具有无辐射、实时成像的特点。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;CT（计算机断层扫描）：
&lt;ul&gt;
&lt;li&gt;原理：利用X射线从多个角度扫描身体，计算机将这些X射线数据合成为三维图像，提供详细的解剖结构信息。&lt;/li&gt;
&lt;li&gt;应用：广泛用于头部、胸部、腹部和骨骼的成像，适合检测骨折、肿瘤和内部出血等病变。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;PET（正电子发射断层成像）：
&lt;ul&gt;
&lt;li&gt;原理：利用放射性同位素标记的示踪剂，注入人体后会聚集在活跃的组织中。PET 通过探测这些放射性同位素的衰变，生成关于人体功能活动的图像。&lt;/li&gt;
&lt;li&gt;应用：广泛用于肿瘤、心脏病和脑部疾病（如阿尔茨海默病）的诊断，因为它可以显示组织的代谢活动。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;MRI（磁共振成像）：
&lt;ul&gt;
&lt;li&gt;原理：利用强磁场和射频波，使人体内的氢原子核产生共振信号，然后计算机将这些信号转化为图像。&lt;/li&gt;
&lt;li&gt;应用：对软组织有良好的分辨率，常用于脑部、脊柱、关节和肌肉等部位的检查，特别适用于发现软组织病变。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;其中MRI至少在2024年算我们学院的一个研究方向的热门，不过这里主要讨论本课程的备考。接下来的笔记将以物理原理、成像设备、成像过程(信号获取、图像重建)和图像评价(信噪比、对比度、分辨率、伪影等)的结构来组织。&lt;/p&gt;
&lt;h2&gt;复习笔记&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;复习笔记&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%a4%8d%e4%b9%a0%e7%ac%94%e8%ae%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;超声&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;超声&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%b6%85%e5%a3%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e8%b6%85%e5%a3%b0.pdf&#34;&gt;超声&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;CT&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;ct&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#ct&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/X-CT.pdf&#34;&gt;X-CT&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;PET&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;pet&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pet&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/SPECT_PET.pdf&#34;&gt;SPECT_PET&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;MRI&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;mri&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#mri&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/MRI.pdf&#34;&gt;MRI&lt;/a&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E7%A7%8B%E5%86%AC/%E8%AF%AF%E5%B7%AE%E5%A4%84%E7%90%86%E4%B8%8E%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E7%A7%8B%E5%86%AC/%E8%AF%AF%E5%B7%AE%E5%A4%84%E7%90%86%E4%B8%8E%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/</guid>
      <description>
        
        
        &lt;h1&gt;误差处理与数据分析&lt;/h1&gt;&lt;h2&gt;复习笔记&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;复习笔记&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%a4%8d%e4%b9%a0%e7%ac%94%e8%ae%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;来自不知名前辈&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e8%af%af%e5%b7%ae%e7%90%86%e8%ae%ba%e4%b8%8e%e6%95%b0%e6%8d%ae%e5%a4%84%e7%90%86.pdf&#34;&gt;误差理论与数据处理&lt;/a&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E7%A7%8B%E5%86%AC/%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%B8%89%E7%A7%8B%E5%86%AC/%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/</guid>
      <description>
        
        
        &lt;h1&gt;硬件描述语言&lt;/h1&gt;&lt;h2&gt;课程内容- concepts&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;课程内容--concepts&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%af%be%e7%a8%8b%e5%86%85%e5%ae%b9--concepts&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;- event driven / time driven
- time slots
- parallel process
- design verification
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;program module
&lt;ul&gt;
&lt;li&gt;master slave
&lt;ul&gt;
&lt;li&gt;handshake&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;clock domain&lt;/li&gt;
&lt;li&gt;RTL&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Timing
&lt;ul&gt;
&lt;li&gt;Delay(9种)
&lt;ul&gt;
&lt;li&gt;Best/worst/typical 三类
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;t输出 + tsetup &amp;lt;= T&lt;/code&gt; (worst)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;t输出 &amp;gt;= thold&lt;/code&gt; (best)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;采样窗口&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;程序流程图、Datapath、FSM
采样窗口&lt;/p&gt;
&lt;h2&gt;学习建议&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;学习建议&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ad%a6%e4%b9%a0%e5%bb%ba%e8%ae%ae&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;教学太晦涩，实验太简单，是完美符合【上交生存手册】定义的垃圾课。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://hdlbits.01xz.net/wiki/Main_Page&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;HDLbits刷题&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.runoob.com/w3cnote/verilog-tutorial.html&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;菜鸟教程辅助&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;教材方面以1、3、4、5、7、2的顺序进行教学，推荐英文版教材，但更推荐实验课PPT与学海领航PPT。&lt;/p&gt;
&lt;p&gt;强烈推荐&lt;a href=&#34;https://blog.csdn.net/weixin_60094035/article/details/126532981&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;配置VSCODE的iverilog&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://nc-ai.cn/article/cxnqr517/#digital-ide-all-in-one-vscode-plugin-for-verilog-vhdl-development&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Digital-IDE工作流&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;实验室参观&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;实验室参观&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ae%9e%e9%aa%8c%e5%ae%a4%e5%8f%82%e8%a7%82&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e7%a1%ac%e4%bb%b6%e6%8f%8f%e8%bf%b0%e8%af%ad%e8%a8%80%e4%bd%99%e9%94%8b%e5%ae%9e%e9%aa%8c%e5%ae%a4.pdf&#34;&gt;硬件描述语言余锋实验室&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;英文教材&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;英文教材&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%8b%b1%e6%96%87%e6%95%99%e6%9d%90&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e7%a1%ac%e4%bb%b6%e6%8f%8f%e8%bf%b0%e8%af%ad%e8%a8%80%e6%95%99%e6%9d%90.pdf&#34;&gt;数字图像处理教材&lt;/a&gt;
不要看中文教材，那个不是用自然语言写出来的。&lt;/p&gt;
&lt;h2&gt;复习笔记&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;复习笔记&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%a4%8d%e4%b9%a0%e7%ac%94%e8%ae%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e7%a1%ac%e4%bb%b6%e6%8f%8f%e8%bf%b0%e8%af%ad%e8%a8%80%e5%a4%8d%e4%b9%a0%e7%ac%94%e8%ae%b0.pdf&#34;&gt;硬件描述语言复习笔记&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;实验报告&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;实验报告&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ae%9e%e9%aa%8c%e6%8a%a5%e5%91%8a&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/hdl_lab1.pdf&#34;&gt;HDL Lab 1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/hdl_lab2.pdf&#34;&gt;HDL Lab 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/hdl_lab3.pdf&#34;&gt;HDL Lab 3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/hdl_lab4.pdf&#34;&gt;HDL Lab 4&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/hdl_lab5.pdf&#34;&gt;HDL Lab 5&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/hdl_lab6.pdf&#34;&gt;HDL Lab 6&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/hdl_lab7.pdf&#34;&gt;HDL Lab 7&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;回忆卷&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;回忆卷&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%9b%9e%e5%bf%86%e5%8d%b7&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;感谢前辈们一代一代的接力。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/13-14%e5%9b%9e%e5%bf%86%e5%8d%b7.pdf&#34;&gt;13-14 回忆卷&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/15-16%e8%af%95%e9%a2%98%e5%8d%b7.pdf&#34;&gt;15-16 试题卷&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/15-16%e5%9b%9e%e5%bf%86%e5%8d%b7.pdf&#34;&gt;15-16 回忆卷&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/16-17%e5%9b%9e%e5%bf%86%e5%8d%b7.pdf&#34;&gt;16-17 回忆卷&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/21-22%e5%9b%9e%e5%bf%86%e5%8d%b7.pdf&#34;&gt;21-22 回忆卷&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/22-23%e5%9b%9e%e5%bf%86%e5%8d%b7.pdf&#34;&gt;22-23 回忆卷&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://localhost:1313/pdfs/23-24%e5%9b%9e%e5%bf%86%e5%8d%b7.pdf&#34;&gt;23-24 回忆卷&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%BA%8C%E6%98%A5%E5%A4%8F/%E5%BE%AE%E6%9C%BA%E5%8E%9F%E7%90%86%E5%8F%8A%E5%BA%94%E7%94%A8/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%BA%8C%E6%98%A5%E5%A4%8F/%E5%BE%AE%E6%9C%BA%E5%8E%9F%E7%90%86%E5%8F%8A%E5%BA%94%E7%94%A8/</guid>
      <description>
        
        
        &lt;h1&gt;微机原理及应用&lt;/h1&gt;&lt;h2&gt;课程概述&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;课程概述&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%af%be%e7%a8%8b%e6%a6%82%e8%bf%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;微机原理及应用课程主要学习微型计算机的基本原理、体系结构和编程技术，是理解计算机硬件和软件交互的重要课程。主要就是涉及8051微机，我其实挺希望与时俱进。&lt;/p&gt;
&lt;p&gt;&lt;em&gt;本页面内容正在完善中&amp;hellip;&lt;/em&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%BA%8C%E6%98%A5%E5%A4%8F/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%BA%8C%E6%98%A5%E5%A4%8F/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80/</guid>
      <description>
        
        
        &lt;h1&gt;数据结构与算法基础&lt;/h1&gt;&lt;h2&gt;课程概述&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;课程概述&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%af%be%e7%a8%8b%e6%a6%82%e8%bf%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;em&gt;本页面内容正在完善中&amp;hellip;&lt;/em&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%BA%8C%E6%98%A5%E5%A4%8F/%E7%94%B5%E8%B7%AF%E4%B8%8E%E7%94%B5%E5%AD%90%E6%8A%80%E6%9C%AFii/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%BA%8C%E6%98%A5%E5%A4%8F/%E7%94%B5%E8%B7%AF%E4%B8%8E%E7%94%B5%E5%AD%90%E6%8A%80%E6%9C%AFii/</guid>
      <description>
        
        
        &lt;h1&gt;电路与电子技术 II&lt;/h1&gt;&lt;h2&gt;课程概述&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;课程概述&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%af%be%e7%a8%8b%e6%a6%82%e8%bf%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;主要内容为模电。&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%BA%8C%E6%98%A5%E5%A4%8F/%E7%94%B5%E8%B7%AF%E7%BB%BC%E5%90%88%E5%88%9B%E6%96%B0%E5%AE%9E%E8%B7%B5/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%BA%8C%E6%98%A5%E5%A4%8F/%E7%94%B5%E8%B7%AF%E7%BB%BC%E5%90%88%E5%88%9B%E6%96%B0%E5%AE%9E%E8%B7%B5/</guid>
      <description>
        
        
        &lt;h1&gt;电路综合创新实践&lt;/h1&gt;&lt;h2&gt;课程概述&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;课程概述&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%af%be%e7%a8%8b%e6%a6%82%e8%bf%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;电路综合创新实践是一门8051嵌入式开发板综合性的实践课程，旨在通过实际项目培养学生的电路设计能力和创新思维。&lt;/p&gt;
&lt;p&gt;&lt;em&gt;本页面内容正在完善中&amp;hellip;&lt;/em&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%BA%8C%E7%A7%8B%E5%86%AC/%E7%94%B5%E8%B7%AF%E4%B8%8E%E7%94%B5%E5%AD%90%E6%8A%80%E6%9C%AFi/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E5%A4%A7%E4%BA%8C%E7%A7%8B%E5%86%AC/%E7%94%B5%E8%B7%AF%E4%B8%8E%E7%94%B5%E5%AD%90%E6%8A%80%E6%9C%AFi/</guid>
      <description>
        
        
        &lt;h1&gt;电路与电子技术I&lt;/h1&gt;&lt;h2&gt;课程大纲&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;课程大纲&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%af%be%e7%a8%8b%e5%a4%a7%e7%ba%b2&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;电路原理+数电，当然后面生仪跟着信电他们一起是电原+模电一起上了，参考意义没那么大了。&lt;/p&gt;
&lt;h2&gt;复习重点&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;复习重点&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%a4%8d%e4%b9%a0%e9%87%8d%e7%82%b9&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://pan.baidu.com/s/1lIDRGX5h3M7IqZwE55Oikg?pwd=5499&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;电路与电子技术I&lt;/a&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/c/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/c/</guid>
      <description>
        
        
        &lt;h1&gt;C 语言程序设计&lt;/h1&gt;&lt;h2&gt;课程概述&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;课程概述&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%af%be%e7%a8%8b%e6%a6%82%e8%bf%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;em&gt;本页面内容正在完善中&amp;hellip;&lt;/em&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/python/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/python/</guid>
      <description>
        
        
        &lt;h1&gt;Python 编程学习笔记&lt;/h1&gt;&lt;h2&gt;课程概述&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;课程概述&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%af%be%e7%a8%8b%e6%a6%82%e8%bf%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;em&gt;本页面内容正在完善中&amp;hellip;&lt;/em&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E4%B8%AD%E5%9B%BD%E5%85%B1%E4%BA%A7%E5%85%9A%E5%8E%86%E5%8F%B2/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E4%B8%AD%E5%9B%BD%E5%85%B1%E4%BA%A7%E5%85%9A%E5%8E%86%E5%8F%B2/</guid>
      <description>
        
        
        
      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E4%B8%AD%E5%9B%BD%E6%94%B9%E9%9D%A9%E5%BC%80%E6%94%BE%E5%8F%B2/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E4%B8%AD%E5%9B%BD%E6%94%B9%E9%9D%A9%E5%BC%80%E6%94%BE%E5%8F%B2/</guid>
      <description>
        
        
        
      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E5%86%9B%E4%BA%8B%E7%90%86%E8%AE%BA/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E5%86%9B%E4%BA%8B%E7%90%86%E8%AE%BA/</guid>
      <description>
        
        
        
      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5/</guid>
      <description>
        
        
        
      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%89%A9%E5%AD%A6/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%89%A9%E5%AD%A6/</guid>
      <description>
        
        
        &lt;h1&gt;大学生物学&lt;/h1&gt;&lt;p&gt;下面内容非原创。&lt;/p&gt;
&lt;h2&gt;一、期末考试题型和分数组成&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;一期末考试题型和分数组成&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%b8%80%e6%9c%9f%e6%9c%ab%e8%80%83%e8%af%95%e9%a2%98%e5%9e%8b%e5%92%8c%e5%88%86%e6%95%b0%e7%bb%84%e6%88%90&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;1. 考试形式&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;1-考试形式&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#1-%e8%80%83%e8%af%95%e5%bd%a2%e5%bc%8f&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;期末闭卷统考（卷面100分）&lt;/li&gt;
&lt;li&gt;题型构成：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;名词解释&lt;/strong&gt;（40分）
&lt;ul&gt;
&lt;li&gt;题量：8题（从小分享主题词中选取）&lt;/li&gt;
&lt;li&gt;分值：5分/题&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;问答题&lt;/strong&gt;（60分）
&lt;ul&gt;
&lt;li&gt;题量：6选4（多答仅计前4题）&lt;/li&gt;
&lt;li&gt;分值：15分/题&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;二、期末考试时间&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;二期末考试时间&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%ba%8c%e6%9c%9f%e6%9c%ab%e8%80%83%e8%af%95%e6%97%b6%e9%97%b4&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;日期&lt;/strong&gt;：2023年1月11日（周一）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;时段&lt;/strong&gt;：10:30-12:30&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;形式&lt;/strong&gt;：线上考试（具体安排待后续通知）&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;三、课程总成绩构成&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;三课程总成绩构成&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%b8%89%e8%af%be%e7%a8%8b%e6%80%bb%e6%88%90%e7%bb%a9%e6%9e%84%e6%88%90&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;考核项目&lt;/th&gt;
          &lt;th&gt;权重&lt;/th&gt;
          &lt;th&gt;说明&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;线上学习和测试&lt;/td&gt;
          &lt;td&gt;30%&lt;/td&gt;
          &lt;td&gt;MOOC平台完成情况&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;课后作业/小测验&lt;/td&gt;
          &lt;td&gt;10%&lt;/td&gt;
          &lt;td&gt;各章节随堂检测&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;讨论发言（小分享）&lt;/td&gt;
          &lt;td&gt;10%&lt;/td&gt;
          &lt;td&gt;课堂主题讨论参与度&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;主题演讲（大分享）&lt;/td&gt;
          &lt;td&gt;20%&lt;/td&gt;
          &lt;td&gt;小组汇报与材料提交&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;期末考试&lt;/td&gt;
          &lt;td&gt;30%&lt;/td&gt;
          &lt;td&gt;闭卷统考&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2&gt;四、主题演讲材料提交&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;四主题演讲材料提交&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%9b%9b%e4%b8%bb%e9%a2%98%e6%bc%94%e8%ae%b2%e6%9d%90%e6%96%99%e6%8f%90%e4%ba%a4&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;提交要求&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;提交要求&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%8f%90%e4%ba%a4%e8%a6%81%e6%b1%82&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;文件类型&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;演示文稿（PPT格式）&lt;/li&gt;
&lt;li&gt;讲解文稿（Word文档）&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;内容规范&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;PPT需包含完整演讲框架&lt;/li&gt;
&lt;li&gt;Word文档需详细说明各幻灯片讲解要点&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;提交方式&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;通过&amp;quot;学在浙大&amp;quot;平台提交&lt;/li&gt;
&lt;li&gt;截止时间：演讲结束后48小时内&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;五、复习范围&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;五复习范围&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%ba%94%e5%a4%8d%e4%b9%a0%e8%8c%83%e5%9b%b4&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;（一）平时课堂小分享题目&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;一平时课堂小分享题目&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%b8%80%e5%b9%b3%e6%97%b6%e8%af%be%e5%a0%82%e5%b0%8f%e5%88%86%e4%ba%ab%e9%a2%98%e7%9b%ae&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;构件生物、光合作用、双受精、生活史&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;动物的孤雌生殖、动物的再生、黑腹果蝇与模式动物、动物的变态&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;疫苗、人类肠道微生物与健康、酿酒微生物与风味、16S rRNA&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;细胞凋亡与动物发育、干细胞与癌细胞、线粒体疾病、内吞作用与信号传导&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;母源基因、神经胚形成、性别决定基因、全能干细胞和多潜能干细胞&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;内稳态、生物节律、激素、细胞免疫&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;微量元素、饮食模式、蛋白质折叠、酶&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;中心法则、基因敲除、基因沉默、蛋白质组学&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;反向遗传学、核外遗传、遗传标记、转基因生物&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;趋同演化、协同演化、基因水平转移、分子钟理论&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;盖亚假说、生态位与生态幅、营养级、生态足迹&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;（二）名词解释&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;二名词解释&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%ba%8c%e5%90%8d%e8%af%8d%e8%a7%a3%e9%87%8a&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;构件生物&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;构件生物&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%9e%84%e4%bb%b6%e7%94%9f%e7%89%a9&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;由一个合子发育而成的由一套相似的构件组成个体的一类生物。&lt;/p&gt;
&lt;p&gt;在其生长发育的各个阶段，可通过其基本的结构单位的反复形成得到进一步发育，其组织、器官等各个部分是可以改变的。由构件生物组成的种群，受精卵首先发育成一整套构体或构件，然后发育成更多的构件，形成分支结构发育的形式和时间是不可预测的。如大多数高等植物、海绵、水螅和珊瑚是构件生物，构件包括叶子、芽和茎，花也是一种类型的构件。&lt;/p&gt;
&lt;p&gt;构件生物是生物有机体结构对环境的适应，如果说对于单体生物以个体数就能反映种群大小，那么对于构件生物就必须进行多个层次的数量统计，即从合子产生的个体数（它与单体生物的个体数相当）和组成每个个体的构件数。只有同时有这数个层次的数量及其变化，才能掌握构件生物的种群动态。&lt;/p&gt;
&lt;h4&gt;光合作用&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;光合作用&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%85%89%e5%90%88%e4%bd%9c%e7%94%a8&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E6%A4%8D%E7%89%A9&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;植物&lt;/a&gt;、&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E8%97%BB%E9%A1%9E&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;藻类&lt;/a&gt;和&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E8%93%9D%E8%8F%8C&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;蓝菌&lt;/a&gt;等&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E7%94%9F%E7%94%A2%E8%80%85&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;生产者&lt;/a&gt;利用&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E5%85%89%E8%83%BD&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;光能&lt;/a&gt;把&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E4%B8%80%E6%B0%A7%E5%8C%96%E4%BA%8C%E6%B0%AB&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;一氧化二氢&lt;/a&gt;、&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E4%BA%8C%E6%B0%A7%E5%8C%96%E7%A2%B3&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;二氧化碳&lt;/a&gt;或&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E7%A1%AB%E5%8C%96%E6%B0%AB&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;硫化氢&lt;/a&gt;等&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E6%97%A0%E6%9C%BA%E7%89%A9&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;无机物&lt;/a&gt;转变成可以储存&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E5%8C%96%E5%AD%A6%E8%83%BD&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;化学能&lt;/a&gt;的&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E6%9C%89%E6%9C%BA%E7%89%A9&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;有机物&lt;/a&gt;（比如&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E7%A2%B3%E6%B0%B4%E5%8C%96%E5%90%88%E7%89%A9&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;碳水化合物&lt;/a&gt;）的&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E7%94%9F%E7%89%A9%E8%BF%87%E7%A8%8B&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;生物过程&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;植物的光合作用可分为光反应和暗反应。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;光反应&lt;/strong&gt;：2H&lt;sub&gt;2&lt;/sub&gt;O→4[H]+O&lt;sub&gt;2&lt;/sub&gt;↑，发生在叶绿体囊状结构薄膜。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;暗反应&lt;/strong&gt;：利用光反应生成[H]和ATP进行碳的同化作用，使气体二氧化碳还原为糖，发生在叶绿体基质。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;光合作用的意义:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;能量转换&lt;/strong&gt;: 植物在同化无机碳化物的同时，把太阳能转变为化学能，储存在所形成的有机化合物中。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;调节大气&lt;/strong&gt;: 大气之所以能经常保持21%的氧含量，主要依赖于光合作用。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;双受精&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;双受精&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%8f%8c%e5%8f%97%e7%b2%be&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;是被子植物特有的受精现象，指被子植物的雄配子体形成的两个精子，一个与卵融合形成二倍体的合子，另一个与中央细胞的极核（通常两个）融合形成初生胚乳核的现象。双受精后由合子发育成胚，中央细胞发育成胚乳。&lt;/p&gt;
&lt;p&gt;被子植物胚囊中极核同卵一样受精产生了具有父本和母本遗传性的通常是三倍体的胚乳，由这种胚乳&amp;quot;哺育&amp;quot;胚可能使后代更加巩固它双亲的特性并更富有生命力，因此有人认为双受精是被子植物繁盛的一个重要原因。&lt;/p&gt;
&lt;h4&gt;生活史&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;生活史&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%94%9f%e6%b4%bb%e5%8f%b2&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;生活史是在演化生物学以及生态学上是指有关生物体生活史及&lt;strong&gt;生命周期&lt;/strong&gt;的理论。经过长时间的演化，不同的生物体往往会在繁殖期以及繁殖行为、寿命等方面取得一定平衡，拥有从&lt;strong&gt;出生、生长、繁殖，再到死亡的独特生活史&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;根据生活史理论，生物体的生活史有7个最重要的特征（trait）：出生时的大小；生长模式；成熟时的年龄和大小；后代的性别比例、大小，以及数量；繁殖投资（按大小和年龄）；死亡时间分布（按大小和年龄）；寿命。&lt;/p&gt;
&lt;p&gt;为了适应生存的环境，生物体会拥有具独特特征的生活史。这个过程称为&amp;quot;权衡&amp;quot;（trade-off），比如，生物体在进化上会倾向于获得最大的体型或最大的寿命，或倾向于繁殖更多后代或提升后代的生存率。在生活史中的繁殖上，会分为两种模式：r模式和K模式。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;r模式&lt;/strong&gt;：种群密度很不稳定，通常出生率高、寿命短、个体小，缺乏保护后代的机制，子代死亡率高、有较强的扩散能力，适应于多变的栖息生境。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;K模式&lt;/strong&gt;：其种群密度比较稳定，经常处于K值周围。这类动物通常出生率低、寿命长、个体大多具有较完善的保护后代的机制，子代死亡率低多不具较强的扩散能力，它们适应于稳定的栖息生境。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;孤雌生殖&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;孤雌生殖&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%ad%a4%e9%9b%8c%e7%94%9f%e6%ae%96&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;也称单性生殖，即卵不经过受精也能发育成正常的新个体。&lt;/p&gt;
&lt;p&gt;与无性生殖不同，是由生殖细胞而非体细胞完成的繁殖现象。产生的个体多数为单倍体，或者是进行重组之后的2倍体，而非无性生殖产生的和母体遗传物质完全相同的个体，所以通常把孤雌生殖归类于有性生殖，而非无性生殖。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;均等分裂型孤雌生殖&lt;/strong&gt;：即卵原细胞正常进行减数分裂，产生3个极体和1个卵细胞，其中卵细胞独立发育为后代个体的现象。（后代为单倍体）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;卵核与极体融合型孤雌生殖&lt;/strong&gt;：即卵原细胞正常进行减数分裂，产生3个极体和1个卵细胞，其中卵细胞与任意极体随机结合，形成&amp;quot;极体-卵细胞-受精卵&amp;quot;，并由此细胞发育成后代个体的现象（后代为2倍体）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;孤雌生殖可以在环境&lt;strong&gt;适宜的情况下迅速扩大&lt;/strong&gt;种群数量，但不能提高后代的基因多样性。&lt;/p&gt;
&lt;h4&gt;动物的变态&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;动物的变态&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%8a%a8%e7%89%a9%e7%9a%84%e5%8f%98%e6%80%81&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;又称间接发育，指动物&lt;strong&gt;胚后发育过程中所出现形态和习性上一系列显著变化的过程&lt;/strong&gt;。大多数&lt;a href=&#34;https://baike.baidu.com/item/%E6%97%A0%E8%84%8A%E6%A4%8E%E5%8A%A8%E7%89%A9/149803?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;无脊椎动物&lt;/a&gt;门类中都有进行变态的种类，在脊椎动物中变态仅见于鱼类和两栖类。通过变态，不仅动物&lt;strong&gt;成体形态建立&lt;/strong&gt;，同时其&lt;strong&gt;生理特性、行为、活动方式和生态表现&lt;/strong&gt;都与幼虫期有显著差别。&lt;/p&gt;
&lt;p&gt;昆虫类的变态：其多样化在动物界突出，可分为&lt;a href=&#34;https://baike.baidu.com/item/%E4%B8%8D%E5%AE%8C%E5%85%A8%E5%8F%98%E6%80%81/7373906?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;不完全变态&lt;/a&gt;和完全变态。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;完全变态&lt;/strong&gt;的昆虫一生要经历&lt;strong&gt;卵、幼虫、蛹和成虫&lt;/strong&gt;4个阶段。此类昆虫的幼虫与成虫在外观上有较大的差别，比如毛虫和蝴蝶或&lt;a href=&#34;https://baike.baidu.com/item/%E8%9B%B4%E8%9E%AC?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;蛴螬&lt;/a&gt;和甲虫。完全变态昆虫被认为是昆虫纲中进化程度最高的一群，种类也最繁多。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;不完全变态&lt;/strong&gt;的昆虫一生经历卵、&lt;a href=&#34;https://baike.baidu.com/item/%E8%8B%A5%E8%99%AB?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;若虫&lt;/a&gt;和成虫3个阶段。它们的幼虫在外观上与成虫差别一般不大，通常只是体型稍小，没有翅。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;意义&lt;/strong&gt;：&lt;strong&gt;同一个&lt;a href=&#34;https://www.zhihu.com/search?q=%E7%89%A9%E7%A7%8D&amp;amp;search_source=Entity&amp;amp;hybrid_search_source=Entity&amp;amp;hybrid_search_extra=%7b&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;物种&lt;/a&gt;，在生存的不同阶段，形态完全不同，占据不同&lt;a href=&#34;https://www.zhihu.com/search?q=%E7%94%9F%E6%80%81%E4%BD%8D&amp;amp;search_source=Entity&amp;amp;hybrid_search_source=Entity&amp;amp;hybrid_search_extra=%7b&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;生态位&lt;/a&gt;，增加生存概率，有效地降低种内斗争，便于种群的繁衍&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;研究昆虫变态类型有以下生物学意义：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;对于控制昆虫的危害有很大的用处，主要在消灭害虫，控制害虫的数量，在生物防治害虫有很大的作用，减少农药的使用量，和对益虫的毒害和杀害的减少。&lt;/li&gt;
&lt;li&gt;可以知道害虫在什么时候变态，变态的弱点，可以在最佳时期采取有利的措施，使害虫不能变态，也就是生物制剂来控制大面积大范围的虫害，比如蝗虫、斜纹夜蛾，蚜虫、水稻螟虫等等。&lt;/li&gt;
&lt;li&gt;生物制剂的仿制，如保幼素的制剂的人的运用于化妆品，是皮肤娇嫩，皮肤的再生长等。&lt;/li&gt;
&lt;li&gt;生物防治害虫，干扰害虫的发育，减少害虫的危害。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;疫苗&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;疫苗&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%96%ab%e8%8b%97&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;是指由&lt;strong&gt;免疫原性物质制成的用于预防接种的生物制品&lt;/strong&gt;，可以诱导宿主产生特异性、主动性、保护性的宿主免疫。疫苗保留了病原菌刺激动物体免疫系统的特性。当动物体接触到这种不具伤害力的病原菌后，免疫系统便会产生一定的保护物质，如免疫激素、活性生理物质、特殊抗体等；当动物再次接触到这种病原菌时，动物体的免疫系统便会依循其原有的记忆，制造更多的保护物质来阻止病原菌的伤害。疫苗分为&lt;strong&gt;减毒疫苗、灭活疫苗、亚单位疫苗、核酸疫苗、基因工程疫苗&lt;/strong&gt;等。疫苗接种的意义在于接种后机体摆脱相应的传染病或不受感染,人工接种的疫苗和注射的特异性免疫物质,都属于免疫制剂。可以对一些引起传染性疾病的病毒或细菌产生免疫力，提高抗病能力，减少或消灭传染病的传播，为人类创造一个健康的生存环境。&lt;/p&gt;
&lt;h4&gt;人类肠道微生物与健康&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;人类肠道微生物与健康&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%ba%ba%e7%b1%bb%e8%82%a0%e9%81%93%e5%be%ae%e7%94%9f%e7%89%a9%e4%b8%8e%e5%81%a5%e5%ba%b7&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;是指人肠道中数量庞大的微生物，他们依靠肠道生存，同时帮助人类完成一些生理生化功能，从多方面影响人体的健康。肠道不仅是人体消化吸收的重要场所，同时也是&lt;strong&gt;最大的免疫器官&lt;/strong&gt;，在维持正常免疫防御功能中发挥着极其重要的作用。人体肠道为微生物提供了良好的栖息环境，具有人体自身不具备的代谢功能。影响微生物菌群差异的因素包括宿主的地域、年龄、生理状况、饮食习惯等因素。膳食因素也是改变肠道微生物的重要因素之一，更是最容易改变或控制的因素。不同人群由于膳食习惯的不同，对于膳食因子的摄入有很大不同，由此引起的肠道微生物组成、结构与功能也会存在较大差异。肠道微生物是人体代谢的重要参与者，肠道微生物基因组中富含&lt;strong&gt;参与碳水化合物、氨基酸、甲烷、维生素和短链脂肪酸代谢的基因&lt;/strong&gt;，其中很大一部分是人体自身所不具备的。由于肠道是人体内最大的免疫器官，肠道微生物与宿主在肠道黏膜表面的交流&lt;strong&gt;促进了&lt;a href=&#34;https://baike.baidu.com/item/%E5%85%8D%E7%96%AB%E7%B3%BB%E7%BB%9F/668170?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;免疫系统&lt;/a&gt;的建立和发展&lt;/strong&gt;，成为人体重要的免疫屏障。 另外，肠道微生物还通过形成&amp;quot;&lt;strong&gt;菌膜屏障&lt;/strong&gt;&amp;ldquo;而为人体提供保护功能。 滥用抗生素导致的肠道微生物失调会提高肠道疾病发生的几率。同时肠道微生物也与肥胖、糖尿病、渐冻症、心血管疾病有关。&lt;strong&gt;作为人体最庞大、最复杂的&lt;a href=&#34;https://baike.baidu.com/item/%E5%BE%AE%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F/5265687?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;微生态系统&lt;/a&gt;，肠道微生物本身及其代谢产物不仅能调节人体健康，更在膳食和宿主之间起到了重要的桥梁作用。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;
    &lt;img src=&#34;.././media/%e5%a4%a7%e5%ad%a6%e7%94%9f%e7%89%a9%e5%ad%a6/image1.png&#34; alt=&#34;&#34;  loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h4&gt;酿酒微生物与风味&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;酿酒微生物与风味&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e9%85%bf%e9%85%92%e5%be%ae%e7%94%9f%e7%89%a9%e4%b8%8e%e9%a3%8e%e5%91%b3&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;利用微生物发酵生产含一定浓度酒精饮料，其风味随酿酒微生物的不同而各异。酿酒微生物按照其功能,大致可以分为三类：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;糖化菌&lt;/strong&gt;：把淀粉等营养基质分解为&lt;strong&gt;可发酵性糖&lt;/strong&gt;的微生物菌群,主要为&lt;strong&gt;霉菌&lt;/strong&gt;。（霉菌代谢产生的淀粉水解酶在酿酒过程中作为酿酒发酵中的糖化剂，将酿酒原料的主要成分&amp;mdash;&amp;mdash;淀粉,分解为短链糊精和可发酵性糖(葡萄糖、果糖等),提供给发酵过程中不能直接利用淀粉的微生物,作为前驱物质被利用,使整个酿酒发酵过程得以顺利进行。）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;发酵菌&lt;/strong&gt;：利用&lt;strong&gt;葡萄糖等小分子营养物质&lt;/strong&gt;进一步分解代谢,生成以&lt;strong&gt;乙醇&lt;/strong&gt;为主的小分子发酵产物的微生物菌群,主要为酵母菌类。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;生香菌&lt;/strong&gt;：利用各种营养基质,生成&lt;strong&gt;酯、酸、醇、醛&lt;/strong&gt;等丰富复杂的香味成分的微生物菌群,主要是各种来源的细菌。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;研究酿酒微生物群落结构及其生物代谢过程，对于揭示酒的风味形成、品质提升以及工艺优化都具有重要意义。目前，研究人员利用各类微生物分析技术，使其更好地服务于酿酒工业中。&lt;/p&gt;
&lt;h4&gt;16S rRNA&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;16s-rrna&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#16s-rrna&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;是细菌上编码rRNA相对应的DNA序列，存在于所有细菌的基因组中。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;可用于构建细菌系统树。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;是细菌中&lt;strong&gt;特有的核糖体30s亚基的组成部分&lt;/strong&gt;。16S rRNA具有多项功能：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;对于**&lt;a href=&#34;https://baike.baidu.com/item/%E6%A0%B8%E7%B3%96%E4%BD%93%E8%9B%8B%E7%99%BD/7221387?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;核糖体蛋白&lt;/a&gt;的固定起到脚手架的作用**。&lt;/li&gt;
&lt;li&gt;3&amp;rsquo;末端包含反向的&lt;a href=&#34;https://baike.baidu.com/item/SD%E5%BA%8F%E5%88%97?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SD序列&lt;/a&gt;，用来与&lt;a href=&#34;https://baike.baidu.com/item/mRNA?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;mRNA&lt;/a&gt;的AUG&lt;a href=&#34;https://baike.baidu.com/item/%E8%B5%B7%E5%A7%8B%E5%AF%86%E7%A0%81%E5%AD%90?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;起始密码子&lt;/a&gt;结合。&lt;/li&gt;
&lt;li&gt;16S rRNA的3&amp;rsquo;端与S1、S21的结合被发现与&lt;a href=&#34;https://baike.baidu.com/item/%E8%9B%8B%E7%99%BD%E8%B4%A8%E5%90%88%E6%88%90/7043821?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;蛋白质合成&lt;/a&gt;的开始有关系。&lt;/li&gt;
&lt;li&gt;与23S进行交互，帮助两个&lt;a href=&#34;https://baike.baidu.com/item/%E6%A0%B8%E7%B3%96%E4%BD%93?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;核糖体&lt;/a&gt;子单元的结合。（50S+30S）&lt;/li&gt;
&lt;li&gt;在A site 稳定密码子与反密码子的正确配对。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;
    &lt;img src=&#34;.././media/%e5%a4%a7%e5%ad%a6%e7%94%9f%e7%89%a9%e5%ad%a6/image2.png&#34; alt=&#34;&#34;  loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h4&gt;细胞凋亡与动物发育&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;细胞凋亡与动物发育&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%bb%86%e8%83%9e%e5%87%8b%e4%ba%a1%e4%b8%8e%e5%8a%a8%e7%89%a9%e5%8f%91%e8%82%b2&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;细胞凋亡&lt;/strong&gt;（apoptosis）指为维持&lt;a href=&#34;https://baike.baidu.com/item/%E5%86%85%E7%8E%AF%E5%A2%83?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;内环境&lt;/a&gt;稳定，由**&lt;a href=&#34;https://baike.baidu.com/item/%E5%9F%BA%E5%9B%A0/227875?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;基因&lt;/a&gt;控制的细胞自主的有序的死亡**。细胞凋亡与&lt;a href=&#34;https://baike.baidu.com/item/%E7%BB%86%E8%83%9E%E5%9D%8F%E6%AD%BB/9564115?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;细胞坏死&lt;/a&gt;不同，细胞凋亡不是一件被动的过程，而是主动过程，它涉及一系列基因的激活、表达以及调控等的作用，它并不是&lt;a href=&#34;https://baike.baidu.com/item/%E7%97%85%E7%90%86/4266030?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;病理&lt;/a&gt;条件下，自体损伤的一种现象，而是为更好地适应生存环境而主动争取的一种死亡过程。它涉及染色质凝聚和外周化、细胞质减少、核片段化、细胞质致密化、与周围细胞联系中断、内质网与细胞膜融合(最终细胞片段化形成许多细胞凋亡体)被其他细胞吞入。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;细胞凋亡的意义&lt;/strong&gt;：由&lt;strong&gt;基因控制细胞有目的，有选择性的自我消亡过程&lt;/strong&gt;，这种淘汰机制是保证生命进化的基础。生物适应环境的需要，使各种细胞的生存时限达到平衡。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;发育&lt;/strong&gt;：一个细胞 (受精卵 zygote) &lt;strong&gt;不断分裂和分化&lt;/strong&gt;, 即一个有机体&lt;strong&gt;从其生命开始到性成熟的变化过程&lt;/strong&gt;称为发育。它是从&lt;strong&gt;单个细胞演变成复杂的多细胞生物&lt;/strong&gt;的过程, 是生命现象的发展、生物有机体以遗传信息为基础的自我构建和自我组织的过程, 是基因按照特定的时间和空间选择性表达并逐步转化为特征表型的过程。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;动物发育的主要特征&lt;/strong&gt;:
&lt;ol&gt;
&lt;li&gt;具有&lt;strong&gt;严格的时间和空间的次序性&lt;/strong&gt;，这种次序性由发育的遗传程序控制。&lt;/li&gt;
&lt;li&gt;发育是&lt;strong&gt;机体各细胞协同作用的结果&lt;/strong&gt;, 是一系列基因网络性控制的结果。细胞分裂、分化、迁移、凋亡、生长、衰老和死亡等。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;干细胞与癌细胞&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;干细胞与癌细胞&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%b9%b2%e7%bb%86%e8%83%9e%e4%b8%8e%e7%99%8c%e7%bb%86%e8%83%9e&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;干细胞&lt;/strong&gt;是一类具有&lt;strong&gt;无限的或者永生的自我更新能力的细胞&lt;/strong&gt;、&lt;strong&gt;能够产生至少一种类型的、高度分化的子代细胞&lt;/strong&gt;。
&lt;strong&gt;癌细胞&lt;/strong&gt;，是一种变异的细胞，是产生癌症的病源。癌细胞与正常细胞不同，有&lt;strong&gt;无限增殖、可转化和易转移&lt;/strong&gt;三大特点，能够无限增殖并破坏正常的细胞组织。癌细胞除了分裂失控外（能进行无限分裂），还会局部侵入周围正常组织甚至经由体内循环系统或淋巴系统转移到身体其他部分。癌细胞分恶性和良性两种。&lt;/p&gt;
&lt;p&gt;肿瘤干细胞与正常干细胞同属于干细胞范畴，具有许多相同的特点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;均处于未分化状态，具有自我更新和多向分化潜能，增殖的同时可诱导血管形成。&lt;/li&gt;
&lt;li&gt;都具有对称分裂和不对称分裂两种分裂方式。&lt;/li&gt;
&lt;li&gt;具有相似的调节生长的信号通路。&lt;/li&gt;
&lt;li&gt;两者都具有端粒酶活性和扩增端粒酶重复序列，而人类终末分化体细胞不具有端粒酶活性。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;肿瘤干细胞并不等同于正常干细胞、有其自身特性：&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;干细胞自我更新具有&lt;strong&gt;负反馈调节机制&lt;/strong&gt;，其增殖与分化处于平衡状态，是有序的。而肿瘤干细胞的这种负反馈机制已被破坏，其增殖分化是无序和失控的。&lt;/li&gt;
&lt;li&gt;与正常干细胞相比，肿瘤干细胞分化成熟能力缺乏，因此肿瘤细胞往往是&lt;strong&gt;低分化&lt;/strong&gt;的。&lt;/li&gt;
&lt;li&gt;肿瘤干细胞具有&lt;strong&gt;积累复制错误&lt;/strong&gt;的倾向，而正常干细胞可通过多种途径防止这种情况发生。&lt;/li&gt;
&lt;li&gt;两者某些&lt;strong&gt;信号传导通路&lt;/strong&gt;不同，可作为治疗的靶点，如肿瘤抑制蛋白通路在正常造血干细胞的自我更新和白血病的形成中具有不同的作用途径。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;线粒体疾病&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;线粒体疾病&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ba%bf%e7%b2%92%e4%bd%93%e7%96%be%e7%97%85&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;线粒体病是遗传缺损引起&lt;strong&gt;线粒体代谢酶缺陷&lt;/strong&gt;，致使&lt;strong&gt;ATP合成障碍、能量来源不足&lt;/strong&gt;导致的一组异质&lt;a href=&#34;https://baike.baidu.com/item/%E6%80%A7%E7%97%85/292397?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;性病&lt;/a&gt;变。&lt;a href=&#34;https://baike.baidu.com/item/%E7%BA%BF%E7%B2%92%E4%BD%93%E8%84%91%E8%82%8C%E7%97%85/7043851?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;线粒体脑肌病&lt;/a&gt;的不同类型发病年龄不同。&lt;/p&gt;
&lt;p&gt;线粒体是密切与能量代谢相关的细胞器，无论是&lt;strong&gt;细胞的成活（氧化磷酸化）和细胞死亡（凋亡）均与线粒体功能有关&lt;/strong&gt;，特别是呼吸链的氧化磷酸化异常与许多人类疾病有关。根据线粒体病变部位不同可分为：线粒体&lt;a href=&#34;https://baike.baidu.com/item/%E8%82%8C%E7%97%85/9964527?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;肌病&lt;/a&gt;，线粒体病变侵犯骨骼肌为主；线粒体脑肌病，病变同时侵犯骨骼肌和中枢神经系统。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;病因&lt;/strong&gt;：线粒体是细胞内提供能量的细胞器，人类mtDNA是长16569bp的环状双链分子，分轻链和重链，含37个基因，主要编码呼吸链及与能量代谢有关的蛋白。mtDNA缺失或点突变使编码线粒体氧化代谢过程必需的酶或载体发生障碍，糖原和脂肪酸等不能进入线粒体充分利用和产生足够的ATP，导致能量代谢障碍和产生复杂的临床症状。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;内吞作用与信号传导&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;内吞作用与信号传导&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%86%85%e5%90%9e%e4%bd%9c%e7%94%a8%e4%b8%8e%e4%bf%a1%e5%8f%b7%e4%bc%a0%e5%af%bc&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;内吞作用&lt;/strong&gt;又称&lt;a href=&#34;https://baike.baidu.com/item/%E5%85%A5%E8%83%9E%E4%BD%9C%E7%94%A8/4899457?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;入胞作用&lt;/a&gt;或&lt;a href=&#34;https://baike.baidu.com/item/%E8%83%9E%E5%90%9E%E4%BD%9C%E7%94%A8/6814282?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;胞吞作用&lt;/a&gt;，是通过**&lt;a href=&#34;https://baike.baidu.com/item/%E8%B4%A8%E8%86%9C/7939156?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;质膜&lt;/a&gt;的&lt;a href=&#34;https://baike.baidu.com/item/%E5%8F%98%E5%BD%A2%E8%BF%90%E5%8A%A8/320612?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;变形运动&lt;/a&gt;将细胞外&lt;a href=&#34;https://baike.baidu.com/item/%E7%89%A9%E8%B4%A8%E8%BD%AC%E8%BF%90/6800271?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;物质转运&lt;/a&gt;入细胞内的过程**。根据入胞物质的不同大小，以及入胞机制的不同可将内吞作用分为三种类型：&lt;a href=&#34;https://baike.baidu.com/item/%E5%90%9E%E5%99%AC%E4%BD%9C%E7%94%A8/5331409?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;吞噬作用&lt;/a&gt;、&lt;a href=&#34;https://baike.baidu.com/item/%E5%90%9E%E9%A5%AE%E4%BD%9C%E7%94%A8?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;吞饮作用&lt;/a&gt;、&lt;a href=&#34;https://baike.baidu.com/item/%E5%8F%97%E4%BD%93%E4%BB%8B%E5%AF%BC%E7%9A%84%E5%86%85%E5%90%9E%E4%BD%9C%E7%94%A8/7911155?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;受体介导的内吞作用&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;信号传导&lt;/strong&gt;：可以&lt;strong&gt;把各种信号通过细胞膜进入细胞, 逐步引起细胞物质主要是蛋白质变化的过程&lt;/strong&gt;，称为信号传导。它是一个多酶级联反应过程, 各条信号通路之间通过细胞间&lt;a href=&#34;https://baike.baidu.com/item/%E4%BF%A1%E5%8F%B7%E8%9B%8B%E7%99%BD/7991457?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;信号蛋白&lt;/a&gt;的相互作用在体内组成一高度有序的&lt;a href=&#34;https://baike.baidu.com/item/%E8%B0%83%E6%8E%A7%E7%BD%91%E7%BB%9C/5844691?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;调控网络&lt;/a&gt;。哺乳动物维持正常的活动需要多种信号转导通路以&lt;strong&gt;维持机体细胞对信号刺激反应的完整性和协调性&lt;/strong&gt;。有许多内吞作用与信号转导有关。&lt;/p&gt;
&lt;h4&gt;母源基因&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;母源基因&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%af%8d%e6%ba%90%e5%9f%ba%e5%9b%a0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;受精前即卵子发育时&lt;strong&gt;母体细胞转录的RNA甚至翻译的蛋白质&lt;/strong&gt;，产物定位在&lt;strong&gt;成熟的卵的细胞质&lt;/strong&gt;中。母体基因产物量和活性形成空间差异并激活不同的合子基因，使躯体轴线不同区域里呈现一定的活性谱。&lt;/p&gt;
&lt;p&gt;在&lt;a href=&#34;https://baike.baidu.com/item/%E5%8D%B5%E5%AD%90%E5%8F%91%E7%94%9F?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;卵子发生&lt;/a&gt;（oogenesis）过程中表达，并将其产物（mRNA或蛋白质）储存在卵母细胞中的基因称为&lt;a href=&#34;https://baike.baidu.com/item/%E6%AF%8D%E6%BA%90%E5%9F%BA%E5%9B%A0?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;母源基因&lt;/a&gt;。在&lt;strong&gt;胚胎发育的决定中起重要作用&lt;/strong&gt;。&lt;/p&gt;
&lt;h4&gt;神经胚形成&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;神经胚形成&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%a5%9e%e7%bb%8f%e8%83%9a%e5%bd%a2%e6%88%90&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;神经胚形成：胚胎在3个胚层建立之后进入神经胚形成阶段，形成[脑和脊髓的原基-神经管](neural tube)，是脊椎动物器官形成的前奏。随后各种器官原基相继形成。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;神经胚（neurula）亦称髓胚。主要是指&lt;a href=&#34;https://baike.baidu.com/item/%E8%84%8A%E6%A4%8E%E5%8A%A8%E7%89%A9?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;脊椎动物&lt;/a&gt; 的发生中在&lt;strong&gt;原肠形成&lt;/strong&gt;（或者原条期）&lt;strong&gt;之后&lt;/strong&gt;，从出现&lt;strong&gt;中枢神经系统&lt;/strong&gt;原基的&lt;strong&gt;神经板&lt;/strong&gt;时期开始，到&lt;strong&gt;神经板闭合变成&lt;a href=&#34;https://baike.baidu.com/item/%E7%A5%9E%E7%BB%8F%E7%AE%A1?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;神经管&lt;/a&gt;期间&lt;/strong&gt;的胚胎。在这一时期&lt;strong&gt;外胚层分化出神经板及表皮区&lt;/strong&gt;，在神经板之下的为头肠、前索板、脊索原基、预定体节的位置，在多数情况下，表皮区的外胚层被侧板的&lt;a href=&#34;https://baike.baidu.com/item/%E4%BD%93%E5%A3%81%E4%B8%AD%E8%83%9A%E5%B1%82/5956452?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;体壁中胚层&lt;/a&gt;反包着。主要器官原基在各胚层已开始出现，但组织分化尚未开始。&lt;/p&gt;
&lt;h4&gt;性别决定基因&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;性别决定基因&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%80%a7%e5%88%ab%e5%86%b3%e5%ae%9a%e5%9f%ba%e5%9b%a0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;决定个体性别发育的基因&lt;/strong&gt;被称为性别决定基因。最主要的是&lt;strong&gt;Y染色体短臂末端的SRY基因&lt;/strong&gt;，这个基因决定了男性的性发育，如果由于染色体易位等原因如果女性核型的人（女性核型为46,XX，男性核型为46,XY）携带了SRY基因，就会表现出男性的性特征，如果男性的SRY基因出了问题，就会表现出女性的性特征，也就是所谓的假两性畸形。&lt;/p&gt;
&lt;h4&gt;全能干细胞&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;全能干细胞&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%85%a8%e8%83%bd%e5%b9%b2%e7%bb%86%e8%83%9e&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;全能干细胞是能够分化发育成为各种&lt;a href=&#34;https://baike.baidu.com/item/%E7%BB%84%E7%BB%87%E5%99%A8%E5%AE%98/4536359?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;组织器官&lt;/a&gt;的细胞&lt;/strong&gt;，其全能性很强。全能干细胞是指&lt;strong&gt;受精卵到&lt;a href=&#34;https://baike.baidu.com/item/%E5%8D%B5%E8%A3%82/2938533?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;卵裂&lt;/a&gt;期32细胞前&lt;/strong&gt;的所有细胞。全能干细胞是指&lt;strong&gt;具有无限分化潜能，能分化成所有组织和器官的&lt;a href=&#34;https://baike.baidu.com/item/%E5%B9%B2%E7%BB%86%E8%83%9E/301672?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;干细胞&lt;/a&gt;&lt;/strong&gt;。具有形成完整个体分化潜能。但由于伦理与免疫排斥的原因，目前仅做科学研究，在临床医学上并没有被广泛应用。&lt;/p&gt;
&lt;h4&gt;多潜能干细胞&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;多潜能干细胞&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%a4%9a%e6%bd%9c%e8%83%bd%e5%b9%b2%e7%bb%86%e8%83%9e&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;多能干细胞种类繁多，其中间充质干细胞是目前应用最广泛的干细胞类型，临床上主要应用于解决多种血液系统疾病、心血管疾病、神经系统疾病、自身免疫性疾病以及关节修复等。&lt;strong&gt;多能干细胞分为两类，一类称为多潜能干细胞&lt;/strong&gt;，与全能干细胞相比，多潜能干细胞已经&lt;strong&gt;失去了发育成完整个体的能力，但仍具有分化为体内全部200多种类型细胞的潜能&lt;/strong&gt;。如囊胚内细胞团细胞和原始生殖细胞。又如存在于人体骨髓中的造血干细胞，可以分化成红细胞、血小板、粒细胞和淋巴细胞等十种以上的血细胞，但它们都不能分化出体内全部类型的细胞。&lt;/p&gt;
&lt;h4&gt;内稳态&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;内稳态&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%86%85%e7%a8%b3%e6%80%81&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;是指身体内部所保持的理化状态及化学成分、其他一些生命活动存在一定的&lt;strong&gt;动态平衡&lt;/strong&gt;。细胞由细胞膜与其周围环境隔开，细胞内部情况与细胞周围液体有很大差别，细胞与周围液体不断进行物质交换并保持其内部的恒定性，这就是&lt;strong&gt;细胞稳态&lt;/strong&gt;。保持整个身体的稳态，在高等动物要靠激素和神经系统的整合作用。激素保持身体的稳态，它可有及时使激素释放和停止分泌的能力，这就是&lt;strong&gt;激素分泌的稳态&lt;/strong&gt;的保持。**&lt;a href=&#34;https://baike.baidu.com/item/%E4%B8%AD%E6%9E%A2%E7%A5%9E%E7%BB%8F%E7%B3%BB%E7%BB%9F/2217606?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;中枢神经系统&lt;/a&gt;**在保持身体稳态中起重要作用，而其本身也要保持稳态。中枢神经系统的稳态依赖于其所接触的内环境的恒定性。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;意义&lt;/strong&gt;：具有内稳态机制的生物借助于内环境的稳定而相对独立于外界条件，大大提高了生物对&lt;a href=&#34;https://baike.baidu.com/item/%E7%94%9F%E6%80%81%E5%9B%A0%E5%AD%90/1286472?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;生态因子&lt;/a&gt;的耐受范围。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;生物节律&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;生物节律&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%94%9f%e7%89%a9%e8%8a%82%e5%be%8b&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;生物周期现象又叫生物节律（biological clock），亦称&amp;quot;生物钟&amp;rdquo;。有机体内部发生的周期性变化过程。最典型的例子是睡眠与觉醒的周期性交替。交替之所以表现出准确的周期性，一方面决定于&lt;strong&gt;身体器官和细胞机能状态的周期性变化&lt;/strong&gt;，另一方面是&lt;strong&gt;环境的影响&lt;/strong&gt;，如太阳和月亮升起、下落的周期变化。太阳、月亮的运动规律直接影响地球上生物的周期性变化，如谷物随季节生长；候鸟随潮汛变化而迁栖（潮汛是月亮对海洋的引力引起的）；人的体温在一昼夜内出现周期性升降等。生物钟现象使人在一天的不同时刻工作效率不一。&lt;strong&gt;骤然改变正常的昼夜周期（如从地球的东部迁到西部居住）会使人的机体功能混乱，情绪烦躁，工作效率降低&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;即生物钟，是由生物体生命活动所产生的一种内在节律。人体生物节律是指体力节律、情绪节律和智力节律。 每个人从他出生那天起一直到生命终结,都存在着体力23天、情绪28天、智力33天的**&lt;a href=&#34;https://baike.baidu.com/item/%E5%91%A8%E6%9C%9F%E6%80%A7/6458545?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;周期性&lt;/a&gt;波动规律**,称为人体生物节律。每一个周期中又存在着高潮期、低潮期和临界期。 由于它具有准确的时间性，因此，也称之为人体生物钟。在我们日常生活中，有人会觉得自己的&lt;a href=&#34;https://baike.baidu.com/item/%E4%BD%93%E5%8A%9B/9480397?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;体力&lt;/a&gt;、情绪或&lt;a href=&#34;https://baike.baidu.com/item/%E6%99%BA%E5%8A%9B/129379?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;智力&lt;/a&gt;有时很好，有时很坏，人从他诞生之日起，直至生命终结，其自身的体力、情绪和智力都存在着由强至弱、由弱至强的周期性起伏变化。人们把这种现象称作生物节律，或&lt;a href=&#34;https://baike.baidu.com/item/%E7%94%9F%E7%89%A9%E8%8A%82%E5%A5%8F/3839629?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;生物节奏&lt;/a&gt;、&lt;a href=&#34;https://baike.baidu.com/item/%E7%94%9F%E5%91%BD%E8%8A%82%E5%BE%8B/8264565?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;生命节律&lt;/a&gt;等。产生这种现象的原因是生物体内存在着&lt;a href=&#34;https://baike.baidu.com/item/%E7%94%9F%E7%89%A9%E9%92%9F/439601?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;生物钟&lt;/a&gt;，它自动地调节和控制着人体的行为和活动。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;意义&lt;/strong&gt;：是分析事故原因、预防事故发生的有力措施；利用生物节律规律来指导运动训练是十分重要的；同时也可以根据节律研发药物治疗疾病。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;激素&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;激素&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%bf%80%e7%b4%a0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;激素是高度分化的内分泌细胞合成并直接分泌入血的&lt;strong&gt;化学信息物质&lt;/strong&gt;，它通过调节各种组织细胞的代谢活动来影响人体的生理活动。&lt;/p&gt;
&lt;p&gt;内分泌细胞产生的可以&lt;strong&gt;影响机体内其他细胞活动的化学物质&lt;/strong&gt;。仅需很小剂量的激素便可以改变细胞的新陈代谢。&lt;/p&gt;
&lt;p&gt;激素的种类较多而数量极微(多数为毫微克甚至微微克水平)，它&lt;strong&gt;既非机体的能量来源又非组成机体的结构物质&lt;/strong&gt;，但通过传递信息，在协调新陈代谢、生长发育等生理过程方面充当了重要的角色。激素的传递方式主要有三种：大多数激素分泌后直接进入血液，随血液循环到达一定的组织细胞才发挥作用，这种细胞叫&lt;strong&gt;靶细胞&lt;/strong&gt;，靶细胞上有具特殊立体构型的物质(激素受体)与相应的激素结合，并识别激素所携带的信息，把它转化为细胞内一系列复杂的化学反应，从而产生特定的生理效应。这种方式的激素要随血流到达靶细胞，所以叫&amp;quot;远距分泌&amp;quot;。有些激素分泌出来以后通过细胞间隙液就近扩散，作用于邻近细胞(如某些消化道激素)，这种方式叫&amp;quot;旁分泌&amp;quot;。还有一些激素是由神经细胞(如下丘脑)分泌的，叫&amp;quot;神经激素&amp;quot;，沿轴突借轴浆流动而到达靶细胞，这种方式叫&amp;quot;神经分泌&amp;quot;。激素按其化学本质可分为&lt;strong&gt;含氮的蛋白类激素&lt;/strong&gt;(由氨基酸、肽、蛋白衍生而成)和**&lt;a href=&#34;https://baike.baidu.com/item/%E7%B1%BB%E5%9B%BA%E9%86%87/2692781?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;类固醇&lt;/a&gt;类激素&lt;strong&gt;两大类；而就其生理功能来说可分为三大类：一类是调控机体新陈代谢和维持内环境相对稳定的，如胰岛素、胃肠激素、甲状旁腺激素等；一类是促进细胞增殖分化，控制机体生长发育和生殖机能，并影响其衰老过程的，如生长激素、性激素等；还有一类与神经系统密切配合，增强机体对环境的适应，如肾上腺皮质激素和垂体激素等。激素分泌量&lt;/strong&gt;过多或过少都会引起机体功能的紊乱**，所以临床上常以激素水平的测定做为诊断某些疾病的依据，并将许多激素做为治疗药物应用于临床。&lt;/p&gt;
&lt;h4&gt;细胞免疫&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;细胞免疫&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%bb%86%e8%83%9e%e5%85%8d%e7%96%ab&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;细胞免疫又称&lt;a href=&#34;https://baike.baidu.com/item/%E7%BB%86%E8%83%9E%E4%BB%8B%E5%AF%BC%E5%85%8D%E7%96%AB/5547249?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;细胞介导免疫&lt;/a&gt;。狭义的细胞免疫仅指**&lt;a href=&#34;https://baike.baidu.com/item/T%E7%BB%86%E8%83%9E/111834?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;T细胞&lt;/a&gt;介导的免疫应答**，即T细胞&lt;strong&gt;受到抗原刺激后，分化、&lt;a href=&#34;https://baike.baidu.com/item/%E5%A2%9E%E6%AE%96/9171601?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;增殖&lt;/a&gt;、转化为&lt;a href=&#34;https://baike.baidu.com/item/%E8%87%B4%E6%95%8FT%E7%BB%86%E8%83%9E/6200244?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;致敏T细胞&lt;/a&gt;&lt;/strong&gt;，对抗原的直接杀伤作用及致敏T细胞所释放的**&lt;a href=&#34;https://baike.baidu.com/item/%E7%BB%86%E8%83%9E%E5%9B%A0%E5%AD%90/658581?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;细胞因子&lt;/a&gt;&lt;strong&gt;的协同杀伤作用。T细胞介导的免疫应答的特征是出现以&lt;a href=&#34;https://baike.baidu.com/item/%E5%8D%95%E6%A0%B8%E7%BB%86%E8%83%9E/10319973?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;单核细胞&lt;/a&gt;浸润为主的炎症反应和/或特异性的细胞毒性。广义的细胞免疫还应该包括原始的吞噬作用以及NK细胞介导的细胞毒作用。细胞免疫是&lt;/strong&gt;清除细胞内寄生微生物的最为有效的防御反应**，也是排斥同种移植物或肿瘤抗原的有效手段。&lt;/p&gt;
&lt;p&gt;细胞免疫的产生也分为&lt;strong&gt;感应、反应和效应&lt;/strong&gt;三个阶段。其作用机制包括两个方面：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;致敏T细胞的&lt;strong&gt;直接杀伤&lt;/strong&gt;作用。当&lt;a href=&#34;https://baike.baidu.com/item/%E8%87%B4%E6%95%8FT%E7%BB%86%E8%83%9E/6200244?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;致敏T细胞&lt;/a&gt;与带有相应抗原的&lt;a href=&#34;https://baike.baidu.com/item/%E9%9D%B6%E7%BB%86%E8%83%9E?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;靶细胞&lt;/a&gt;再次接触时，两者发生&lt;a href=&#34;https://baike.baidu.com/item/%E7%89%B9%E5%BC%82%E6%80%A7?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;特异性&lt;/a&gt;结合，产生刺激作用，使靶细胞膜通透性发生改变，引起靶细胞内渗透压改变，靶细胞肿胀、溶解以致死亡。致敏T细胞在杀伤靶细胞过程中，本身未受伤害，可重新攻击其他靶细胞。参与这种作用的致敏T细胞，称为杀伤&lt;a href=&#34;https://baike.baidu.com/item/T%E7%BB%86%E8%83%9E?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;T细胞&lt;/a&gt;。&lt;/li&gt;
&lt;li&gt;通过**&lt;a href=&#34;https://baike.baidu.com/item/%E6%B7%8B%E5%B7%B4%E5%9B%A0%E5%AD%90?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;淋巴因子&lt;/a&gt;相互配合**、协同杀伤靶细胞。如&lt;a href=&#34;https://baike.baidu.com/item/%E7%9A%AE%E8%82%A4%E5%8F%8D%E5%BA%94/12729872?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;皮肤反应&lt;/a&gt;因子可使血管通透性增高，使吞噬细胞易于从血管内游出；&lt;a href=&#34;https://baike.baidu.com/item/%E5%B7%A8%E5%99%AC%E7%BB%86%E8%83%9E?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;巨噬细胞&lt;/a&gt;趋化因子可招引相应的&lt;a href=&#34;https://baike.baidu.com/item/%E5%85%8D%E7%96%AB%E7%BB%86%E8%83%9E?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;免疫细胞&lt;/a&gt;向抗原所在部位集中，以利于对抗原进行吞噬、杀伤、清除等。由于各种淋巴因子的协同作用，扩大了&lt;a href=&#34;https://baike.baidu.com/item/%E5%85%8D%E7%96%AB%E6%95%88%E6%9E%9C?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;免疫效果&lt;/a&gt;，达到清除抗原异物的目的。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;
    &lt;img src=&#34;.././media/%e5%a4%a7%e5%ad%a6%e7%94%9f%e7%89%a9%e5%ad%a6/image3.png&#34; alt=&#34;&#34;  loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h4&gt;微量元素&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;微量元素&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%be%ae%e9%87%8f%e5%85%83%e7%b4%a0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;约有70种，指的是在人体中含量低于人体质量0.005%~0.01%的元素。包括铁、铜、锰、锌、钴、钼、铬、镍、钒、氟、硒、碘、硅、锡。微量元素在人体内含量虽然极微小，但具有强大的生物学作用，它们参与酶、激素维生素和核酸的代谢过程，其生理功能主要表现为协助输送宏量元素；作为酶的组成成分或激活剂；在激素和维生素中起独特作用;影响核酸代谢等。&lt;/p&gt;
&lt;h4&gt;饮食模式&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;饮食模式&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e9%a5%ae%e9%a3%9f%e6%a8%a1%e5%bc%8f&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;指饮食中不同食物的数量、比例、种类或者组合，以及习惯性消费的频率。膳食模式不仅反映人们的饮食习惯和生活水平的高低，同时也反映一个民族的传统文化，一个国家的经济发展和一个地区的环境和资源等多方面的情况。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;DASH饮食&lt;/strong&gt;是由1997年美国的一项大型高血压防治计划发展出来的饮食，在这项计划中发现，饮食中如果能摄食足够的蔬菜、水果、低脂(或脱脂)奶，以维持足够的钾、镁、钙等离子的摄取，并尽量减少饮食中油脂量(特别是富含饱和脂肪酸的动物性油脂)，可以有效地降低血压。因此，常以DASH 饮食来作为预防及控制高血压的饮食模式。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;地中海饮食&lt;/strong&gt;泛指希腊、西班牙、法国和意大利南部等处于地中海沿岸的南欧各国以蔬菜水果、鱼类、五谷杂粮、豆类和橄榄油为主的饮食风格。研究发现地中海饮食可以减少患心脏病的风险，还可以保护大脑免受血管损伤，降低发生中风和记忆力减退的风险。有数据统计，地中海地区居民平均寿命高居于全球之冠，且生活质量较高。现在也用&amp;quot;地中海式饮食&amp;quot;代指有利于健康的，简单、清淡以及富含营养的饮食。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;
    &lt;img src=&#34;.././media/%e5%a4%a7%e5%ad%a6%e7%94%9f%e7%89%a9%e5%ad%a6/image4.png&#34; alt=&#34;&#34;  loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h4&gt;蛋白质折叠&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;蛋白质折叠&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%9b%8b%e7%99%bd%e8%b4%a8%e6%8a%98%e5%8f%a0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;蛋白质获得其功能性结构和构象的过程&lt;/strong&gt;。通过这一物理过程，蛋白质&lt;strong&gt;从无规则卷曲折叠成特定的功能性三维结构&lt;/strong&gt;。在从mRNA序列翻译成线性的肽链时，蛋白质都是以去折叠多肽或无规则卷曲的形式存在。&lt;/p&gt;
&lt;p&gt;蛋白质的基本单位为氨基酸，而蛋白质的一级结构指的就是其氨基酸序列。蛋白质会由所含氨基酸残基的亲水性、疏水性、带正电、带负电等特性通过残基间的相互作用而折叠成一立体的三级结构。一般三级才有生物活性。&lt;/p&gt;
&lt;p&gt;
    &lt;img src=&#34;.././media/%e5%a4%a7%e5%ad%a6%e7%94%9f%e7%89%a9%e5%ad%a6/image5.png&#34; alt=&#34;&#34;  loading=&#34;lazy&#34; /&gt;

    &lt;img src=&#34;.././media/%e5%a4%a7%e5%ad%a6%e7%94%9f%e7%89%a9%e5%ad%a6/image6.png&#34; alt=&#34;&#34;  loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h4&gt;中心法则&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;中心法则&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%b8%ad%e5%bf%83%e6%b3%95%e5%88%99&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;是指遗传信息从DNA传递给RNA，再从RNA传递给蛋白质，即完成遗传信息的转录和翻译的过程。也可以从DNA传递给DNA，即完成DNA的复制过程。这是&lt;strong&gt;所有有细胞结构&lt;/strong&gt;的生物所遵循的法则。在某些病毒中的RNA自我复制（如烟草花叶病毒等）和在某些病毒中能以RNA为模板逆转录成DNA的过程（某些致癌病毒）是对中心法则的补充。&lt;/p&gt;
&lt;p&gt;
    &lt;img src=&#34;.././media/%e5%a4%a7%e5%ad%a6%e7%94%9f%e7%89%a9%e5%ad%a6/image7.png&#34; alt=&#34;&#34;  loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;意义：&lt;/strong&gt;
中心法则是&lt;strong&gt;现代生物学中最重要最基本的规律&lt;/strong&gt;之一， 其在探索生命现象的本质及普遍规律方面起了巨大的作用，极大地推动了现代生物学的发展，是现代生物学的理论基石，并为生物学基础理论的统一指明了方向，在生物科学发展过程中占有重要地位。 &lt;a href=&#34;https://baike.baidu.com/item/%E9%81%97%E4%BC%A0%E7%89%A9%E8%B4%A8?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;遗传物质&lt;/a&gt;可以是DNA，也可以是RNA。细胞的遗传物质都是DNA，只有一些病毒的遗传物质是RNA。这种以RNA为遗传物质的病毒称为反转录病毒（retrovirus），在这种病毒的感染周期中，单链的RNA分子在反转录酶（reverse transcriptase）的作用下，可以反转录成单链的DNA，然后再以单链的DNA为模板生成双链DNA。双链DNA可以成为&lt;a href=&#34;https://baike.baidu.com/item/%E5%AE%BF%E4%B8%BB%E7%BB%86%E8%83%9E?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;宿主细胞&lt;/a&gt;基因组的一部分，并同宿主细胞的基因组一起传递给&lt;a href=&#34;https://baike.baidu.com/item/%E5%AD%90%E7%BB%86%E8%83%9E?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;子细胞&lt;/a&gt;。在反转录酶催化下，RNA分子产生与其序列互补的DNA分子，这种DNA分子称为互补DNA（complementary DNA），简写为cDNA，这个过程即为逆转录（reverse transcription）。&lt;/p&gt;
&lt;p&gt;由此可见，&lt;a href=&#34;https://baike.baidu.com/item/%E9%81%97%E4%BC%A0%E4%BF%A1%E6%81%AF?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;遗传信息&lt;/a&gt;并不一定是从DNA单向地流向RNA，RNA携带的遗传信息同样也可以流向DNA。但是DNA和RNA中包含的遗传信息只是单向地流向蛋白质，迄今为止还没有发现蛋白质的信息逆向地流向核酸。这种遗传信息的流向，就是&lt;a href=&#34;https://baike.baidu.com/item/%E5%85%8B%E9%87%8C%E5%85%8B?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;克里克&lt;/a&gt;概括的中心法则(central dogma)的遗传学意义。&lt;/p&gt;
&lt;p&gt;任何一种假设都要经受科学事实的检验。&lt;a href=&#34;https://baike.baidu.com/item/%E5%8F%8D%E8%BD%AC%E5%BD%95%E9%85%B6?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;反转录酶&lt;/a&gt;的发现，使中心法则对关于遗传信息从DNA单向流入RNA做了修改，遗传信息是可以在DNA与RNA之间相互流动的。那么，对于DNA和RNA与蛋白质分子之间的信息流向是否只有核酸向蛋白质分子的单向流动，还是蛋白质分子的信息也可以流向核酸，中心法则仍然肯定前者。可是，病原体&lt;a href=&#34;https://baike.baidu.com/item/%E6%9C%8A%E7%B2%92?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;朊粒&lt;/a&gt;(Prion)的行为曾对中心法则提出了严重的挑战。&lt;/p&gt;
&lt;p&gt;实验证明，朊粒确实是不含DNA和RNA的蛋白质颗粒，但它不是传递遗传信息的载体，也不能&lt;a href=&#34;https://baike.baidu.com/item/%E8%87%AA%E6%88%91%E5%A4%8D%E5%88%B6?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;自我复制&lt;/a&gt;，而仍是由&lt;a href=&#34;https://baike.baidu.com/item/%E5%9F%BA%E5%9B%A0?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;基因&lt;/a&gt;编码产生的一种正常蛋白质的异构体。&lt;/p&gt;
&lt;h4&gt;基因敲除&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;基因敲除&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%9f%ba%e5%9b%a0%e6%95%b2%e9%99%a4&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;指利用外源的已突变的基因通过&lt;strong&gt;同源重组&lt;/strong&gt;的方法替换掉内源的正常同源基因，从而使&lt;strong&gt;内源基因失活而表现突变体&lt;/strong&gt;的性状的技术或方法。它是针对某个序列已知但功能未知的序列，改变生物的遗传基因，令&lt;strong&gt;特定的基因功能丧失作用，从而使部分功能被屏蔽&lt;/strong&gt;，并可进一步对生物体造成影响，进而推测出该基因的生物学功能。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;步骤：&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;获得干细胞&lt;/strong&gt;：用于打靶。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;载体构建&lt;/strong&gt;：把目的基因和与细胞内靶基因特异片段同源的DNA分子都重组到带有标记基因（如neo基因，TK基因等）的载体上，此重组载体即为打靶载体。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;导入基因&lt;/strong&gt;：将基因打靶载体通过一定的方式（常用电穿孔法）导入同源的胚胎干细胞（EScell）中，使外源DNA与胚胎干细胞基因组中相应部分发生同源重组，将打靶载体中的DNA序列整合到内源基因组中从而得以表达。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;性状改变&lt;/strong&gt;。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;基因敲除就是通过同源重组将外源基因定点整合入靶细胞基因组上某一确定的位点，以达到定点修饰改造染色体上某一基因的目的的一种技术。它&lt;strong&gt;克服了随机整合的盲目性和偶然性&lt;/strong&gt;，是一种&lt;strong&gt;理想的修饰、改造生物遗传物质的方法&lt;/strong&gt;。这项技术的诞生可以说是&lt;strong&gt;分子生物学技术上继转基因技术后的又一革命&lt;/strong&gt;。尤其是条件性、诱导性基因打靶系统的建立，使得对基因靶位时间和空间上的操作更加明确、效果更加精确、可靠，它的发展将为发育生物学、分子遗传学、免疫学及医学等学科提供了一个全新的、强有力的研究、治疗手段，具有广泛的应用前景和商业价值。基因敲除技术主要应用于动物模型的建立，而最成熟的实验动物是小鼠，对于大型哺乳动物的基因敲除模型还处于探索阶段。&lt;/p&gt;
&lt;h4&gt;基因沉默&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;基因沉默&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%9f%ba%e5%9b%a0%e6%b2%89%e9%bb%98&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;泛指生物细胞藉&lt;strong&gt;各种基因表现调控机制抑制某一基因表现的现象&lt;/strong&gt;，机制包括DNA甲基化、位置效应、基因组铭印、&lt;strong&gt;遗传印记&lt;/strong&gt;、基因转应、重复序列诱导点突变、副突变、RNA静默（包括RNA干扰、基因压制与非配对DNA介导的减数分裂沉默等，由miRNA、siRNA、piRNA与rasiRNA等小RNA引导）和mRNA降解等，例如许多mRNA的3&amp;rsquo;非转译区（3&amp;rsquo;UTR）即可和miRNA结合，以降低mRNA的转译达成基因静默。&lt;/p&gt;
&lt;p&gt;生物研究中，研究人员为研究一个基因的功能，会以RNA干扰或CRISPR等基因敲落技术达成基因静默，&lt;strong&gt;大幅降低目标基因的表现&lt;/strong&gt;以检测其影响，进而推得目标基因的功能。相较于基因剔除完全移除目标基因的表现，基因敲落后目标基因表现虽被抑制，但仍保有一定程度的表现量。&lt;/p&gt;
&lt;p&gt;总之，基因沉默是基因表达调控的一种重要方式，是生物体在基因调控水平上的一种自我保护机制，在外源DNA侵入、病毒侵染和DNA转座、重排中有普遍性。对基因沉默进行深入研究，可帮助人们进一步揭示生物体基因遗传表达调控的本质，在基因克服基因沉默现象，从而使外源基因能更好的按照人们的需要进行有效表达；利用基因沉默在基因治疗中有效抑制有害基因的表达，达到治疗疾病的目的，所以研究基因沉默具有极其重要的理论和实践意义。&lt;/p&gt;
&lt;h4&gt;蛋白质组学&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;蛋白质组学&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%9b%8b%e7%99%bd%e8%b4%a8%e7%bb%84%e5%ad%a6&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;蛋白质组&lt;/strong&gt;：指的是一个生物体可以表达的所有蛋白质。每个物种都有自己的、独特的蛋白质组。与基因组（每个生物体内的全套基因）不同，蛋白质组的组成随着时间和整个生物体的变化而不断变化。因此，当科学家提到蛋白质组时，他们有时也是指某一特定时间点的蛋白质组（如胚胎与成熟生物体），或指生物体内某一特定细胞类型或组织的蛋白质组。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;蛋白质组学&lt;/strong&gt;：是对蛋白质组的研究，研究不同的蛋白质之间如何相互作用以及它们在生物体内发挥的作用。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;通过研究在&lt;strong&gt;大规模水平上&lt;/strong&gt;研究蛋白质的特征，包括蛋白质的&lt;strong&gt;表达水平&lt;/strong&gt;，翻译后的&lt;strong&gt;修饰&lt;/strong&gt;，蛋白与蛋白&lt;strong&gt;相互作用&lt;/strong&gt;等，由此获得蛋白质水平上的关于疾病发生，细胞代谢等过程的整体而全面的认识。&lt;/p&gt;
&lt;p&gt;在蛋白质组学中，有多种方法可以研究蛋白质。 通常，可以通过使用抗体（免疫测定）或质谱法检测蛋白质。 如果分析复杂的生物样品，需要在定量斑点印迹分析(quantitative dot blot analysis) (缩写：qdb) 中使用非常特异的抗体，或者在检测步骤之前需要使用生化分离，因为样品中的分析物太多而无法进行 准确的检测和量化。&lt;/p&gt;
&lt;p&gt;不同的mRNA翻译成不同的蛋白质，而且很多蛋白质被翻译后也在细胞中会有非常多样的化学修饰。这些化学修饰都对蛋白质的功能非常关键。例如磷酸化修饰，甲基化修饰，乙酰基化修饰，糖基化修饰，氧化修饰，硝基化修饰等。&lt;/p&gt;
&lt;p&gt;
    &lt;img src=&#34;.././media/%e5%a4%a7%e5%ad%a6%e7%94%9f%e7%89%a9%e5%ad%a6/image8.png&#34; alt=&#34;&#34;  loading=&#34;lazy&#34; /&gt;
&lt;strong&gt;意义：&lt;/strong&gt;

    &lt;img src=&#34;.././media/%e5%a4%a7%e5%ad%a6%e7%94%9f%e7%89%a9%e5%ad%a6/image9.png&#34; alt=&#34;&#34;  loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h4&gt;酶&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;酶&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e9%85%b6&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;由&lt;a href=&#34;https://baike.baidu.com/item/%E6%B4%BB%E7%BB%86%E8%83%9E/6368522?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;活细胞&lt;/a&gt;产生的、对其底物具有高度特异性和高度催化效能的&lt;a href=&#34;https://baike.baidu.com/item/%E8%9B%8B%E7%99%BD%E8%B4%A8/309120?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;蛋白质&lt;/a&gt;或&lt;a href=&#34;https://baike.baidu.com/item/RNA/98142?fromModule=lemma_inlink&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;RNA&lt;/a&gt;。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;酶具有高效率的催化能力；其效率是一般无机催化剂的10的7次幂～10的13次幂。&lt;/li&gt;
&lt;li&gt;酶具有专一性；（每一种酶只能催化一种或一类化学反应。）&lt;/li&gt;
&lt;li&gt;酶在生物体内参与每一次反应后，它本身的性质和数量都不会发生改变（与催化剂相似）；&lt;/li&gt;
&lt;li&gt;酶的作用条件较温和。
&lt;ul&gt;
&lt;li&gt;酶所催化的化学反应一般是在比较温和的条件下进行的。&lt;/li&gt;
&lt;li&gt;在最适宜的温度和PH条件下，酶的活性最高。温度和PH偏高或偏低，酶活性都会明显降低。一般来说，动物体内的酶最适温度在35～40℃之间；植物体内的酶最适温度在40～50℃之间；动物体内的酶最适PH大多在6.5～8.0之间，但也有例外，如胃蛋白酶的最适PH为1.5；植物体内的酶最适PH大多在4.5～6.5之间。&lt;/li&gt;
&lt;li&gt;过酸、过碱或温度过高，会使酶的空间结构遭到破坏，使酶永久失活。0℃左右时，酶的活性很低，但酶的空间结构稳定，在适宜的温度下酶的活性可以升高。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;活性可调节性。&lt;/li&gt;
&lt;li&gt;有些酶的催化性与辅因子有关。&lt;/li&gt;
&lt;li&gt;易变性：大多数酶都是蛋白质，因而会被高温、强酸、强碱等破坏。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;酶对化学反应的催化效率称为酶活性。&lt;/p&gt;
&lt;h4&gt;反向遗传学&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;反向遗传学&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%8f%8d%e5%90%91%e9%81%97%e4%bc%a0%e5%ad%a6&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;广义的反向遗传学泛指从生物基因组及其所含生物信息出发，&lt;strong&gt;采用&amp;quot;基因→性状&amp;quot;的研究路线&lt;/strong&gt;，对生物体进行&lt;strong&gt;遗传和变异规律的研究&lt;/strong&gt;，揭示生物的&lt;strong&gt;表现型与基因型之间的关系&lt;/strong&gt;，探讨生命遗传规律的分子遗传学分支学科。从方法学的角度而言，反向遗传学是在&lt;strong&gt;获得生物基因信息的基础上，对基因进行修饰，如基因定点突变、基因插入/缺失和基因置换等，来研究生物基因结构和功能的策略&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;研究方法：&lt;/strong&gt;
反向遗传学，又称DNA分析遗传学，常采用离体定向诱变技术来制造和分析突变。离体定向诱变与一般的诱变不同，通常所讲的自发突变和各种诱发突变都是在细胞内发生的，要先从表现型上的变化发现突变，继而分离突变体，再采用遗传学方法和其他方法进行分析，才能知道突变的性质。包括基因突变，基因置换，基因重组，基因敲除、基因沉默等方法。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;意义&lt;/strong&gt;：与反向遗传学操作相关的各种技术统称为反向遗传学技术，包括RNA干扰（RNA interference，RNAi）技术、基因沉默技术、基因体外转录技术等，是DNA&lt;a href=&#34;https://www.zhihu.com/search?q=%E9%87%8D%E7%BB%84%E6%8A%80%E6%9C%AF&amp;amp;search_source=Entity&amp;amp;hybrid_search_source=Entity&amp;amp;hybrid_search_extra=%7b&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;重组技术&lt;/a&gt;应用范围的扩展与延伸。随着基因组序列测定技术的日渐成熟，反向遗传学技术的应用将越来越广泛。&lt;/p&gt;
&lt;p&gt;目前反向遗传学技术已广泛应用于生命科学研究的各个领域，病毒研究方面的作用尤其明显，特别是RNA病毒研究方面。&lt;/p&gt;
&lt;h4&gt;核外遗传&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;核外遗传&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%a0%b8%e5%a4%96%e9%81%97%e4%bc%a0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;又称细胞质遗传。指由核外（细胞质）的遗传物质所控制的遗传。真核细胞生物在核外的细胞器，如线粒体、叶绿体中也存在少量的DNA，分别称为线粒体DNA (mtDNA)和叶绿体DNA (ctDNA)，这些遗传单位统称为核外遗传因子。&lt;/p&gt;
&lt;p&gt;核外遗传因子存在于线粒体和叶绿体基因组中，他们能够自主复制，其遗传行为的传递不按核基因的方式进行，也不出现相应的分离比，故又称之为非孟德尔式遗传。核外遗传的特点是：细胞器基因组通过细胞质由一代传给另一代；亲本等位基因的分离比是4:0，而不同于细胞核基因中的2:2分离比；正反交的结果不同，杂交子代的某些性状只具有母本的表现型。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;核外遗传有五项主要特点：&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;正反交的结果不同&lt;/strong&gt;。核外基因通常显示逐代出现单亲遗传（uniparental inheritance）的现象，即所有的后代不论雌雄都只有一个亲体的某一表型（此和性连锁是不同的）。最典型的是高等真核生物中，仅母亲的性状在后代中得到表达，这种现象称母体遗传（maternal inheritance）。这是由雌性配子一卵中含有大量的细胞质，而雄性配子一精子几乎不含细胞质，因此合子的细胞质基本上来自母本，而细胞质中含有大量的细胞器，如线粒体和叶绿体等。有的细胞器带有核外基因，形成了母体遗传。核基因的正反交第一代结果相同都显示显性亲本性状，性-连锁基因正反交第一代结果不同；性状和性染色的组合有关；核外基因正反交第一代结果不同，但F1都显示母本的情况，和显隐性及性染色体的组合无关。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;不出现分离比&lt;/strong&gt;，即非孟德尔式遗传；&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;母本的表型决定了所有F1代的表型&lt;/strong&gt;；&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;遗传物质在细胞器上&lt;/strong&gt;，不受核移植的影响；&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;不能进行遗传作图&lt;/strong&gt;。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;核外遗传的分类：&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;线粒体遗传&lt;/strong&gt;：如酵母菌的小菌落突变。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;叶绿体遗传&lt;/strong&gt;：如衣藻的叶绿体遗传。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;细胞内敏感性物质的遗传&lt;/strong&gt;：如草履虫放毒性的遗传，果蝇的感染性遗传。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;母体影响&lt;/strong&gt;：包括短暂的母体影响和持久的母体影响。（由于母体中核基因的某些产物积累在卵母细胞地细胞质中,使子代表型不由自身的基因型所决定而出现与母体表型相同的遗传现象,称母体影响）&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;遗传标记&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;遗传标记&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e9%81%97%e4%bc%a0%e6%a0%87%e8%ae%b0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;指在遗传分析上用作标记的基因，也称为标记基因。指&lt;strong&gt;可追踪染色体、染色体某一节段、某个基因座在家系中传递的任何一种遗传特性&lt;/strong&gt;。它具有两个基本特征，即&lt;strong&gt;可遗传性和可识别性&lt;/strong&gt;，因此生物的任何有差异表型的基因突变型均可作为遗传标记。&lt;/p&gt;
&lt;p&gt;包括形态学标记(morphological marker，肉眼可见的或仪器测量动物的外部特征 )、细胞学标记(cytological marker，对处理过的动物个体染色体数目和形态进行分析)、生物化学标记(biochemical marker，以动物体内的某些生化性状为遗传标记)、免疫学标记(Immune Genetic Markers，以动物的免疫学特征为遗传标记)和分子标记(molecular marker，以个体间遗传物质内核苷酸序列变异为基础的遗传标记)五种类型。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Wiki定义&lt;/strong&gt;：&lt;strong&gt;遗传标记&lt;/strong&gt;（英语：&lt;strong&gt;genetic marker&lt;/strong&gt;）是已知&lt;strong&gt;在&lt;a href=&#34;https://zh.m.wikipedia.org/wiki/%E6%9F%93%E8%89%B2%E4%BD%93&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;染色体&lt;/a&gt;上位置的一种基因或&lt;a href=&#34;https://zh.m.wikipedia.org/wiki/DNA%E5%BA%8F%E5%88%97&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;DNA序列&lt;/a&gt;&lt;/strong&gt;，可被用于&lt;strong&gt;鉴定&lt;a href=&#34;https://zh.m.wikipedia.org/wiki/%E7%94%9F%E7%89%A9&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;生物&lt;/a&gt;&lt;a href=&#34;https://zh.m.wikipedia.org/wiki/%E4%B8%AA%E4%BD%93&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;个体&lt;/a&gt;或&lt;a href=&#34;https://zh.m.wikipedia.org/wiki/%E7%89%A9%E7%A7%8D&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;物种&lt;/a&gt;&lt;/strong&gt;。其可被描述为&lt;strong&gt;可观测变异&lt;/strong&gt;（可因位于基因组基因座中的突变或改变而产生）。遗传标记可能是一段短的DNA序列，例如单个碱基对改变的周围序列（&lt;a href=&#34;https://zh.m.wikipedia.org/wiki/%E5%96%AE%E6%A0%B8%E8%8B%B7%E9%85%B8%E5%A4%9A%E6%85%8B%E6%80%A7&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;单核苷酸多态性&lt;/a&gt;，SNP）或一段长序列，例如&lt;a href=&#34;https://zh.m.wikipedia.org/wiki/%E5%B0%8F%E8%A1%9B%E6%98%9F%E5%BA%8F%E5%88%97&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;小卫星序列&lt;/a&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;转基因生物&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;转基因生物&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%bd%ac%e5%9f%ba%e5%9b%a0%e7%94%9f%e7%89%a9&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;通过&lt;strong&gt;分子生物学技术&lt;/strong&gt;，人为的&lt;strong&gt;分离或修饰&lt;/strong&gt;具有特定遗传性状的优质目的基因，将其通过&lt;strong&gt;特定途径导入到靶标生物体的基因组中&lt;/strong&gt;，由于导入基因的表达会引起靶标生物体的特定性状发生可遗传的修饰改变，从而达到改造生物特性、获得新的生物体的目的，这种技术称之为人工转基因技术。&lt;/p&gt;
&lt;p&gt;也指能够在不导入外源基因的情况下，通过对生物体本身遗传物质的加工、敲除、屏蔽等方法也能改变生物体的遗传特性，获得人们希望得到的性状。&amp;ldquo;基因修饰生物&amp;rdquo;。&lt;/p&gt;
&lt;h4&gt;趋同演化&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;趋同演化&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%b6%8b%e5%90%8c%e6%bc%94%e5%8c%96&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;源自不同祖先的生物，由于&lt;strong&gt;相似的生活方式&lt;/strong&gt;，&lt;strong&gt;整体或部分形态结构向着同一方向改变&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;趋同是指两种或两种以上&lt;strong&gt;亲缘关系甚远&lt;/strong&gt;的生物，由于栖居于同一类型的环境之中，从而演化成具有相似的形态特征或构造的现象。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;机制&lt;/strong&gt;：在&lt;a href=&#34;https://zh.m.wikipedia.org/wiki/%E7%94%9F%E7%89%A9%E5%BD%A2%E6%85%8B%E5%AD%B8&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;形态学&lt;/a&gt;中，不同物种身处相似环境或生活习性相近时，可能会演化出同功特征。占据相似的&lt;a href=&#34;https://zh.m.wikipedia.org/wiki/%E7%94%9F%E6%80%81%E4%BD%8D&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;生态位&lt;/a&gt;（也就是说有独特的生活方式），物种面临的类似问题可能会引出类似的解决方案。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;飞行的&lt;strong&gt;多次演化&lt;/strong&gt;是趋同演化的典型案例，带翅&lt;a href=&#34;https://zh.m.wikipedia.org/wiki/%E6%98%86%E8%99%AB&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;昆虫&lt;/a&gt;、&lt;a href=&#34;https://zh.m.wikipedia.org/wiki/%E9%B8%9F&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;鸟类&lt;/a&gt;、&lt;a href=&#34;https://zh.m.wikipedia.org/wiki/%E7%BF%BC%E9%BE%8D%E7%9B%AE&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;翼龙&lt;/a&gt;和&lt;a href=&#34;https://zh.m.wikipedia.org/wiki/%E8%9D%99%E8%9D%A0&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;蝙蝠&lt;/a&gt;都各自独立演化出了飞行能力。由趋同演化产生的相似特征称为同功，而有共同起源的结构或特征则被称为&lt;a href=&#34;https://zh.m.wikipedia.org/wiki/%E5%90%8C%E6%BA%90&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;同源&lt;/a&gt;，不同生物之间同源特征可能具备不同的功能。鸟类、翼龙、蝙蝠的&lt;a href=&#34;https://zh.m.wikipedia.org/wiki/%E7%BF%85%E8%86%80&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;翅膀&lt;/a&gt;是同功结构，负责达成飞行这一能力，而其&lt;a href=&#34;https://zh.m.wikipedia.org/wiki/%E8%82%A2&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;前肢&lt;/a&gt;是同源结构，尽管功能不同，但有共同的起源。&lt;/p&gt;
&lt;h4&gt;协同演化&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;协同演化&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%8d%8f%e5%90%8c%e6%bc%94%e5%8c%96&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;两个或多个[无亲缘]关系的物种共同生活，在各自演化的过程中相互影响，包括它们的演化方向、速率等。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;两种生物可以是空间上生活在一起，也可以是一方生活在另一方的体内或体表&lt;/strong&gt;等，但也不会给另一方造成严重的危害。协同演化还表现在&lt;strong&gt;生物与环境&lt;/strong&gt;之间，即生物为了&lt;strong&gt;适应某种特定的环境条件&lt;/strong&gt;而使自身产生了一系列的演化变化，当生活的环境发生改变时，生物随之&lt;strong&gt;发生一些主动调整而更好地与生活环境和谐相处&lt;/strong&gt;。研究显示，在生物与环境的协同演化中，不光是生物为适应其生活的环境做出调整，环境也会因为其中的生物发生的演化而发生一定程度的改变，以使生物与环境高度统一。地质历史中不乏这样的实例。&lt;/p&gt;
&lt;p&gt;这种演化行为是生物在环境的选择压力下出现的。环境因素包括非生物的（无机的）也包括其他生物的（有机的）。因此，它是一种进化机制，可以发生在不同的生物学层次：既可以出现在分子水平上（如DNA和蛋白质序列的突变），也可以出现在宏观水平上（如物种形态性状、行为等的变化）。比如，对于捕食者和被捕食者来说，被捕食者会演化出更好的逃脱机制以逃生，而捕食者则会演化出相应的猎取能力，这些都属于典型的协同演化。&lt;/p&gt;
&lt;p&gt;作为各种生物群落的一个基本特征，协同演化在自然界无处不在，时刻发生着。它对于地球生态系统的多样性也发挥了非常重要的作用，许多动物（如鸟类）和植物之间就存在协同演化关系，比如蜜蜂与兰花。&lt;/p&gt;
&lt;h4&gt;基因水平转移&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;基因水平转移&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%9f%ba%e5%9b%a0%e6%b0%b4%e5%b9%b3%e8%bd%ac%e7%a7%bb&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;指&lt;strong&gt;生物将遗传物质传递给[其他细胞而非其子代]的过程&lt;/strong&gt;，例如：接合、转导及转化。与此相对，&amp;ldquo;基因垂直传递&amp;quot;指生物由其祖先继承遗传物质。它打破了亲缘关系的界限，使基因流动的可能变得更为复杂。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;接合&lt;/strong&gt;：指两个细菌之间发生的一种遗传物质交换现象，属于细菌有性生殖的一个重要阶段。在接合现象发生时，两个细胞&lt;strong&gt;直接接合&lt;/strong&gt;或者通过类似于桥一样的通道接合，并且发生基因的转移。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;转导&lt;/strong&gt;：因&lt;strong&gt;病毒&lt;/strong&gt;（即噬菌体）&lt;strong&gt;入侵&lt;/strong&gt;而将一个细菌的DNA片段转置到另一细菌中的过程，亦可指透过病毒载体把外来DNA带入到细菌中的过程。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;转化&lt;/strong&gt;：细胞通过&lt;strong&gt;摄取外源遗传物质&lt;/strong&gt;(DNA或RNA)而发生遗传学改变的过程。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;水平基因转移是细菌&lt;a href=&#34;https://zh.m.wikipedia.org/wiki/%E6%8A%97%E7%94%9F%E7%B4%A0%E6%8A%97%E8%97%A5%E6%80%A7&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;抗生素抗药性&lt;/a&gt;的主要原因，并且在细菌可降解新型化合物例如人类创建的杀虫剂进化中起著重要作用，并在进化，维护和传输毒性的重要原因。这种基因水平转移经常涉及温和的&lt;a href=&#34;https://zh.m.wikipedia.org/wiki/%E5%99%AC%E8%8F%8C%E9%AB%94&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;噬菌体&lt;/a&gt;和&lt;a href=&#34;https://zh.m.wikipedia.org/wiki/%E8%B3%AA%E7%B2%92&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;质粒&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;人工的基因水平转移属于&lt;a href=&#34;https://zh.m.wikipedia.org/wiki/%E5%9F%BA%E5%9B%A0%E5%B7%A5%E7%A8%8B&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;基因工程&lt;/a&gt;的一种。&lt;/p&gt;
&lt;h4&gt;分子钟理论&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;分子钟理论&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%88%86%e5%ad%90%e9%92%9f%e7%90%86%e8%ae%ba&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;任意两个物种，**自从分化成两个物种后，它们之间的遗传差异（DNA或者蛋白序列）的进化速度应该与分化的时间时保持相对稳定的。**某一蛋白在不同物种间的取代数与所研究物种间的分歧时间接近正线性关系，这一理论便是分子钟理论。同理也可以推导，两个物种的遗传差异与它们上一次从共同祖先分离出来的时间，也应该是成正相关比例的。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;机制&lt;/strong&gt;：&amp;ldquo;中性演化理论&amp;quot;使得分子钟得到了解释：基因会发生随机突变，而这些突变中存在着很多中性突变&amp;mdash;&amp;mdash;它对于个体没有好处也没有坏处，因此会被保留下来。这样一来，分子钟的现象就很好理解了：在进化过程中很多突变被保留了下来，而进化距离差得越远，那么分子上的突变就会差的越多，因此我们就可以根据分子上的差距，去推算它们过去进化的过程。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;分子钟理论的生物学意义主要有：&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;提供了一种研究物种间关系的新方法：利用分子钟理论，可以用分子遗传学方法来研究物种之间的距离和演化关系。&lt;/li&gt;
&lt;li&gt;提供了一种研究物种演化时间的新工具：分子钟理论可以用来估算物种演化的时间，进而帮助我们了解物种演化的进程。&lt;/li&gt;
&lt;li&gt;为系统发育研究提供了理论依据：分子钟理论通过研究DNA序列的变化，为我们理解物种演化的进程和系统发育关系提供了重要的理论依据。&lt;/li&gt;
&lt;li&gt;帮助我们更好的了解物种之间的联系，探究物种的演化脉络。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;缺陷&lt;/strong&gt;：分子钟假说成立的条件DNA或者蛋白质序列的替代速率是恒定的。20世纪80年代以来，随着DNA序列数据快速积累，大量的证据表明：在长期进化过程中，很多类群的绝大多数基因或蛋白质的序列替换速率根本不符合分子钟假说。对于蛋白质序列，在物种适应辐射过程中，其进化速度可能会大大加快。因此，以蛋白质为基础的恒定进化速率并非理想的分子钟；对于核酸分子，不同基因的分子钟速率不同；并且同一基因在不同的生物类群间可能有显著差异，因此同一基因的分子异速进化现象是显而易见的。&lt;/p&gt;
&lt;h4&gt;盖亚假说&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;盖亚假说&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%9b%96%e4%ba%9a%e5%81%87%e8%af%b4&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;盖亚假说认为，&lt;strong&gt;地球上的生物圈就是可以维持地球内稳态的一个活跃的自适应控制系统&lt;/strong&gt;。这样的一个可以自我调节的整体（包括但不限于生物）就被视为盖亚。盖亚假说指&lt;strong&gt;在生命与环境的相互作用之下，能使得地球适合生命持续的生存与发展&lt;/strong&gt;。也就是说，生命不是为了自己才让地球变得宜居。&amp;ldquo;这种调节&amp;quot;让地球更适合生存，是包括生命、空气、海洋和岩石在内的整个进化系统的特点&amp;rdquo;。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;把地球比作一个自我调节的有生命的有机体&lt;/strong&gt;。但这并不意味着世界是有生命的，而是说明生命体与自然环境&amp;mdash;&amp;mdash;包括大气、海洋、极地冰盖以及我们脚下的岩石&amp;mdash;&amp;mdash;之间存在着复杂连贯的相互作用。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;意义&lt;/strong&gt;：全球生态环境恶化是人类当今面临的最严重的问题之一。盖亚假说启示人们，环境问题是涉及整个地球生态系统的问题，要解决这个问题不仅需要用系统的或整体的观点和方法来认识人类生产和生活方式对生态环境影响，而且需要人类共同行动。同时，盖亚假说也从道义上启示人们，包括人类在内的所有生物都是地球母亲的后代，人类既不是地球的主人，也不是地球的管理者，只是地球母亲的后代之一。因此，人类应该热爱和保护地球母亲，并与其他生物和睦相处。&lt;/p&gt;
&lt;h4&gt;生态位&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;生态位&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%94%9f%e6%80%81%e4%bd%8d&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;生态位是一个物种&lt;strong&gt;所处的环境&lt;/strong&gt;以及其&lt;strong&gt;本身生活习性&lt;/strong&gt;的总称。每个物种都有自己独特的生态位，借以跟其他物种作出区别。&lt;strong&gt;生态位包括该物种觅食的地点，食物的种类和大小，还有其每日的和季节性的生物节律&lt;/strong&gt;。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;特征&lt;/strong&gt;：生态位的环境因素（&lt;strong&gt;温度，食物，地表湿度，生存环境等&lt;/strong&gt;）的综合，构成概念生态位空间。这是一种n维超体积，但出于可视化的原因会将它简化为二维或三维龛位图进行显示。每种环境因素成为一个维度。在两个生态龛位中，考虑观察的维度越多，两个生态龛位的差别就越明显，越容易被区分开来。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;生态位的生物学意义包括：&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;帮助我们理解物种如何在其环境中生存和繁殖。&lt;/li&gt;
&lt;li&gt;帮助我们预测物种如何对其环境和其他物种产生影响。&lt;/li&gt;
&lt;li&gt;帮助我们设计保护和管理生态系统的策略。&lt;/li&gt;
&lt;li&gt;帮助我们理解为什么某些物种会灭绝，而其他物种却能够繁衍生息。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;生态幅&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;生态幅&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%94%9f%e6%80%81%e5%b9%85&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;指&lt;strong&gt;某一生物对环境因子的耐受范围，即其生态上的最高点与最低点之间的范围&lt;/strong&gt;。主要由该物种的遗传特性决定。&lt;/p&gt;
&lt;p&gt;生态幅度是有机体或有机体的某一生理过程，对生态环境或其中一个或多个生态因素变化的适应范围。生态幅度在种内、种间不同，同一个体的不同生育阶段，生态幅度也不同。&lt;/p&gt;
&lt;p&gt;在生态最适域（最适范围）中，生物生活能力及数量达到最高水平，由于需求能得到满足，生物对该生态因子的变化不敏感；一旦超出最适范围，该生态因子的轻度变化即可引起生物生活能力及分布数量的剧烈变化。&lt;/p&gt;
&lt;p&gt;根据生物对各种生态因子适应的生态幅度，可分为很多类型，对温度因子的有狭温性和广温性；对光因子的有狭光性和广光性；对水因子的有狭水性和广水性；对盐因子的有狭盐性和广盐性；对湿度因子的有狭湿性和广湿性；对食物因子的有狭食性和广食性；对栖息地有狭栖性和广栖性等。而且，同一生物在不同发育阶段，其生态幅度不相同。还可分为广生型生物，狭生性生物。&lt;/p&gt;
&lt;h4&gt;营养级&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;营养级&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%90%a5%e5%85%bb%e7%ba%a7&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;生物在食物链之中所占的位置。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;营养级的生物学意义：&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;揭示生物之间的相互关系，帮助我们理解生态系统的运作&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;帮助我们预测生态系统对外界变化的响应&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;帮助我们设计保护和管理生态系统的策略&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;为生物多样性的研究提供重要的理论框架&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;生态足迹&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;生态足迹&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%94%9f%e6%80%81%e8%b6%b3%e8%bf%b9&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;指能够持续地提供资源或消纳废物的、具有生物生产力的地域空间，&lt;strong&gt;维持一个人、地区、国家的生存&lt;/strong&gt;所需要的或者指能够&lt;strong&gt;容纳人类所排放的废物的、具有生物生产力的地域面积&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;生态足迹越大，证明其对生态的破坏越严重。生态足迹既反映了&lt;strong&gt;个人或地区的资源消耗强度&lt;/strong&gt;，又反映了&lt;strong&gt;某个区域的资源供给能力和资源消耗总量&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;意义：&lt;/strong&gt;
生态足迹分析方法首先通过引入生态生产性土地概念实现了对各种自然资源的统一描述，其次通过引入等价因子和生产力系数进一步实现了各国各地区各类生态生产性土地的可加性和可比性。这使得生态足迹分析具有广泛的应用范围，既可以计算个人、家庭、城市、地区、国家乃至整个世界这些不同对象的生态足迹，对它们的足迹进行纵向的、横向的比较分析。&lt;/p&gt;
&lt;p&gt;总之，生态足迹分析指标为度量可持续性程度提供了一杆&amp;quot;公平秆&amp;rdquo;，它能够对时间、空间二维的可持续性程度做出客观量度和比较，使人们能明确知晓现实距离可持续性目标尚有多远，从而有助于监测可持续方案实施的效果。另外，生态足迹计算具有很强的可复制性。这使得将生态足迹计算过程制作成一个软件包成为可能，从而可以推动该指标及方法的普及化。&lt;/p&gt;
&lt;h3&gt;（二）各章课后思考题&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;二各章课后思考题&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%ba%8c%e5%90%84%e7%ab%a0%e8%af%be%e5%90%8e%e6%80%9d%e8%80%83%e9%a2%98&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;1. 生命的基本特征是什么？生命科学的重要性是什么？生命科学（本课程内容）的基本模块有哪些，彼此之间是怎样的逻辑联系（内容体系或知识图谱）？&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;1-生命的基本特征是什么生命科学的重要性是什么生命科学本课程内容的基本模块有哪些彼此之间是怎样的逻辑联系内容体系或知识图谱&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#1-%e7%94%9f%e5%91%bd%e7%9a%84%e5%9f%ba%e6%9c%ac%e7%89%b9%e5%be%81%e6%98%af%e4%bb%80%e4%b9%88%e7%94%9f%e5%91%bd%e7%a7%91%e5%ad%a6%e7%9a%84%e9%87%8d%e8%a6%81%e6%80%a7%e6%98%af%e4%bb%80%e4%b9%88%e7%94%9f%e5%91%bd%e7%a7%91%e5%ad%a6%e6%9c%ac%e8%af%be%e7%a8%8b%e5%86%85%e5%ae%b9%e7%9a%84%e5%9f%ba%e6%9c%ac%e6%a8%a1%e5%9d%97%e6%9c%89%e5%93%aa%e4%ba%9b%e5%bd%bc%e6%ad%a4%e4%b9%8b%e9%97%b4%e6%98%af%e6%80%8e%e6%a0%b7%e7%9a%84%e9%80%bb%e8%be%91%e8%81%94%e7%b3%bb%e5%86%85%e5%ae%b9%e4%bd%93%e7%b3%bb%e6%88%96%e7%9f%a5%e8%af%86%e5%9b%be%e8%b0%b1&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;
    &lt;img src=&#34;.././media/%e5%a4%a7%e5%ad%a6%e7%94%9f%e7%89%a9%e5%ad%a6/image10.png&#34; alt=&#34;&#34;  loading=&#34;lazy&#34; /&gt;

    &lt;img src=&#34;.././media/%e5%a4%a7%e5%ad%a6%e7%94%9f%e7%89%a9%e5%ad%a6/image11.png&#34; alt=&#34;&#34;  loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h4&gt;2. 植物特有的特征有哪些，由此塑造了哪些关联特征？如何从基因繁衍的角度，理解植物生活史的关键阶段和过程？层级分类系统对生物多样性信息的存储和提取有什么优点？&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;2-植物特有的特征有哪些由此塑造了哪些关联特征如何从基因繁衍的角度理解植物生活史的关键阶段和过程层级分类系统对生物多样性信息的存储和提取有什么优点&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#2-%e6%a4%8d%e7%89%a9%e7%89%b9%e6%9c%89%e7%9a%84%e7%89%b9%e5%be%81%e6%9c%89%e5%93%aa%e4%ba%9b%e7%94%b1%e6%ad%a4%e5%a1%91%e9%80%a0%e4%ba%86%e5%93%aa%e4%ba%9b%e5%85%b3%e8%81%94%e7%89%b9%e5%be%81%e5%a6%82%e4%bd%95%e4%bb%8e%e5%9f%ba%e5%9b%a0%e7%b9%81%e8%a1%8d%e7%9a%84%e8%a7%92%e5%ba%a6%e7%90%86%e8%a7%a3%e6%a4%8d%e7%89%a9%e7%94%9f%e6%b4%bb%e5%8f%b2%e7%9a%84%e5%85%b3%e9%94%ae%e9%98%b6%e6%ae%b5%e5%92%8c%e8%bf%87%e7%a8%8b%e5%b1%82%e7%ba%a7%e5%88%86%e7%b1%bb%e7%b3%bb%e7%bb%9f%e5%af%b9%e7%94%9f%e7%89%a9%e5%a4%9a%e6%a0%b7%e6%80%a7%e4%bf%a1%e6%81%af%e7%9a%84%e5%ad%98%e5%82%a8%e5%92%8c%e6%8f%90%e5%8f%96%e6%9c%89%e4%bb%80%e4%b9%88%e4%bc%98%e7%82%b9&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;植物特有的特征&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;自养 (Autotrophic, or self-feeding)&lt;/li&gt;
&lt;li&gt;光合作用 (Photosynthesis)&lt;/li&gt;
&lt;li&gt;固着生长 (sessile, or immobile)&lt;/li&gt;
&lt;li&gt;具细胞壁 (纤维素 Cellulose)&lt;/li&gt;
&lt;li&gt;具无限生长 (Indeterminate growth)，具有连续发育的特点（发育模式：无限发育与重复分化）&lt;/li&gt;
&lt;li&gt;具有性和无性繁殖 (reproduce asexually and sexually)&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;3. 动物在演化过程中多次发生了生活方式的变化，比如：从漂浮生活到游泳生活、从水生到陆生生活、从身体贴地爬行到离地奔跑，在每一次变化过程中出现了哪些关键性的特征变化？目前，利用动物的形态特征构建的动物系统树与利用基因组信息构建的系统树之间具有非常大的区别，原因有哪些？&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;3-动物在演化过程中多次发生了生活方式的变化比如从漂浮生活到游泳生活从水生到陆生生活从身体贴地爬行到离地奔跑在每一次变化过程中出现了哪些关键性的特征变化目前利用动物的形态特征构建的动物系统树与利用基因组信息构建的系统树之间具有非常大的区别原因有哪些&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#3-%e5%8a%a8%e7%89%a9%e5%9c%a8%e6%bc%94%e5%8c%96%e8%bf%87%e7%a8%8b%e4%b8%ad%e5%a4%9a%e6%ac%a1%e5%8f%91%e7%94%9f%e4%ba%86%e7%94%9f%e6%b4%bb%e6%96%b9%e5%bc%8f%e7%9a%84%e5%8f%98%e5%8c%96%e6%af%94%e5%a6%82%e4%bb%8e%e6%bc%82%e6%b5%ae%e7%94%9f%e6%b4%bb%e5%88%b0%e6%b8%b8%e6%b3%b3%e7%94%9f%e6%b4%bb%e4%bb%8e%e6%b0%b4%e7%94%9f%e5%88%b0%e9%99%86%e7%94%9f%e7%94%9f%e6%b4%bb%e4%bb%8e%e8%ba%ab%e4%bd%93%e8%b4%b4%e5%9c%b0%e7%88%ac%e8%a1%8c%e5%88%b0%e7%a6%bb%e5%9c%b0%e5%a5%94%e8%b7%91%e5%9c%a8%e6%af%8f%e4%b8%80%e6%ac%a1%e5%8f%98%e5%8c%96%e8%bf%87%e7%a8%8b%e4%b8%ad%e5%87%ba%e7%8e%b0%e4%ba%86%e5%93%aa%e4%ba%9b%e5%85%b3%e9%94%ae%e6%80%a7%e7%9a%84%e7%89%b9%e5%be%81%e5%8f%98%e5%8c%96%e7%9b%ae%e5%89%8d%e5%88%a9%e7%94%a8%e5%8a%a8%e7%89%a9%e7%9a%84%e5%bd%a2%e6%80%81%e7%89%b9%e5%be%81%e6%9e%84%e5%bb%ba%e7%9a%84%e5%8a%a8%e7%89%a9%e7%b3%bb%e7%bb%9f%e6%a0%91%e4%b8%8e%e5%88%a9%e7%94%a8%e5%9f%ba%e5%9b%a0%e7%bb%84%e4%bf%a1%e6%81%af%e6%9e%84%e5%bb%ba%e7%9a%84%e7%b3%bb%e7%bb%9f%e6%a0%91%e4%b9%8b%e9%97%b4%e5%85%b7%e6%9c%89%e9%9d%9e%e5%b8%b8%e5%a4%a7%e7%9a%84%e5%8c%ba%e5%88%ab%e5%8e%9f%e5%9b%a0%e6%9c%89%e5%93%aa%e4%ba%9b&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;
    &lt;img src=&#34;.././media/%e5%a4%a7%e5%ad%a6%e7%94%9f%e7%89%a9%e5%ad%a6/image12.png&#34; alt=&#34;&#34;  loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h4&gt;4. 微生物与人类的关系及其发生原因。古菌与细菌的区别。&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;4-微生物与人类的关系及其发生原因古菌与细菌的区别&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#4-%e5%be%ae%e7%94%9f%e7%89%a9%e4%b8%8e%e4%ba%ba%e7%b1%bb%e7%9a%84%e5%85%b3%e7%b3%bb%e5%8f%8a%e5%85%b6%e5%8f%91%e7%94%9f%e5%8e%9f%e5%9b%a0%e5%8f%a4%e8%8f%8c%e4%b8%8e%e7%bb%86%e8%8f%8c%e7%9a%84%e5%8c%ba%e5%88%ab&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;h4&gt;5. 熟悉细胞学说，了解细胞与病毒的区别。细胞中存在多种不同的程序性死亡方式有何生物学意义？&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;5-熟悉细胞学说了解细胞与病毒的区别细胞中存在多种不同的程序性死亡方式有何生物学意义&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#5-%e7%86%9f%e6%82%89%e7%bb%86%e8%83%9e%e5%ad%a6%e8%af%b4%e4%ba%86%e8%a7%a3%e7%bb%86%e8%83%9e%e4%b8%8e%e7%97%85%e6%af%92%e7%9a%84%e5%8c%ba%e5%88%ab%e7%bb%86%e8%83%9e%e4%b8%ad%e5%ad%98%e5%9c%a8%e5%a4%9a%e7%a7%8d%e4%b8%8d%e5%90%8c%e7%9a%84%e7%a8%8b%e5%ba%8f%e6%80%a7%e6%ad%bb%e4%ba%a1%e6%96%b9%e5%bc%8f%e6%9c%89%e4%bd%95%e7%94%9f%e7%89%a9%e5%ad%a6%e6%84%8f%e4%b9%89&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;
    &lt;img src=&#34;.././media/%e5%a4%a7%e5%ad%a6%e7%94%9f%e7%89%a9%e5%ad%a6/image13.png&#34; alt=&#34;&#34;  loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;在胚胎发育阶段通过细胞凋亡清除多余的和已完成使命的细胞，保证了胚胎的正常发育；在成年阶段通过细胞凋亡清除衰老和病变的细胞，保证了机体的健康。&lt;/p&gt;
&lt;h4&gt;6. 从母源-胚胎转换的角度，如何理解&amp;quot;母源基因&amp;rdquo;？从个体发育的角度看，原肠运动的作用有哪些？举例说明胚胎诱导在器官形成中的作用和意义。&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;6-从母源-胚胎转换的角度如何理解母源基因从个体发育的角度看原肠运动的作用有哪些举例说明胚胎诱导在器官形成中的作用和意义&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#6-%e4%bb%8e%e6%af%8d%e6%ba%90-%e8%83%9a%e8%83%8e%e8%bd%ac%e6%8d%a2%e7%9a%84%e8%a7%92%e5%ba%a6%e5%a6%82%e4%bd%95%e7%90%86%e8%a7%a3%e6%af%8d%e6%ba%90%e5%9f%ba%e5%9b%a0%e4%bb%8e%e4%b8%aa%e4%bd%93%e5%8f%91%e8%82%b2%e7%9a%84%e8%a7%92%e5%ba%a6%e7%9c%8b%e5%8e%9f%e8%82%a0%e8%bf%90%e5%8a%a8%e7%9a%84%e4%bd%9c%e7%94%a8%e6%9c%89%e5%93%aa%e4%ba%9b%e4%b8%be%e4%be%8b%e8%af%b4%e6%98%8e%e8%83%9a%e8%83%8e%e8%af%b1%e5%af%bc%e5%9c%a8%e5%99%a8%e5%ae%98%e5%bd%a2%e6%88%90%e4%b8%ad%e7%9a%84%e4%bd%9c%e7%94%a8%e5%92%8c%e6%84%8f%e4%b9%89&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;卵母细胞向早期胚胎的基因表达模式转换，即&amp;quot;母源-合子过渡（Maternal-to-zygotic transition，MZT）&amp;quot;，是早期胚胎发育过程中的第一个关键事件。在模式生物（如果蝇、斑马鱼、非洲爪蟾）和实验动物（小鼠）中的研究都表明&amp;quot;母源-合子过渡&amp;quot;过程中母源mRNA的适时降解是胚胎自身基因组转录激活的一个重要前提。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;原肠作用&lt;/strong&gt;是指&lt;strong&gt;囊胚&lt;/strong&gt;细胞有规则地移动，&lt;strong&gt;使未来的内胚层和中胚层细胞迁入胚胎内部&lt;/strong&gt;，而&lt;strong&gt;未来的外胚层细胞铺展在胚胎的表面，从而形成原肠胚&lt;/strong&gt;，也称为原肠运动。是早期胚胎由囊胚形成原肠胚的发育过程。囊胚表面一定区域迁移到胚胎内部形成内、中、外三胚层，&lt;strong&gt;为后继的器官形成奠定基础&lt;/strong&gt;。通过原肠作用，胚胎细胞首先&lt;strong&gt;从未分化状态出现最早的3胚层分化&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;动物在一定的胚胎发育时期, 一部分细胞影响相邻细胞&lt;strong&gt;使其向一定方向分化&lt;/strong&gt;的作用称为&lt;strong&gt;近旁组织的相互作用&lt;/strong&gt;, 或称为胚胎诱导。诱导相邻细胞发育的信号分子是可扩散的蛋白质，称为成型素。能对其他细胞的分化起诱导作用的细胞，即分泌成型素的细胞称为诱导者或组织者(organizer)。如将正常的能够发育成神经组织的细胞从两栖类原肠期的早期胚胎中切下，然后移植到另一个胚胎的可以发育成表皮的区域中，结果，移植来的细胞发育成了表皮而不是神经细胞。 同样，将可以分化发育成表皮组织的细胞移植到能够发育成神经组织的胚胎中，移植的细胞发育成了神经细胞。胚胎诱导一般发生在&lt;strong&gt;内胚层和中胚层&lt;/strong&gt;或&lt;strong&gt;外胚层和中胚层&lt;/strong&gt;之间。&lt;/p&gt;
&lt;h4&gt;7. 下丘脑是如何实现对机体内稳态平衡的调节的？以心血管系统为例，简介机体维持其稳态的调节机制。&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;7-下丘脑是如何实现对机体内稳态平衡的调节的以心血管系统为例简介机体维持其稳态的调节机制&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#7-%e4%b8%8b%e4%b8%98%e8%84%91%e6%98%af%e5%a6%82%e4%bd%95%e5%ae%9e%e7%8e%b0%e5%af%b9%e6%9c%ba%e4%bd%93%e5%86%85%e7%a8%b3%e6%80%81%e5%b9%b3%e8%a1%a1%e7%9a%84%e8%b0%83%e8%8a%82%e7%9a%84%e4%bb%a5%e5%bf%83%e8%a1%80%e7%ae%a1%e7%b3%bb%e7%bb%9f%e4%b8%ba%e4%be%8b%e7%ae%80%e4%bb%8b%e6%9c%ba%e4%bd%93%e7%bb%b4%e6%8c%81%e5%85%b6%e7%a8%b3%e6%80%81%e7%9a%84%e8%b0%83%e8%8a%82%e6%9c%ba%e5%88%b6&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;体温调节&lt;/strong&gt;
&lt;strong&gt;调节体温的中枢&lt;/strong&gt;在下丘脑。破坏哺乳动物的下丘脑后，体温不能保持恒定。下丘脑的体温调节机构除有中枢性温度感受器外，还有控制产热和散热功能的中枢。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;摄食行为的调节&lt;/strong&gt;
动物实验证明，下丘脑的腹内侧区接近正中隆起的两侧受损伤时， 动物的食量大增；如以电流刺激这一部位，则食量大减。因此，这一部位被称为饱中枢(satiety center)。相反，下丘脑外侧区损毁时，动物食量减少，甚至拒食；若刺激这一部位，则食量大增。因而被认为是摄食中枢(feeding center)的所在。在正常机体，这两部位之间可能是互相制约的。至于摄食中枢的自然刺激是什么，有人认为血糖水平的降低是引起摄食中枢兴奋的主要传入信息。实验征明，动物在饥饿状态下。摄食中枢神经元放电频率较高而饱中枢神经元放电频率较低，静脉注入葡萄糖后，摄食中枢神经元放电频率减少而饱中枢神经元放电频率增多。进一步实验证明，饱中枢的活动还与该中枢内神经细胞的糖利用水平有关。糖尿病患者血糖水平增高，但因缺乏胰岛素，饱中枢神经细胞的糖利用率减少，因此其活动降低而使食欲增加。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;水平衡的调节&lt;/strong&gt;
损坏下丘脑外侧区除可引起动物拒食外，饮水也明显减少；刺激下丘脑外侧区某些部位，则可引起动物饮水增多。但控制饮水中枢的确切位置目前还不清楚。
下丘脑控制排水是通过&lt;strong&gt;抗利尿激素&lt;/strong&gt;的分泌来完成的。抗利尿激素是由视上核和室旁核的神经元合成的。神经分泌颗粒沿下丘脑-垂体束的神经纤维向外周运输而贮存于神经垂体内，以高渗盐水注入动物的颈内动脉，可刺激抗利尿激素的分泌。下丘脑内的&lt;strong&gt;渗透压感受器&lt;/strong&gt;可能在视上核和室旁核内。电生理研究观察到，当颈内动脉注入高渗盐水时，视上核内某些神经元放电增多。一般认为，下丘脑控制摄水的区域与抗利尿激素分泌的核团在功能上是有联系的，两者协同调节着水平衡。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;腺垂体激素分泌的调节&lt;/strong&gt;
下丘脑内有些神经元能合成调节腺垂体激素分泌的肽类物质，包括促甲状腺素释放激素、促性腺激素释放激素、生长素释放抑制激素、生长素释放激素、促肾上腺皮质激素释放激素、促黑素细胞激素释放因子、促黑素细胞激素释放抑制因子、催乳素释放因子、催乳素释放抑制因子等。这些肽类物质合成后经轴突运输到正中隆起，由此经垂体门脉系统到达腺垂体，促进或抑制某种腺垂体激素的分泌。此外，下丘脑还有一些神经元对血液中某些激素浓度的变化比较敏感，这种神经元称为觉察细胞(detector cell)，能感受血液中激素浓度变化的信息，反馈调节上述肽类物质的分泌，从而更好地控制腺垂体的激素分泌活动。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;对情绪反应的影响&lt;/strong&gt;
在间脑水平以上切除大脑的猫，常出现一系列&lt;strong&gt;交感神经系统过度兴奋&lt;/strong&gt;的现象，并且张牙舞爪，好似正常猫在搏斗时一样，故称之为&amp;quot;假怒&amp;quot;。平时下丘脑的这种活动受到大脑皮层的抑制而不易表现，但切除大脑皮层以后，则这种抑制解除了，以致在微弱的刺激下就能激发强烈的假怒反应。近年来的研究指出，下丘脑内存在所谓&amp;quot;防御反应区&amp;quot;，它主要位于下丘脑的腹内侧区。在动物麻醉条件下，电刺激该区可引起血压上升，皮肤及胃肠血管收缩，心率加速等交感神经兴奋性反应。在动物清醒状态下，电刺激该区还可出现防御性行为。下丘脑腹内侧区与杏仁核之间有功能联系，两者与情绪反应活动有关。此外，电刺激下丘脑外侧区可引致动物出现攻击行为，电刺激下丘脑背侧区则出现逃避行为。可见，下丘脑与情绪反应的关系非常密切。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;心血管活动的调节&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;一、神经调节：&lt;/strong&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;心脏的神经支配&lt;/strong&gt;：心脏受&lt;strong&gt;植物神经（交感神经和副交感神经）的支配&lt;/strong&gt;。交感神经节节后纤维支配窦房结、心房肌、房室交界区、房室束及其分支和心室肌。&lt;strong&gt;交感神经节后纤维释放的递质为去甲肾上腺素&lt;/strong&gt;，与心肌上的肾上腺素能β1受体相结合，&lt;strong&gt;引起心脏兴奋，使心率加快&lt;/strong&gt;（正性变时作用），房室传导速度加快（正性变传导作用），心肌收缩能力加强（正性变力作用），结果心输出量增加。副交感神经是迷走神经，节后纤维支配窦房结、心房肌、房室交界区、房室束及其分支。副交感神经节后纤维释放的递质是乙酰胆碱，与心肌上的胆碱能M受体相结合，抑制心脏的活动，作用结果与交感神经兴奋的结果相反。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;血管的神经支配&lt;/strong&gt;：从机能上分为缩血管神经纤维和舒血管神经纤维两大类。缩血管神经纤维均属交感神经纤维，故称交感缩血管神经纤维。体内大部分血管仅受交感缩血管神经纤维的单一支配。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;心血管中枢&lt;/strong&gt;：调节心血管活动的基本中枢在延髓。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;心血管反射&lt;/strong&gt;：颈动脉窦、主动脉弓压力感受性反射，该反射对血压的调节机制为负反馈调节。颈动脉体和主动脉体化学感受性反射。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;二、体液调节：&lt;/strong&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;肾上腺素和去甲肾上腺素&lt;/strong&gt;：肾上腺素的心血管效应是心率加快，心输出量增加，动脉血压上升，内脏等处血流量减少，肝、冠脉血流量上升。去甲肾上腺素的心血管效应是心率减慢，外周阻力上升，动脉血压上升。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;血管紧张素&lt;/strong&gt;：最重要的是血管紧张素II，升压效应约为去甲肾上腺素的40倍。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;血管加压素&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;心房钠尿肽&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;8. 新陈代谢中酶的基本特征和催化原理及生物学意义。&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;8-新陈代谢中酶的基本特征和催化原理及生物学意义&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#8-%e6%96%b0%e9%99%88%e4%bb%a3%e8%b0%a2%e4%b8%ad%e9%85%b6%e7%9a%84%e5%9f%ba%e6%9c%ac%e7%89%b9%e5%be%81%e5%92%8c%e5%82%ac%e5%8c%96%e5%8e%9f%e7%90%86%e5%8f%8a%e7%94%9f%e7%89%a9%e5%ad%a6%e6%84%8f%e4%b9%89&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;h4&gt;9. 蛋白质组学的特征及其与生物表型相关性。癌症发生的原因，主要治疗手段及其基本机理。&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;9-蛋白质组学的特征及其与生物表型相关性癌症发生的原因主要治疗手段及其基本机理&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#9-%e8%9b%8b%e7%99%bd%e8%b4%a8%e7%bb%84%e5%ad%a6%e7%9a%84%e7%89%b9%e5%be%81%e5%8f%8a%e5%85%b6%e4%b8%8e%e7%94%9f%e7%89%a9%e8%a1%a8%e5%9e%8b%e7%9b%b8%e5%85%b3%e6%80%a7%e7%99%8c%e7%97%87%e5%8f%91%e7%94%9f%e7%9a%84%e5%8e%9f%e5%9b%a0%e4%b8%bb%e8%a6%81%e6%b2%bb%e7%96%97%e6%89%8b%e6%ae%b5%e5%8f%8a%e5%85%b6%e5%9f%ba%e6%9c%ac%e6%9c%ba%e7%90%86&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;h4&gt;10. 如何理解遗传与变异在生物多样性和生物进化中的意义？如何看待经典遗传学对近代生物学发展的贡献？在分子生物学和生物信息学高度发展的今天，经典遗传学手段还能应用于哪些方面的研究？&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;10-如何理解遗传与变异在生物多样性和生物进化中的意义如何看待经典遗传学对近代生物学发展的贡献在分子生物学和生物信息学高度发展的今天经典遗传学手段还能应用于哪些方面的研究&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#10-%e5%a6%82%e4%bd%95%e7%90%86%e8%a7%a3%e9%81%97%e4%bc%a0%e4%b8%8e%e5%8f%98%e5%bc%82%e5%9c%a8%e7%94%9f%e7%89%a9%e5%a4%9a%e6%a0%b7%e6%80%a7%e5%92%8c%e7%94%9f%e7%89%a9%e8%bf%9b%e5%8c%96%e4%b8%ad%e7%9a%84%e6%84%8f%e4%b9%89%e5%a6%82%e4%bd%95%e7%9c%8b%e5%be%85%e7%bb%8f%e5%85%b8%e9%81%97%e4%bc%a0%e5%ad%a6%e5%af%b9%e8%bf%91%e4%bb%a3%e7%94%9f%e7%89%a9%e5%ad%a6%e5%8f%91%e5%b1%95%e7%9a%84%e8%b4%a1%e7%8c%ae%e5%9c%a8%e5%88%86%e5%ad%90%e7%94%9f%e7%89%a9%e5%ad%a6%e5%92%8c%e7%94%9f%e7%89%a9%e4%bf%a1%e6%81%af%e5%ad%a6%e9%ab%98%e5%ba%a6%e5%8f%91%e5%b1%95%e7%9a%84%e4%bb%8a%e5%a4%a9%e7%bb%8f%e5%85%b8%e9%81%97%e4%bc%a0%e5%ad%a6%e6%89%8b%e6%ae%b5%e8%bf%98%e8%83%bd%e5%ba%94%e7%94%a8%e4%ba%8e%e5%93%aa%e4%ba%9b%e6%96%b9%e9%9d%a2%e7%9a%84%e7%a0%94%e7%a9%b6&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;经典遗传学包括分离定律和独立分配定律。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;分离定律&lt;/strong&gt;指一对遗传因子在杂合状态下并不相互影响，而在配子形成中又按原样分配到配子中去。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;独立分配定律&lt;/strong&gt;指两对或两对以上的基因在配子形成过程中的分配彼此独立。由于雌雄配子的随机组合，因而在子代中出现各种性状的各种组合，而且按一定的比例出现。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;11. 拉马克演化论vs.达尔文演化论的比较，演化的主要驱动力。&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;11-拉马克演化论vs达尔文演化论的比较演化的主要驱动力&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#11-%e6%8b%89%e9%a9%ac%e5%85%8b%e6%bc%94%e5%8c%96%e8%ae%bavs%e8%be%be%e5%b0%94%e6%96%87%e6%bc%94%e5%8c%96%e8%ae%ba%e7%9a%84%e6%af%94%e8%be%83%e6%bc%94%e5%8c%96%e7%9a%84%e4%b8%bb%e8%a6%81%e9%a9%b1%e5%8a%a8%e5%8a%9b&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;h4&gt;12. 地球生态系统碳循环，碳达峰、碳中和与生态学的关系，生物多样性丧失的原因和保护对策。&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;12-地球生态系统碳循环碳达峰碳中和与生态学的关系生物多样性丧失的原因和保护对策&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#12-%e5%9c%b0%e7%90%83%e7%94%9f%e6%80%81%e7%b3%bb%e7%bb%9f%e7%a2%b3%e5%be%aa%e7%8e%af%e7%a2%b3%e8%be%be%e5%b3%b0%e7%a2%b3%e4%b8%ad%e5%92%8c%e4%b8%8e%e7%94%9f%e6%80%81%e5%ad%a6%e7%9a%84%e5%85%b3%e7%b3%bb%e7%94%9f%e7%89%a9%e5%a4%9a%e6%a0%b7%e6%80%a7%e4%b8%a7%e5%a4%b1%e7%9a%84%e5%8e%9f%e5%9b%a0%e5%92%8c%e4%bf%9d%e6%8a%a4%e5%af%b9%e7%ad%96&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;生物碳循环是指生物体通过光合作用将二氧化碳吸收并转化为有机物，生物体死亡或燃烧后，二氧化碳又释放到大气中。而地球物理化学碳循环是指二氧化碳在大气、海洋和土壤中的运动和相互作用。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;碳达峰&lt;/strong&gt;，就是指在&lt;strong&gt;某一个时点，二氧化碳的排放不再增长达到峰值，之后逐步回落&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;碳中和&lt;/strong&gt;则是在&lt;strong&gt;一定时间内直接或间接产生的二氧化碳排放总量，通过植树造林、节能减排等形式，以抵消自身产生的二氧化碳排放量，实现二氧化碳&amp;quot;零排放&amp;quot;&lt;/strong&gt;。&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E5%BD%A2%E5%8A%BF%E4%B8%8E%E6%94%BF%E7%AD%96/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E5%BD%A2%E5%8A%BF%E4%B8%8E%E6%94%BF%E7%AD%96/</guid>
      <description>
        
        
        
      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/</guid>
      <description>
        
        
        
      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E6%80%A7%E4%B8%8E%E7%94%9F%E6%AE%96/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E6%80%A7%E4%B8%8E%E7%94%9F%E6%AE%96/</guid>
      <description>
        
        
        &lt;h1&gt;性与生殖&lt;/h1&gt;&lt;h2&gt;课程大纲&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;课程大纲&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%af%be%e7%a8%8b%e5%a4%a7%e7%ba%b2&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;男女生殖器官和生殖生理&lt;/strong&gt;
1.1 男性生殖器官
1.2 男性生殖生理
1.3 女性生殖器官
1.4 女性生殖生理&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;受精与妊娠&lt;/strong&gt;
2.1 体内的受精过程
2.2 妊娠过程
2.3 胎儿分娩&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;性与生殖的关系&lt;/strong&gt;
3.1 性心理与性生理
3.2 性与生殖的关系
3.3 性与生殖障碍&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;性关系&lt;/strong&gt;
4.1 两性关系的起源与发展
4.2 各阶段两性关系的特点
4.3 健康性关系的建立要素&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;性与生殖健康的维护&lt;/strong&gt;
5.1 性与生殖健康的问题与挑战
5.2 性与生殖健康的维护&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;环境、精神心理、生活方式对生殖健康的影响&lt;/strong&gt;
6.1 环境因素对生殖健康的影响
6.2 精神心理因素对生殖健康的影响
6.3 生活方式对生殖健康的影响&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;现代辅助生殖技术的概念&lt;/strong&gt;
7.1 现代辅助生殖技术的起源
7.2 现代辅助生殖技术的目前开展情况
7.3 现代辅助生殖技术的伦理问题与挑战&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;性与生殖的未来&lt;/strong&gt;
8.1 克隆技术
8.2 生殖干细胞技术
8.3 性与生殖的未来展望&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h2&gt;简答复习&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;简答复习&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%ae%80%e7%ad%94%e5%a4%8d%e4%b9%a0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;描述男性与女性之间的性特征&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;描述男性与女性之间的性特征&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%8f%8f%e8%bf%b0%e7%94%b7%e6%80%a7%e4%b8%8e%e5%a5%b3%e6%80%a7%e4%b9%8b%e9%97%b4%e7%9a%84%e6%80%a7%e7%89%b9%e5%be%81&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;第一性征&lt;/strong&gt;: 男女&lt;strong&gt;生殖器&lt;/strong&gt;的不同。男性的生殖器包括阴茎、阴囊、生殖腺(睾丸) 、输精管道和附属腺；女性生殖器主要包括外阴、内阴、阴蒂、生殖腺(卵巢) 、子宫、阴道和附属腺。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;第二性征&lt;/strong&gt;: 指男女除了生殖器官以外的由&lt;strong&gt;性激素&lt;/strong&gt;不同导致的外貌特征区别。男性的第二性征主要表现为体格高大，肌肉发达，喉结突出，汗毛多而密，长胡须；女性的第二性征主要表现为皮下脂肪多，皮肤细腻，骨盆宽大，乳腺发达。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;男女性障碍和发生的原因是什么？&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;男女性障碍和发生的原因是什么&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%94%b7%e5%a5%b3%e6%80%a7%e9%9a%9c%e7%a2%8d%e5%92%8c%e5%8f%91%e7%94%9f%e7%9a%84%e5%8e%9f%e5%9b%a0%e6%98%af%e4%bb%80%e4%b9%88&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;男性性障碍&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;勃起功能障碍&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;原因&lt;/strong&gt;：心血管疾病、糖尿病、神经系统疾病、激素失衡、吸烟和酗酒、药物副作用（如抗抑郁药物）、心理因素（如压力、焦虑或抑郁）、关系问题。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;早泄&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;原因&lt;/strong&gt;：生理因素（如激素失衡、感染）、心理因素（如焦虑、过度兴奋）、神经过敏。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;性欲低下&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;原因&lt;/strong&gt;：慢性疾病、药物副作用、睾酮水平下降、心理因素（如抑郁、压力）、关系问题。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;女性性障碍&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;性欲缺乏和性兴趣减退&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;原因&lt;/strong&gt;：激素变化（如更年期、避孕药）、药物副作用、心理因素（如抑郁、压力）、身体健康问题、关系问题。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;性交疼痛&lt;/strong&gt;（如阴道痉挛）：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;原因&lt;/strong&gt;：身体原因（如感染、阴道干涩）、心理因素（如性创伤、焦虑）、关系问题。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;性唤起障碍&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;原因&lt;/strong&gt;：血液循环问题、神经系统问题、药物副作用、心理和情感问题。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;共性的心理和社会因素&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;心理因素&lt;/strong&gt;：包括焦虑、抑郁、性创伤、性压力、性功能焦虑、身体形象问题。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;关系问题&lt;/strong&gt;：沟通不良、情感疏远、信任问题或冲突。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;社会和文化因素&lt;/strong&gt;：性教育缺乏、文化背景中对性的负面态度、社会压力。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;共性的生理因素&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;慢性疾病&lt;/strong&gt;：心血管疾病、糖尿病、神经疾病。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;药物副作用&lt;/strong&gt;：某些抗抑郁药、高血压药、避孕药等。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;激素失衡&lt;/strong&gt;：包括性激素水平变化。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;性心理是如何形成的？&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;性心理是如何形成的&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%80%a7%e5%bf%83%e7%90%86%e6%98%af%e5%a6%82%e4%bd%95%e5%bd%a2%e6%88%90%e7%9a%84&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;性心理的形成是一个复杂的过程，受到多种因素的影响，包括生理、教育和社会因素。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;生理基础&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;遗传因素&lt;/strong&gt;：人的性心理特质中有部分是由遗传决定的，比如性别身份的基本感知和性取向的某些方面。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;生理发展&lt;/strong&gt;：从出生到成年，人的性器官和内分泌系统（特别是性激素）的发展对性心理有重要影响。青春期的生理变化尤其关键，它们会激发性欲望和性身份的形成。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;教育&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;家庭教育&lt;/strong&gt;：父母和家庭成员对性的态度和行为模式会深刻影响个体的性心理发展。例如，开放和健康的家庭性教育可以促进个体形成积极的性观念。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;学校教育&lt;/strong&gt;：学校中的性教育课程同样重要，它帮助青少年理解生理变化，认识到性健康和性权利的重要性。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;社会基础&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;文化因素&lt;/strong&gt;：不同的文化对性有不同的看法和规范，这些文化差异会显著影响个体的性心理形成。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;社会互动&lt;/strong&gt;：与同伴、伴侣的交往，社会媒体和其他媒体的影响也在塑造个人的性心理方面发挥着作用。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;综上所述，性心理的形成是一个多方面互动的结果，涉及个体的生理发展、教育背景以及社会文化环境。良好的性心理健康需要个体在这些方面都得到健康和平衡的发展。&lt;/p&gt;
&lt;h3&gt;你认为性与生殖之间是怎样的关系？&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;你认为性与生殖之间是怎样的关系&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%bd%a0%e8%ae%a4%e4%b8%ba%e6%80%a7%e4%b8%8e%e7%94%9f%e6%ae%96%e4%b9%8b%e9%97%b4%e6%98%af%e6%80%8e%e6%a0%b7%e7%9a%84%e5%85%b3%e7%b3%bb&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;性与生殖之间的关系是深刻且复杂的，可以从不同的角度进行探讨：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;生物学角度&lt;/strong&gt;：性行为是许多生物体（包括人类）的生殖过程的一部分，主要目的是传递遗传信息。从进化角度看，性繁殖允许基因的混合和多样性，利于物种适应和进化。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;社会和文化角度&lt;/strong&gt;：在人类社会中，性不仅仅是生殖的工具，也是表达爱、亲密和情感联系的方式。文化、宗教和个人信仰在定义性与生殖关系方面也起着重要作用。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;心理和情感角度&lt;/strong&gt;：性行为在心理层面上承载着多重意义，包括爱、情感的交流、信任和快乐等，这些方面往往与生殖的生物学目的相独立。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;健康和生理角度&lt;/strong&gt;：性行为对于个体的身心健康是有益的，它不仅带来生理快感，还能增进情感上的亲密和满足感。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;总的来说，性与生殖虽然在生物学上紧密相关，但在人类社会中，性的意义远远超出了生殖的范畴。&lt;/p&gt;
&lt;h3&gt;产生早恋的原因？如何看待早恋？&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;产生早恋的原因如何看待早恋&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%ba%a7%e7%94%9f%e6%97%a9%e6%81%8b%e7%9a%84%e5%8e%9f%e5%9b%a0%e5%a6%82%e4%bd%95%e7%9c%8b%e5%be%85%e6%97%a9%e6%81%8b&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;早恋，即青少年时期的早期恋爱，其产生的原因多样且复杂：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;生理成熟&lt;/strong&gt;：青春期的生理变化导致性激素水平上升，促进了性意识和对异性的兴趣。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;心理发展&lt;/strong&gt;：青少年期是个体探索自我、建立个人身份的阶段，恋爱被视为成长的一部分。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;社会和文化因素&lt;/strong&gt;：媒体和流行文化对恋爱的浪漫化，以及社交媒体的影响。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;家庭影响&lt;/strong&gt;：过度保护或疏远的家庭环境可能促使青少年通过早恋寻求情感支持。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;同伴压力&lt;/strong&gt;：在某些社交圈中，恋爱可能被视为成熟或受欢迎的标志。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;对待早恋的态度应当是理解和平衡的&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;理解和尊重&lt;/strong&gt;：理解青少年的感受和需求，尊重他们的个人发展过程。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;引导和教育&lt;/strong&gt;：提供适当的性教育和情感教育，帮助青少年理解恋爱关系的责任和界限。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;沟通和支持&lt;/strong&gt;：家长和教育工作者应该与青少年保持开放的沟通，提供指导和支持。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;关注和干预&lt;/strong&gt;：如果早恋影响了学习或生活，或者存在不健康的关系模式，则应及时干预。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;人类生命的起点是受精卵还是新生命诞生之日？为什么？&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;人类生命的起点是受精卵还是新生命诞生之日为什么&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%ba%ba%e7%b1%bb%e7%94%9f%e5%91%bd%e7%9a%84%e8%b5%b7%e7%82%b9%e6%98%af%e5%8f%97%e7%b2%be%e5%8d%b5%e8%bf%98%e6%98%af%e6%96%b0%e7%94%9f%e5%91%bd%e8%af%9e%e7%94%9f%e4%b9%8b%e6%97%a5%e4%b8%ba%e4%bb%80%e4%b9%88&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;这是一个哲学、科学、宗教和伦理学的复杂议题，不同领域有不同观点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;生物学观点&lt;/strong&gt;：生命的起点通常被认为是&lt;strong&gt;受精&lt;/strong&gt;时刻，即精子和卵子结合形成受精卵的时刻。此刻起，受精卵拥有独特的遗传物质，开始了连续的生长和发展。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;发育生物学观点&lt;/strong&gt;：强调从受精到出生的整个连续过程，认为生命是一个逐步形成的过程。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;伦理和法律观点&lt;/strong&gt;：不同的文化、宗教和法律体系对生命起点的定义各不相同。一些认为始于受精，另一些则可能认为始于胎儿具有独立生存能力的某个阶段，或直到出生。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;个人和文化观点&lt;/strong&gt;：个人的信仰、文化背景和哲学观念也会影响对这个问题的看法。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;生殖障碍主要由女方引起, 是否正确?&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;生殖障碍主要由女方引起-是否正确&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%94%9f%e6%ae%96%e9%9a%9c%e7%a2%8d%e4%b8%bb%e8%a6%81%e7%94%b1%e5%a5%b3%e6%96%b9%e5%bc%95%e8%b5%b7-%e6%98%af%e5%90%a6%e6%ad%a3%e7%a1%ae&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;不正确&lt;/strong&gt;。生殖障碍不是主要由女方引起。实际上，生殖障碍可能由男性、女性或双方因素引起，甚至有些情况下原因不明确。原因大致归类为：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;男性因素&lt;/strong&gt;：比如精子质量不佳、精子数量减少、性功能障碍等。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;女性因素&lt;/strong&gt;：如排卵障碍、子宫或输卵管的问题、激素失衡等。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;双方因素&lt;/strong&gt;：包括免疫学因素、性交问题等。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;不明原因&lt;/strong&gt;：在一些情况下，尽管进行了全面的检查，仍然无法确定具体原因。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;性障碍的影响因素有哪些？&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;性障碍的影响因素有哪些&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%80%a7%e9%9a%9c%e7%a2%8d%e7%9a%84%e5%bd%b1%e5%93%8d%e5%9b%a0%e7%b4%a0%e6%9c%89%e5%93%aa%e4%ba%9b&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;性障碍的影响因素多样，可以从生理、心理和社会环境几个方面来考虑：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;生理因素&lt;/strong&gt;：包括荷尔蒙失衡、疾病（如糖尿病、高血压）、药物副作用、酒精或药物滥用以及年龄等。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;心理因素&lt;/strong&gt;：情感问题、压力、焦虑、抑郁、性身份困扰、性史问题（如性虐待经历）等都可能影响性功能。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;社会和文化因素&lt;/strong&gt;：包括性教育的缺乏、文化和宗教信仰、社会对性的态度和预期等。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;人际关系因素&lt;/strong&gt;：伴侣之间的沟通问题、情感疏远、信任问题或其他关系冲突也可能导致性障碍。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;哪些不良的生活方式会损害性健康和生殖健康？&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;哪些不良的生活方式会损害性健康和生殖健康&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%93%aa%e4%ba%9b%e4%b8%8d%e8%89%af%e7%9a%84%e7%94%9f%e6%b4%bb%e6%96%b9%e5%bc%8f%e4%bc%9a%e6%8d%9f%e5%ae%b3%e6%80%a7%e5%81%a5%e5%ba%b7%e5%92%8c%e7%94%9f%e6%ae%96%e5%81%a5%e5%ba%b7&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;不良生活方式&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;不健康的饮食&lt;/strong&gt;：过多摄入高脂肪、高糖或加工食品。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;吸烟和酗酒&lt;/strong&gt;：吸烟与勃起功能障碍、精子质量下降相关；过量饮酒可能导致性欲降低。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;药物滥用&lt;/strong&gt;：某些非法药物和处方药可能影响性功能和生殖能力。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;缺乏运动&lt;/strong&gt;：与多种健康问题相关，包括性健康问题。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;压力和精神压力&lt;/strong&gt;：长期的压力和焦虑可能影响性欲和生殖健康。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;不良睡眠习惯&lt;/strong&gt;：睡眠不足或质量差可能影响性激素的产生。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;日常护理注意事项&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;均衡饮食&lt;/strong&gt;：保持营养均衡。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;规律运动&lt;/strong&gt;：维持健康的体重和良好的血液循环。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;戒烟限酒&lt;/strong&gt;：避免或减少烟酒摄入。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;管理压力&lt;/strong&gt;：学习压力管理技巧，如冥想、瑜伽等。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;保证充足睡眠&lt;/strong&gt;：保持良好的睡眠习惯。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;定期健康检查&lt;/strong&gt;：定期进行健康检查，特别是生殖健康检查。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;安全性行为&lt;/strong&gt;：采取措施预防性传播疾病和意外怀孕。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;辅助生殖技术（ART）对传统两性关系的影响&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;辅助生殖技术art对传统两性关系的影响&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%be%85%e5%8a%a9%e7%94%9f%e6%ae%96%e6%8a%80%e6%9c%afart%e5%af%b9%e4%bc%a0%e7%bb%9f%e4%b8%a4%e6%80%a7%e5%85%b3%e7%b3%bb%e7%9a%84%e5%bd%b1%e5%93%8d&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;夫妻之间是否还需要性生活？&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;需要&lt;/strong&gt;。即使在ART广泛应用的背景下，性生活仍然是夫妻情感交流、身体和心理满足的重要方式，是维持亲密关系和个人健康的重要部分。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;婚姻是否还与性别有关？&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;关联性正在&lt;strong&gt;减弱&lt;/strong&gt;。随着同性婚姻的合法化和性别观念的变化，婚姻越来越多地被视为基于爱和承诺的关系。ART的发展为不同性别组合的伴侣提供了生育可能，进一步淡化了婚姻与传统性别角色的关联。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;是否可以挑选、定制后代？&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;技术上部分可行，但引发巨大伦理争议&lt;/strong&gt;。ART如基因筛选提供了一定程度上选择后代遗传特征的可能性，但这引发了深刻的伦理和道德问题。关于“定制婴儿”的技术和法律限制因国家和地区而异。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;男女能实现性别平等吗？&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;技术有助推作用，但平等是系统工程&lt;/strong&gt;。ART在一定程度上帮助平衡了因生理差异导致的性别不平等。然而，性别平等的实现不仅仅是技术问题，还涉及到社会文化、教育、法律等多个方面的深刻变革。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2&gt;选择复习&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;选择复习&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e9%80%89%e6%8b%a9%e5%a4%8d%e4%b9%a0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;男女基本生殖知识&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;男女基本生殖知识&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%94%b7%e5%a5%b3%e5%9f%ba%e6%9c%ac%e7%94%9f%e6%ae%96%e7%9f%a5%e8%af%86&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
什么是精子发生？
A. 精子细胞转化为精子的过程【错误】
B. 精原细胞形成精子的过程【正确】
C. 初级精细胞形成精子的过程【错误】
D. 精原细胞的减数分裂过程【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
精子主要储存在
A. 输精管和附睾【正确】
B. 睾丸【错误】
C. 前列腺【错误】
D. 精囊【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
以下哪种细胞分泌雄激素？
A. 精原细胞【错误】
B. 间质细胞【正确】
C. 陶特细胞【错误】
D. 精子【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
卵巢产生的激素是
A. 雌激素，孕酮【错误】
B. 孕酮，甲状腺素【错误】
C. 雌激素，促黄体激素【错误】
D. 雌激素，孕酮，雄激素【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
以下哪项陈述是正确的
A. 阴道是女性的性交器官【正确】
B. 阴道是女性的勃起器官【错误】
C. 男性有勃起器官而女性没有【错误】
D. 阴蒂是女性的性交器官【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
以下哪项陈述不属于更年期过渡期的表现
A. 骨质疏松【错误】
B. 易怒【错误】
C. 性欲消失【正确】
D. 经期紊乱【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
以下哪项陈述是正确的
A. 性欲从青春期开始【错误】
B. 更年期过渡期的女性不会产生性兴奋【错误】
C. 高性欲期是生育期【正确】
D. 乳房成熟是青春期的重要信号【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
精子和卵子在哪里相遇
A. 阴道【错误】
B. 子宫腔【错误】
C. 子宫颈【错误】
D. 输卵管【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
阴茎勃起的类型包括
A. 心理性勃起【正确】
B. 反射性勃起【正确】
C. 夜间勃起【正确】
D. 早晨勃起【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
阴茎勃起的三个要素是
A. 海绵体平滑肌的放松【正确】
B. 阴茎动脉血流增加【正确】
C. 静脉堵塞【正确】
D. 海绵体血管窦的收缩【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
以下哪些是女性内生殖器
A. 子宫【正确】
B. 大阴唇【错误】
C. 阴道【正确】
D. 子宫颈【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
以下哪些因素有助于受精
A. 女性在排卵前后性欲最高【正确】
B. 男性正常射精【正确】
C. 女性正常排卵【正确】
D. 正常性生活【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
以下哪些是女性的生理阶段
A. 胎儿期【正确】
B. 青春期【正确】
C. 成熟期【正确】
D. 新生儿期【正确】&lt;/p&gt;
&lt;h3&gt;受精与妊娠&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;受精与妊娠&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e5%8f%97%e7%b2%be%e4%b8%8e%e5%a6%8a%e5%a8%a0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
关于受精位置的正确陈述是哪一个？
A. 输卵管伞部【错误】
B. 输卵管峡部和间质部的交界处【错误】
C. 输卵管间质部【错误】
D. 输卵管峡部和壶腹部的交界处【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
关于威胁性流产的以下哪个陈述是错误的？
A. 规律性子宫收缩【正确】
B. 宫颈管变平【正确】
C. 宫颈扩张【错误】
D. 出血【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
精子激活发生在哪里？
A. 子宫腔和输卵管【正确】
B. 输卵管峡部和间质部的交界处【错误】
C. 输卵管间质部【错误】
D. 宫颈【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
足月婴儿的定义是什么？
A. 出生于28&lt;del&gt;36周的婴儿【错误】
B. 出生于37&lt;/del&gt;41+6周的婴儿【正确】
C. 出生于28&lt;del&gt;38周的婴儿【错误】
D. 出生于26&lt;/del&gt;36+6周的婴儿【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
越期妊娠的定义是什么？
A. 妊娠持续≥41周【错误】
B. 妊娠持续≥40周【错误】
C. 妊娠持续≥42周【正确】
D. 妊娠持续≥39周【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
初产妇无硬膜外麻醉的第二产程应不超过
A. 1小时【错误】
B. 2小时【错误】
C. 3小时【正确】
D. 1.5小时【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
威胁性流产中子宫收缩的特点是什么？
A. 收缩通常持续≥30秒，间隔5-6分钟【正确】
B. 收缩通常持续≥15秒，间隔3-5分钟【错误】
C. 收缩通常持续≥40秒，间隔3-4分钟【错误】
D. 收缩通常持续≥15秒，间隔3-4分钟【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
决定分娩的因素包括
A. 劳动力【正确】
B. 生产道【正确】
C. 胎儿【正确】
D. 社会/心理因素【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
第一孕期可能出现的症状包括
A. 绝经【正确】
B. 胃肠反应【正确】
C. 少尿【错误】
D. 蒙哥马利腺肿胀【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
胎盘在妊娠期间的功能包括
A. 呼吸，允许氧气和二氧化碳交换【正确】
B. 营养和排泄含氮废物【正确】
C. 防御，作为有效屏障【正确】
D. 合成胎儿血液【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;判断(2分)&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;受精指的是男女配子融合，形成一个具有父母遗传背景的新个体的过程。【正确】&lt;/li&gt;
&lt;li&gt;只有发生顶体反应的精子才能与次级卵母细胞融合。【正确】&lt;/li&gt;
&lt;li&gt;卵子在精子进入卵母细胞（受精）后完成第一次减数分裂并形成女性原核。【错误】&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;性与生殖的关系&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;性与生殖的关系&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%80%a7%e4%b8%8e%e7%94%9f%e6%ae%96%e7%9a%84%e5%85%b3%e7%b3%bb&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
儿童性心理发展的特点不包括
A. 意识不完全【错误】
B. 持续性【正确】
C. 短暂性【错误】
D. 不完整性【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
性心理学是基于性生理学的，与（ ）相关的心理状态和心理过程
A. 性伴侣，性特征【错误】
B. 性欲望，性特征，性行为【正确】
C. 性欲望，性伴侣【错误】
D. 性行为，性伴侣【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
世界卫生组织(WHO)说：性心理健康是通过（ ）实现生理、情感、智力和社会方面性行为的完善和协调
A. 人际交往和社会关系【错误】
B. 个性和社会关系【错误】
C. 爱的方式，人际交往和个性【正确】
D. 社会关系和个性【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
性欲望的基础是
A. 生殖器官成熟【错误】
B. 适宜的环境因素【错误】
C. 性需求【错误】
D. 性激素【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
最常见的男性性功能障碍是
A. 性无能和早泄【正确】
B. 无射精和逆行射精【错误】
C. 勃起功能障碍【错误】
D. 遗精【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
性高潮障碍是指在足够的性刺激和唤醒后持续或重复出现（ ），给患者带来痛苦
A. 延迟性高潮【错误】
B. 高潮困难【错误】
C. 没有性高潮【错误】
D. 上述三者都是【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
性心理因素的生理基础是
A. 嗅觉，视觉，触觉，听觉【正确】
B. 视觉，幻觉，触觉和听觉【错误】
C. 触觉，幻觉，听觉，视觉【错误】
D. 幻觉，嗅觉，视觉和触觉【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
青少年性心理的表现包括
A. 性别认同【正确】
B. 性取向【正确】
C. 性经验【正确】
D. 性身份【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
老年心理调整包括
A. 家庭中性别角色的调整【正确】
B. 性行为的调整【正确】
C. 消除性活动障碍【正确】
D. 单身老年人的性调整【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
女性性功能障碍包括
A. 缺乏性兴趣【正确】
B. 高潮障碍【正确】
C. 性行为痛苦或插入障碍【正确】
D. 性唤醒障碍【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
异常性欲包括
A. 性欲过强【正确】
B. 异常性欲【正确】
C. 性欲低下【正确】
D. 无性欲【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
受精的前提条件包括
A. 卵子成熟，精子成熟，精子激活【正确】
B. 精子数量和质量能使300-500个最强壮的精子到达壶腹部【正确】
C. 在排卵后48小时内相遇【错误】
D. 在排卵后24小时内相遇【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;判断(2分)&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;性变态包括生理变态和心理变态。【正确】&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;性关系&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;性关系&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%80%a7%e5%85%b3%e7%b3%bb&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
根据摩根的性别关系发展理论，家庭“经历几个连续发展阶段以成熟”的正确顺序是
A. 普纳鲁亚家庭、血缘家庭、配偶家庭、一夫一妻制家庭【错误】
B. 血缘家庭、普纳鲁亚家庭、配偶家庭、一夫一妻制家庭【正确】
C. 血缘家庭、配偶家庭、普纳鲁亚家庭、一夫一妻制家庭【错误】
D. 血缘家庭、配偶家庭、一夫一妻制家庭、普纳鲁亚家庭【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
集体婚姻的初始阶段是
A. 普纳鲁亚家庭【错误】
B. 血缘家庭【正确】
C. 配偶家庭【错误】
D. 一夫一妻制家庭【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
随着母系社会向父系社会的转变和私有制的出现，人类婚姻制度进入了以（ ）为基础的（ ）阶段，这是文明时代开始的标志之一。
A. 私有制、一夫一妻制【正确】
B. 私有制、一夫多妻制【错误】
C. 个体性别、一夫一妻制【错误】
D. 个体性别、一夫多妻制【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
现代医学将人类性生活定义为“由（ ）驱动，以（ ）结束，旨在给予和获得不同程度的性满足的一系列活动。”
A. 性欲望，皮肤【错误】
B. 性欲望，生殖器官【错误】
C. 大脑性中枢兴奋，皮肤【正确】
D. 大脑性中枢兴奋，生殖器官【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
爱情的本质基于（ ）需求，使人们能够获得稳定持久的强烈身体和心理愉悦。
A. 生理、心理、文化【错误】
B. 心理、社会、文化【错误】
C. 生理、社会、文化【错误】
D. 生理、心理、社会【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
人类性具有丰富的内涵。它不仅是人类生命的源泉，也是生活中不可或缺的一部分。人类性的功能包括
A. 幸福【正确】
B. 文化【错误】
C. 生育【正确】
D. 健康【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
性行为有其广义和狭义之分。广义上的性行为指为满足性欲望和获得性愉悦可以观察到的一系列行为和情感反应，包括
A. 性交【正确】
B. 自慰【正确】
C. 亲吻【正确】
D. 拥抱【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
性欲望只是淫欲的生理基础，并不等同于爱情。人类的性爱应该包括
A. 奉献【正确】
B. 责任【正确】
C. 尊重【正确】
D. 理解【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
心理学家认为性意识成熟的标志包括
A. 对男女关系有正确理解并了解性的本质、功能和社会责任【正确】
B. 以社会接受的方式表达性冲动和需求；正常追求异性并发展关系【正确】
C. 有规律的性情感和意识；根据社会伦理和法律要求主动控制性行为【正确】
D. 学习发现和探索性行为，包括同性和异性性行为【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
树立科学的爱情观，推崇志趣相投的爱情。在真爱的关系中，我们可以
A. 建立自己的价值观【正确】
B. 坚持自己的价值观【正确】
C. 强加于人自己所不愿【错误】
D. 履行承诺【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;判断(2分)&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;古代为了生存，人类必须“以群体的联合力量和集体行动弥补个体的不足”。任何性别之间的排他性都必将削弱这种联合力和集体行动，因此只有有序的性关系才能适应当时生活条件的客观需要。【正确】&lt;/li&gt;
&lt;li&gt;通过大脑引起的所有类型的性刺激属于性活动的范畴。亲密的身体接触是性活动的一种方式。【正确】&lt;/li&gt;
&lt;li&gt;成熟的爱是因为我需要你所以我爱你。【正确】&lt;/li&gt;
&lt;li&gt;由于爱情失败而自杀在大学生中排名第一，占比21.7%。【正确】&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;环境、精神心理、生活方式对生殖健康的影响&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;环境精神心理生活方式对生殖健康的影响&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%8e%af%e5%a2%83%e7%b2%be%e7%a5%9e%e5%bf%83%e7%90%86%e7%94%9f%e6%b4%bb%e6%96%b9%e5%bc%8f%e5%af%b9%e7%94%9f%e6%ae%96%e5%81%a5%e5%ba%b7%e7%9a%84%e5%bd%b1%e5%93%8d&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
()属于影响生殖健康的生物因素。
A. 高温环境【错误】
B. TORCH【正确】
C. 汞【错误】
D. 离子辐射【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
()对卵巢功能无害。
A. 接受腹腔化疗【错误】
B. 保持良好心情【正确】
C. 熬夜【错误】
D. 接受卵巢肿瘤手术【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
()是不健康的生活方式。
A. 熬夜【正确】
B. 早晨慢跑【错误】
C. 参加健康促进讲座【错误】
D. 远离烟草【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
()是健康的生活方式。
A. 熬夜玩游戏【错误】
B. 首次性行为&amp;lt; 16岁【错误】
C. 每天过量饮酒【错误】
D. 早晨慢跑【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
()是计算BMI的正确方法。
A. 体重(kg) / 身高(m) ^ 2【正确】
B. 体重(kg) ^ 2 / 身高(cm)【错误】
C. 体重(kg) / 身高(cm) ^ 2【错误】
D. 身高(m) / 体重(kg)【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
影响生殖健康的物理因素包括()
A. 重金属污染【正确】
B. 温度【正确】
C. 环境内分泌干扰物因素【正确】
D. 噪声【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
TORCH感染方式包括()
A. 食用生食(奶、蛋、肉)【正确】
B. 食用被猫粪便污染的水源(含有弓形虫卵囊)【正确】
C. 与动物密切接触【正确】
D. 食用被猫粪便污染的食物(含有弓形虫卵囊)【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
宫颈癌的主要原因包括()
A. HPV感染【正确】
B. 多个性伴侣【正确】
C. 多次妊娠和分娩【正确】
D. 首次性行为 &amp;lt; 16岁【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
高温的不良影响包括()
A. 降低精子活力【正确】
B. 阻碍精子发生【正确】
C. 降低精子密度【正确】
D. 影响精子数量【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
与生殖健康相关的药物类型包括()
A. 阿片类药物【正确】
B. 抗风湿药物【正确】
C. 抗肿瘤药物【正确】
D. 抗结核药物【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;判断(2分)&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;钢铁制造、焊接、烹饪、紧身裤、桑拿等高温条件会阻碍精子产生，导致精子数量减少。【正确】&lt;/li&gt;
&lt;li&gt;淋病、梅毒等可以对女性生殖道和器官造成极大伤害，不仅降低生活质量，还影响胎儿的生长。【正确】&lt;/li&gt;
&lt;li&gt;根据不同年龄青少年的生理特征，应开展性健康教育，以正确理解生理和身体变化，并引导他们树立正确的性和道德观念。【正确】&lt;/li&gt;
&lt;li&gt;精神疾病不是导致勃起功能障碍(ED)的常见原因。【错误】&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;性与生殖健康维护&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;性与生殖健康维护&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%80%a7%e4%b8%8e%e7%94%9f%e6%ae%96%e5%81%a5%e5%ba%b7%e7%bb%b4%e6%8a%a4&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
以下哪项是正确的性观念？
A. 老年人不需要性【错误】
B. 青少年性生活不需要避孕【错误】
C. 避孕套是安全有效的避孕方法【正确】
D. 女性一旦开始月经就可以进行性行为【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
关于性和生殖健康，以下哪项是错误的？
A. 没有性生活就没有妇科疾病【正确】
B. 计划怀孕时性交不使用避孕【错误】
C. 性行为基于双方同意【错误】
D. 首次性行为前应注射HPV疫苗【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
以下哪种疾病可以通过HPV疫苗预防？
A. 梅毒【错误】
B. 艾滋病【错误】
C. 生殖器疱疹【错误】
D. 宫颈癌【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
以下哪种方法是预防性传播感染，包括艾滋病的最有效方式？
A. 避孕药【错误】
B. 疫苗【错误】
C. 避孕套【正确】
D. 抗病毒药物【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
青少年比成人生殖健康风险更高的原因，除了
A. 自慰【正确】
B. 无保护性行为【错误】
C. 缺乏性知识【错误】
D. 性观念开放【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
以下哪项不是避孕措施？
A. 宫内节育器【错误】
B. 口服避孕药【错误】
C. 人工流产【正确】
D. 植入避孕器【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
产后不想要孩子的妇女，想使用IUD进行避孕，应告知的并发症，除了
A. 感染【错误】
B. 子宫穿孔【错误】
C. 异位IUDs【错误】
D. 血肿【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
以下哪种情况下的妇女可以使用口服避孕药以预防怀孕
A. 急性或慢性肝炎【错误】
B. 血栓性疾病【错误】
C. 哺乳期【错误】
D. 宫颈炎【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
以下哪种避孕方法最适合想要在六个月后怀孕的新婚夫妇？
A. 安全期避孕【错误】
B. 阴茎避孕套【正确】
C. 宫内节育器【错误】
D. 植入避孕器【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
在人工流产过程中，一位患者经历了腹痛、冷汗和血压下降，原因可能是
A. 人工流产综合征【正确】
B. 子宫穿孔【错误】
C. 出血性休克【错误】
D. 粗暴的手术操作【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
如果你是一位13岁女孩的母亲，她进入青春期时你应该如何教育她？
A. 注意保持阴道卫生【正确】
B. 经常更换内裤【正确】
C. 使用干净柔软的卫生用品并及时更换【正确】
D. 在月经期间避免游泳和沐浴，并适当锻炼【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
一个年轻健康的未婚女性想使用口服避孕药，建议包括
A. 黛安妈富隆【正确】
B. 美罗昂【正确】
C. 雅思明【正确】
D. 雅兹【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
一对不想要孩子的育龄夫妇，以下哪种避孕方法不推荐
A. 紧急避孕药【正确】
B. 植入避孕器【错误】
C. 安全期避孕【正确】
D. 体外射精【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
早期性行为或多性伴侣的风险有哪些？
A. 生殖道衣原体感染【正确】
B. 意外怀孕【正确】
C. HPV感染【正确】
D. 性观念开放【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
以下哪些群体容易感染艾滋病？
A. 有固定性伴侣的年轻人【错误】
B. 同性恋【正确】
C. 性工作者【正确】
D. 吸毒者【正确】&lt;/p&gt;
&lt;h3&gt;现代辅助生殖技术的概念&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;现代辅助生殖技术的概念&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e7%8e%b0%e4%bb%a3%e8%be%85%e5%8a%a9%e7%94%9f%e6%ae%96%e6%8a%80%e6%9c%af%e7%9a%84%e6%a6%82%e5%bf%b5&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
故意将精子引入女性的宫颈或子宫腔以实现怀孕的过程是()
A. 体外受精和胚胎移植 (IVF-ET)【错误】
B. 人工授精（AI）【正确】
C. 种植前遗传诊断 (PGD)【错误】
D. 胞浆内单精子注射(ICSI)【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
第二代体外受精指的是()
A. 胞浆内单精子注射 (ICSI)【正确】
B. 种植前遗传诊断 (PGD)【错误】
C. 人工授精【错误】
D. 体外受精 (IVF)【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
关于控制性卵巢超刺激，以下哪项是错误的()
A. 使用GnRH激动剂来增加卵泡数量【正确】
B. 自然周期只有一个成熟的卵子，因此成功率低【错误】
C. 排卵时间不固定，不容易取卵【错误】
D. 个体化的控制性卵巢超刺激包括长方案、短方案、拮抗剂方案、温和刺激方案等【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
罗伯逊易位的定义是()
A. 两个分离的端粒染色体的两个长臂丢失【错误】
B. 两个分离的端粒染色体的两个短臂融合，长臂丢失【错误】
C. 两个分离的中部着丝点染色体的两个长臂融合，短臂丢失【错误】
D. 两个分离的端粒染色体的两个长臂融合，短臂丢失【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
以下哪个不是X连锁隐性疾病()
A. 威尔逊病【正确】
B. 血友病A【错误】
C. 进行性肌肉萎缩症【错误】
D. 红-绿色盲【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
ICSI的主要适应症包括()
A. 严重男性不育症【正确】
B. 梗阻性无精子症【正确】
C. 使用传统IVF先前受精失败【正确】
D. 排卵功能障碍【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
传统IVF程序包括()
A. 使用促性腺激素刺激多个卵泡发育【正确】
B. 通过血液内分泌激素检测和B超监测卵泡发育【正确】
C. 当卵泡成熟时，注射绒毛膜促性腺激素以触发最终成熟【正确】
D. 36小时后，通过B超引导的穿刺进行成熟卵泡的获取【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
PGT的适应症包括（）
A. 染色体数目和结构异常患者【正确】
B. 具有染色体异常儿童或怀孕史【正确】
C. 高龄孕妇【正确】
D. HLA匹配，癌症易感基因携带者【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
以下关于遗传疾病的说法哪些是正确的？
A. 染色体平衡易位的携带者通常无表型，但生育时可能发生不育、流产和胎儿畸形【正确】
B. 遗传疾病患者必有家族史，不会出现新突变【错误】
C. X连锁隐性遗传病的致病基因位于X染色体上并且是显性的【错误】
D. 遗传疾病通过如微阵列和PCR等分子生物学技术在DNA分子层面进行诊断【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
根据不同的授精部位，人工授精可分为（）
A. 阴道内授精【正确】
B. 宫颈内授精【正确】
C. 子宫内授精【正确】
D. 丈夫精液人工授精【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;判断(2分)&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;在胚胎冷冻过程中，非渗透保护剂，如单糖、果糖等，分子量较大，无法进入细胞，没有明显的细胞毒性。因此，长时间暴露于高浓度的这类物质不会影响胚胎的正常代谢和发育潜力。【错误】&lt;/li&gt;
&lt;li&gt;线粒体DNA编码的基因突变会导致一系列母系遗传疾病。线粒体替换可以防止线粒体突变传给下一代。【正确】&lt;/li&gt;
&lt;li&gt;平衡染色体易位是指染色体的一部分断裂并重新附着在另一个位置的情况。【正确】&lt;/li&gt;
&lt;li&gt;遗传疾病是由染色体异常引起的疾病，不包括由基因突变引起的疾病。【错误】&lt;/li&gt;
&lt;li&gt;PGT是IVF的重要技术之一，也被称为第三代IVF，对阻断遗传疾病的传播非常重要。【正确】&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;性与生殖的未来&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;性与生殖的未来&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%80%a7%e4%b8%8e%e7%94%9f%e6%ae%96%e7%9a%84%e6%9c%aa%e6%9d%a5&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
以下哪种被分类为成体干细胞？
A. 生殖系干细胞【错误】
B. 间充质干细胞【错误】
C. 诱导多能干细胞【错误】
D. 胚胎干细胞【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
关于成体干细胞的以下陈述中哪个是错误的？
A. 多潜能性【错误】
B. 体外增殖能力【错误】
C. 移植后常见肿瘤发生【正确】
D. 组织和器官保持生长和衰减的动态平衡【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
以下哪种不是多能干细胞？
A. 诱导多能干细胞(iPSCs)【错误】
B. 胚胎干细胞【错误】
C. 胚胎生殖细胞【错误】
D. 毛囊干细胞【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单- 选(2分)&lt;/strong&gt;
出生后，女性卵巢中的原始卵泡数量随年龄的增加而()
A. 增加【错误】
B. 减少【正确】
C. 不变【错误】
D. 无关【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单选(2分)&lt;/strong&gt;
为了使干细胞技术尽快造福人类，我们应该做到的，除了()
A. 充分的基础研究【错误】
B. 足够的动物实验【错误】
C. 进行标准化临床试验【错误】
D. 早期临床应用【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
胚胎干细胞应用受限的原因是什么？
A. 胚胎干细胞来源有限【正确】
B. 伦理问题【正确】
C. 形成肿瘤的风险【正确】
D. 免疫排斥【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
干细胞治疗的原理是什么？
A. 修复受损的组织和细胞【正确】
B. 替换受损细胞【正确】
C. 刺激细胞再生【正确】
D. 免疫抑制【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
根据分化潜能，干细胞可分为
A. 全能干细胞【正确】
B. 多能干细胞【正确】
C. 单能干细胞【正确】
D. 成体干细胞【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
人工精子/卵细胞的主要争议包括
A. 高生物风险【正确】
B. “为人父母”概念受到攻击【正确】
C. 技术滥用【正确】
D. 昂贵【错误】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;多选(2分)&lt;/strong&gt;
根据发育阶段，干细胞可分为和
A. 全能干细胞【错误】
B. 胚胎干细胞【正确】
C. 单能干细胞【错误】
D. 成体干细胞【正确】&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;判断(2分)&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;诱导多能干细胞具有类似胚胎干细胞的全能性。【正确】&lt;/li&gt;
&lt;li&gt;卵巢组织中存在有分化成卵子潜能的生殖系干细胞。【正确】&lt;/li&gt;
&lt;li&gt;在特定条件下，成体干细胞可以产生新的干细胞或分化为新的功能性细胞，从而维持和修复它们所在的特定组织。【正确】&lt;/li&gt;
&lt;li&gt;诱导多能干细胞不涉及伦理问题，并且不存在肿瘤形成和免疫排斥的风险。【错误】&lt;/li&gt;
&lt;li&gt;IPSCs是一种单能干细胞，通过向人体细胞内引入一系列转录体并进行重编程获得。【错误】&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E6%96%B0%E5%86%9C%E7%A7%91%E5%AE%9E%E8%B7%B5-%E7%94%9F%E6%B4%BB%E5%9B%AD%E8%89%BA/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E6%96%B0%E5%86%9C%E7%A7%91%E5%AE%9E%E8%B7%B5-%E7%94%9F%E6%B4%BB%E5%9B%AD%E8%89%BA/</guid>
      <description>
        
        
        &lt;h1&gt;新农科实践-生活园艺&lt;/h1&gt;&lt;h2&gt;课程论文&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;课程论文&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%af%be%e7%a8%8b%e8%ae%ba%e6%96%87&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;课程号&lt;/strong&gt;：&lt;strong&gt;(2023-2024-1)-1617N007-0093229-1&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;开课学院&lt;/strong&gt;： &lt;strong&gt;农学院&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;提交日期&lt;/strong&gt;：&lt;strong&gt;2023&lt;/strong&gt;年 &lt;strong&gt;11&lt;/strong&gt; 月 &lt;strong&gt;5&lt;/strong&gt; 日&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;&lt;/th&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;strong&gt;得分&lt;/strong&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;strong&gt;评语&lt;/strong&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;strong&gt;评卷人&lt;/strong&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;课程论文的任务要求（选题范围、格式要求、评分标准等）：&lt;/strong&gt;&lt;/p&gt;

&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;论文包括中文标题、摘要、关键词、正文、参考文献等；&lt;/li&gt;
&lt;li&gt;正文字数：3000字以上，或根据任课教师要求；&lt;/li&gt;
&lt;li&gt;论文字体：仿宋(小四号)；&lt;/li&gt;
&lt;li&gt;论文行距：1.5倍；&lt;/li&gt;
&lt;li&gt;论文页边距：左右2.5厘米；&lt;/li&gt;
&lt;li&gt;论文层次的编号采用1, 1.1, 1.1.1；2, 2.1, 2.1.1的形式；&lt;/li&gt;
&lt;li&gt;参考文献一律用阿拉伯数字分别依序连续编排序号，同时在文中相应处用右上标标出，如&lt;code&gt;&amp;lt;sup&amp;gt;[1]&amp;lt;/sup&amp;gt;&lt;/code&gt;、&lt;code&gt;&amp;lt;sup&amp;gt;[2]&amp;lt;/sup&amp;gt;&lt;/code&gt;等&lt;/li&gt;
&lt;li&gt;参考文献格式如下：
&lt;blockquote&gt;
  &lt;p&gt;[1] 陈怀满, 郑荣春, 周东美. 关于我国土壤环境保护研究中一些值得关注的问题[J]. 农业环境科学学报, 2004(6): 1244-1245.&lt;/p&gt;
&lt;p&gt;[2] Zhang HZ, Luo YM, Xia JQ. Some thoughts of the comparison of risk based soil environmental standards between different countries[J]. Environmental Science, 2011, 32(3): 795-802.&lt;/p&gt;

&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h1&gt;生物医学工程在园艺治疗中的应用&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;摘要&lt;/strong&gt;: 本文探讨了生物医学工程技术在医院园艺治疗应用中的可能应用，从园艺疗法的历史和现代价值出发，详细讨论了花卉和植物在改善患者生理和心理状态方面的重要作用，同时突出了生物医学工程技术在精确监测和评估这些效应方面的关键作用。通过结合计算机视觉和生理信号传感器的数据来指导园艺环境的设计和选择，从而设计提高病患的参与度和治疗效果。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;关键词&lt;/strong&gt;: 生物医学工程; 园艺疗法；病患互动；治疗环境设计；个性化医疗&lt;/p&gt;
&lt;h2&gt;1 园艺疗法的定义与历史&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;1-园艺疗法的定义与历史&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#1-%e5%9b%ad%e8%89%ba%e7%96%97%e6%b3%95%e7%9a%84%e5%ae%9a%e4%b9%89%e4%b8%8e%e5%8e%86%e5%8f%b2&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;1.1 园艺疗法的起源和发展&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;11-园艺疗法的起源和发展&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#11-%e5%9b%ad%e8%89%ba%e7%96%97%e6%b3%95%e7%9a%84%e8%b5%b7%e6%ba%90%e5%92%8c%e5%8f%91%e5%b1%95&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;园艺疗法，或称为康复园艺，是一种利用园艺活动进行身心康复的疗法。它的起源可以追溯到古代文明，当时人们认识到与大自然的互动对人的健康有着积极的影响。&lt;/p&gt;
&lt;p&gt;进入19世纪，园艺疗法开始在医疗体系中得到正式的认可，被用于帮助受伤士兵的物理和心理康复。20世纪70年代，随着西方国家医学核心焦点从疾病向健康的转变，园艺疗法逐渐兴盛起来，通过利用植物栽培与园艺操作帮助人舒缓情绪、激发动力，改善体能和运动协调，同时治疗心理障碍，增加社会联系和道德感的价值&lt;sup&gt;[1]&lt;/sup&gt;。&lt;/p&gt;
&lt;h3&gt;1.2 现代园艺疗法的价值与意义&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;12-现代园艺疗法的价值与意义&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#12-%e7%8e%b0%e4%bb%a3%e5%9b%ad%e8%89%ba%e7%96%97%e6%b3%95%e7%9a%84%e4%bb%b7%e5%80%bc%e4%b8%8e%e6%84%8f%e4%b9%89&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;在现代社会，园艺疗法被认为是一种整合性治疗方法，不仅关注身体健康，也关注心理和社会福祉。&lt;/p&gt;
&lt;p&gt;对于病人来说, 由于客观存在的缺陷, 他们与植物的关系被切断。然而生物本身是有变化的, 这些变化带给人们平静。有的人在长期与病魔做斗争的过程中, 突然发现窗外的植物在摇晃或发芽时, 看到了自然的丰富性和生命的喜悦, 从而获得了生活的力量&lt;sup&gt;[2]&lt;/sup&gt;。&lt;/p&gt;
&lt;p&gt;研究表明，园艺疗法可以降低压力水平，改善情绪状态，增加自我效能感，并促进社会交往。&lt;/p&gt;
&lt;h3&gt;1.3 园艺疗法与病患的互动重要性&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;13-园艺疗法与病患的互动重要性&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#13-%e5%9b%ad%e8%89%ba%e7%96%97%e6%b3%95%e4%b8%8e%e7%97%85%e6%82%a3%e7%9a%84%e4%ba%92%e5%8a%a8%e9%87%8d%e8%a6%81%e6%80%a7&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;与园艺环境的互动是园艺疗法成功的关键。患者通过播种、浇水、修剪和收获等活动，不仅能够感受到生命的成长和变化，也在无形中加强了自己对健康的掌控感。更重要的是，这种互动促使患者转移焦点，从疾病的负面影响中解脱出来，找到积极面对生活的动力。此外，通过与植物的互动，患者可以重新建立与周围世界的联系，这对于身处孤立环境的患者来说尤为重要。&lt;/p&gt;
&lt;p&gt;
    &lt;img src=&#34;.././media/%e6%96%b0%e5%86%9c%e7%a7%91%e5%ae%9e%e8%b7%b5/image1.png&#34; alt=&#34;园艺活动中感觉体验和动作体验的相互作用&#34;  loading=&#34;lazy&#34; /&gt;
&lt;em&gt;图1 园艺活动中感觉体验和动作体验的相互作用&lt;/em&gt;&lt;/p&gt;
&lt;h2&gt;2 绿色设计的生理与心理效应&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;2-绿色设计的生理与心理效应&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#2-%e7%bb%bf%e8%89%b2%e8%ae%be%e8%ae%a1%e7%9a%84%e7%94%9f%e7%90%86%e4%b8%8e%e5%bf%83%e7%90%86%e6%95%88%e5%ba%94&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;2.1 花卉、植物和颜色对病患情绪和生理状态的影响&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;21-花卉植物和颜色对病患情绪和生理状态的影响&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#21-%e8%8a%b1%e5%8d%89%e6%a4%8d%e7%89%a9%e5%92%8c%e9%a2%9c%e8%89%b2%e5%af%b9%e7%97%85%e6%82%a3%e6%83%85%e7%bb%aa%e5%92%8c%e7%94%9f%e7%90%86%e7%8a%b6%e6%80%81%e7%9a%84%e5%bd%b1%e5%93%8d&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;花卉和植物自古以来就被用作提升心情和改善生理状态的天然治疗剂。现代研究也证实了这一点，指出特定的植物和花卉，如薰衣草和玫瑰，能够降低心率，减缓呼吸速率，从而减轻压力和焦虑。&lt;/p&gt;
&lt;p&gt;通过刺激人体包括视觉、嗅觉、听觉、味觉和触觉的五感以及园艺手作活动是植物在园艺疗法中作用于人体而达到积极治疗效果的主要方式。五感花园通过五感作用进而调节人体身心健康，分为视觉花园、嗅觉花园、听觉花园、味觉花园和触觉花园。&lt;/p&gt;
&lt;p&gt;
    &lt;img src=&#34;.././media/%e6%96%b0%e5%86%9c%e7%a7%91%e5%ae%9e%e8%b7%b5/image2.jpeg&#34; alt=&#34;常见植物颜色的心理效应&#34;  loading=&#34;lazy&#34; /&gt;
&lt;em&gt;图2 常见植物颜色的心理效应&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;这里以视觉花园举例，如红色花卉如木瓜海棠、红掌等能增进人的食欲；赭色的花卉如鸡冠花、大丽花等可稳定低血压患者的血压；花卉的绿叶使人产生舒适的感觉，可解除焦虑，舒畅心情&lt;sup&gt;[3]&lt;/sup&gt;。&lt;/p&gt;
&lt;p&gt;植物的气味、色彩以及整体的观感可以影响病患的内分泌系统，导致激素如皮质醇的水平变化，进而影响情绪状态。同时，植物通过释放负离子和净化空气的方式，改善环境质量，对患者的呼吸健康产生积极作用。&lt;/p&gt;
&lt;h3&gt;2.2 选择适当的园艺环境提升疗效&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;22-选择适当的园艺环境提升疗效&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#22-%e9%80%89%e6%8b%a9%e9%80%82%e5%bd%93%e7%9a%84%e5%9b%ad%e8%89%ba%e7%8e%af%e5%a2%83%e6%8f%90%e5%8d%87%e7%96%97%e6%95%88&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;选择合适的园艺环境对于疗效的提升至关重要。在设计园艺疗法环境时，应当综合考虑患者的具体需求、病状以及个人偏好。对于生理上需要恢复和放松的患者，使用色彩柔和、结构简单、维护要求低的植物和花卉。而对于需要情绪激励和心理刺激的患者，则可以选择色彩鲜明、花香浓郁的品种。&lt;/p&gt;
&lt;p&gt;
    &lt;img src=&#34;.././media/%e6%96%b0%e5%86%9c%e7%a7%91%e5%ae%9e%e8%b7%b5/image3.png&#34; alt=&#34;花卉园艺活动&#34;  loading=&#34;lazy&#34; /&gt;
&lt;em&gt;图3 花卉园艺活动(花卉创意栽培、干花书签制作)&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;此外，可以根据病房的光线条件、空间大小以及患者的活动能力，进行植物种类和布置方式的个性化选择。例如，对于光线不足的病房，可以选择耐阴植物；而对于有轮椅患者的病房，则应确保植物布置不会阻碍行动。&lt;/p&gt;
&lt;p&gt;在选择过程中，还应注意植物的安全性和无过敏反应。所有的园艺环境都应该定期进行维护，以保持其美观及疗效。&lt;/p&gt;
&lt;h2&gt;3 生物医学工程技术的应用&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;3-生物医学工程技术的应用&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#3-%e7%94%9f%e7%89%a9%e5%8c%bb%e5%ad%a6%e5%b7%a5%e7%a8%8b%e6%8a%80%e6%9c%af%e7%9a%84%e5%ba%94%e7%94%a8&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;生物医学工程作为一个工科专业，运用工程学的技术和手段，结合生物学知识，为人类的健康服务和为疾病的防治提供依据，最终解决医学问题&lt;sup&gt;[4]&lt;/sup&gt;。但是在这里，我们可以更多的运用医疗器械的工科技术手段，来为园艺治疗的疗效提供更为精确的判断。&lt;/p&gt;
&lt;h3&gt;3.1 功能磁共振成像：监测病患的行为和表情&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;31-功能磁共振成像监测病患的行为和表情&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#31-%e5%8a%9f%e8%83%bd%e7%a3%81%e5%85%b1%e6%8c%af%e6%88%90%e5%83%8f%e7%9b%91%e6%b5%8b%e7%97%85%e6%82%a3%e7%9a%84%e8%a1%8c%e4%b8%ba%e5%92%8c%e8%a1%a8%e6%83%85&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;生物医学工程的一项重要应用是利用功能磁共振成像(functional magnetic resonance imaging,f MRI)技术来监测和评估病患的行为和表情。现阶段研究发现面部表情的加工过程主要与以下结构有关:视觉皮质(梭状回、枕叶的内侧及下方、舌回),边缘结构(杏仁核、海马、后扣带回),颞叶,颞顶区(顶叶、颞中回、岛叶),额叶,皮质下区(壳核)以及小脑&lt;sup&gt;[5]&lt;/sup&gt;。因此，我们可以通过分析病患与园艺环境互动时的面部表情和身体语言来评价情绪状态和舒适度。该种系统可以安装在病房内，实时收集数据，通过机器学习算法分析病患的微表情和动作，以判断其情绪变化。&lt;/p&gt;
&lt;p&gt;这类技术的应用不仅能够帮助医疗人员了解患者在接触不同类型的植物时的心理变化，还可以监测长期趋势，从而调整治疗方案，使园艺疗法更加个性化和精确。&lt;/p&gt;
&lt;h3&gt;3.2 生理信号传感器：监测园艺环境中的生理响应&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;32-生理信号传感器监测园艺环境中的生理响应&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#32-%e7%94%9f%e7%90%86%e4%bf%a1%e5%8f%b7%e4%bc%a0%e6%84%9f%e5%99%a8%e7%9b%91%e6%b5%8b%e5%9b%ad%e8%89%ba%e7%8e%af%e5%a2%83%e4%b8%ad%e7%9a%84%e7%94%9f%e7%90%86%e5%93%8d%e5%ba%94&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;生理信号传感器如心电图(ECG)、心率变异性(HRV)和皮肤电导率(GSR)是生物医学工程中常用的工具，它们能够提供有关病患生理状态的详尽信息。在园艺疗法中，这些传感器可以用来监测患者在接受治疗前后的生理变化。&lt;/p&gt;
&lt;p&gt;通过ECG监测心率和节律，可以评估病患对园艺环境的心脏反应；HRV是反映压力水平和自主神经系统活动的重要指标；而GSR可以显示出患者的情绪激动程度。将这些传感器的数据进行综合分析，可以为病患提供更加定制化的园艺疗法方案，例如，当监测到某种植物使患者的生理指标变得更加稳定时，可以将此类植物更多地集成到病患的环境中。&lt;/p&gt;
&lt;h2&gt;4 园艺环境的设计与选择&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;4-园艺环境的设计与选择&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#4-%e5%9b%ad%e8%89%ba%e7%8e%af%e5%a2%83%e7%9a%84%e8%ae%be%e8%ae%a1%e4%b8%8e%e9%80%89%e6%8b%a9&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;在建立了植物和颜色对病人心理和生理影响的基础，并通过生物医学工程技术精确监测了病人的反应之后，我们的重点转向如何根据所收集到的数据来设计和选择最适合的园艺环境。这涉及到综合患者的生理和心理需求，以及他们与环境的互动反应，来创建一个有助于恢复和治疗的空间。&lt;/p&gt;
&lt;h3&gt;4.1 基于病患的需求和反应的园艺作物选择&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;41-基于病患的需求和反应的园艺作物选择&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#41-%e5%9f%ba%e4%ba%8e%e7%97%85%e6%82%a3%e7%9a%84%e9%9c%80%e6%b1%82%e5%92%8c%e5%8f%8d%e5%ba%94%e7%9a%84%e5%9b%ad%e8%89%ba%e4%bd%9c%e7%89%a9%e9%80%89%e6%8b%a9&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;园艺环境的设计应以病患的需求为中心。选择园艺作物时，需要考虑植物的香气、大小、维护要求以及它们所能带来的心理和生理上的益处。生物医学工程可以通过分析患者的反应数据，为每位患者推荐适宜的植物类型。&lt;/p&gt;
&lt;p&gt;
    &lt;img src=&#34;.././media/%e6%96%b0%e5%86%9c%e7%a7%91%e5%ae%9e%e8%b7%b5/image4.jpeg&#34; alt=&#34;病房内可选的观赏植物&#34;  loading=&#34;lazy&#34; /&gt;
&lt;em&gt;图4 病房内可选的观赏植物&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;这种个性化的方法能够确保植物的选择最大限度地符合患者的治疗需求，如选择能够带来镇静效果的植物为失眠患者服务，或是挑选能够激发感官刺激的植物帮助促进神经系统疾病患者的康复&lt;sup&gt;[6]&lt;/sup&gt;。&lt;/p&gt;
&lt;h3&gt;4.2 植物形态与颜色的综合应用&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;42-植物形态与颜色的综合应用&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#42-%e6%a4%8d%e7%89%a9%e5%bd%a2%e6%80%81%e4%b8%8e%e9%a2%9c%e8%89%b2%e7%9a%84%e7%bb%bc%e5%90%88%e5%ba%94%e7%94%a8&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;通过对患者心情和生理状态监测的数据分析，可以确定哪些植物种类和颜色最能引起正面的反应。例如，如果数据显示某些颜色的花朵能够稳定心率或减轻焦虑，那么这些花朵应被优先考虑纳入病房的园艺设计中。选择园艺作物不仅仅是根据患者的喜好，更是基于科学数据对其健康影响的理解。&lt;/p&gt;
&lt;h3&gt;4.3 病患的参与度的考量&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;43-病患的参与度的考量&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#43-%e7%97%85%e6%82%a3%e7%9a%84%e5%8f%82%e4%b8%8e%e5%ba%a6%e7%9a%84%e8%80%83%e9%87%8f&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;为了提高病患的积极参与度，园艺环境的设计需要考虑如何让病患更容易地与植物互动。这可以是通过可移动的植物床，触感友好的植物选择，或是引入可进行简单园艺活动的空间设计。&lt;/p&gt;
&lt;p&gt;
    &lt;img src=&#34;.././media/%e6%96%b0%e5%86%9c%e7%a7%91%e5%ae%9e%e8%b7%b5/image5.png&#34; alt=&#34;武汉市武东医院园艺治疗师带领精神残疾患者及家属播种&#34;  loading=&#34;lazy&#34; /&gt;
&lt;em&gt;图5 武汉市武东医院园艺治疗师带领精神残疾患者及家属播种&lt;sup&gt;[7]&lt;/sup&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;利用生物医学工程技术收集的数据，可以识别出哪些互动类型对于患者的恢复更有帮助，并相应地调整园艺环境。&lt;/p&gt;
&lt;h2&gt;5 总结与未来展望&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;5-总结与未来展望&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#5-%e6%80%bb%e7%bb%93%e4%b8%8e%e6%9c%aa%e6%9d%a5%e5%b1%95%e6%9c%9b&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;研究表明，结合生物医学工程技术可以大幅提高园艺疗法的个性化水平和效果。通过实时监测和分析病患的生理和心理状态，医疗团队能够调整治疗环境，以最大化其恢复潜力。采用这种技术，园艺治疗变得更加精细化和动态化，从而为病患提供了一个更加支持性和有益的康复环境。&lt;/p&gt;
&lt;p&gt;展望未来，生物医学工程与园艺治疗结合的领域有巨大的发展潜力。随着技术的进步，监测设备将变得更加微型化、智能化和成本效益高。预期未来的研究将进一步优化数据分析算法，提高预测病患反应的准确性，从而实现更加个性化的治疗方案。同时，随着对患者心理和生理影响更深入的理解，园艺疗法的应用范围和效果都有望得到显著扩展。&lt;/p&gt;
&lt;p&gt;总体而言，生物医学工程的应用将为传统园艺疗法带来创新，增强科学性和有效性。未来，我期望这种跨学科的合作不仅能够为患者提供更优质的治疗环境，同时为医院设计提供新的理念，使得园艺治疗在医疗保健领域的重要性得到更广泛的认识和应用。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;参考文献&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;[1] 薛滨夏,李同予.园艺疗法体系的组成、内涵与实施应用[J].园林,2023,40(04):51-57.&lt;/p&gt;
&lt;p&gt;[2] 李树华.园艺疗法的特征[J].园林,2013(11):12-17.&lt;/p&gt;
&lt;p&gt;[3] 贾俊丽,罗海蓉,梅雪莹等.花卉在园艺疗法中的应用[J].安徽农业科学,2022,50(22):114-118.&lt;/p&gt;
&lt;p&gt;[4] 黄素琴,高斌.生物医学工程专业研究生医工交叉培养方式探索[J].中国教育技术装备,2021(20):134-136.&lt;/p&gt;
&lt;p&gt;[5] 李晓凡,范国光.抑郁症病人面部表情刺激的脑功能磁共振研究现状与进展[J].国际医学放射学杂志,2010,33(05):421-423+450.&lt;/p&gt;
&lt;p&gt;[6] 杨婷婷,赵艺玥.基于园艺疗法的室内植物色彩选择[J].现代园艺,2023,46(05):172-175.DOI:10.14051/j.cnki.xdyy.2023.05.072.&lt;/p&gt;
&lt;p&gt;[7] 荆楚网.武汉市武东医院开展园艺疗法 用植物护佑特殊患者心理健康[EB/OL].(2023-3-24)[2023-11-3].https://baijiahao.baidu.com/s?id=1728174748473947119&amp;amp;wfr=spider&amp;amp;for=pc&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E6%99%AE%E9%80%9A%E5%8C%96%E5%AD%A6%E4%B9%99/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E6%99%AE%E9%80%9A%E5%8C%96%E5%AD%A6%E4%B9%99/</guid>
      <description>
        
        
        
      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E6%9E%81%E9%99%90%E9%A3%9E%E7%9B%98/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E6%9E%81%E9%99%90%E9%A3%9E%E7%9B%98/</guid>
      <description>
        
        
        
      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E7%8E%B0%E5%BD%93%E4%BB%A3%E8%A5%BF%E6%96%B9%E5%BB%BA%E7%AD%91%E5%AE%A1%E7%BE%8E/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E7%8E%B0%E5%BD%93%E4%BB%A3%E8%A5%BF%E6%96%B9%E5%BB%BA%E7%AD%91%E5%AE%A1%E7%BE%8E/</guid>
      <description>
        
        
        
      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E7%94%9F%E5%91%BD%E7%A7%91%E5%AD%A6%E5%AF%BC%E8%AE%BA/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E7%94%9F%E5%91%BD%E7%A7%91%E5%AD%A6%E5%AF%BC%E8%AE%BA/</guid>
      <description>
        
        
        
      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E7%94%9F%E7%89%A9%E5%8C%BB%E5%AD%A6%E5%B7%A5%E7%A8%8B%E6%99%BA%E6%85%A7%E5%8C%BB%E7%96%97%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E7%94%9F%E7%89%A9%E5%8C%BB%E5%AD%A6%E5%B7%A5%E7%A8%8B%E6%99%BA%E6%85%A7%E5%8C%BB%E7%96%97%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F/</guid>
      <description>
        
        
        
      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E7%A4%BE%E4%BC%9A%E4%B8%BB%E4%B9%89%E5%8F%91%E5%B1%95%E5%8F%B2/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E7%A4%BE%E4%BC%9A%E4%B8%BB%E4%B9%89%E5%8F%91%E5%B1%95%E5%8F%B2/</guid>
      <description>
        
        
        &lt;h1&gt;社会主义发展史&lt;/h1&gt;&lt;p&gt;四史之一，体验不错。&lt;/p&gt;
&lt;h2&gt;课程论文&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;课程论文&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%af%be%e7%a8%8b%e8%ae%ba%e6%96%87&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;http://localhost:1313/pdfs/%e7%a4%be%e4%bc%9a%e4%b8%bb%e4%b9%89%e5%8f%91%e5%b1%95%e5%8f%b2%e8%af%be%e7%a8%8b%e8%ae%ba%e6%96%87.pdf&#34;&gt;社会主义发展史课程论文&lt;/a&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E7%A4%BE%E4%BC%9A%E5%BF%83%E7%90%86%E5%AD%A6/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E7%A4%BE%E4%BC%9A%E5%BF%83%E7%90%86%E5%AD%A6/</guid>
      <description>
        
        
        &lt;h1&gt;社会心理学&lt;/h1&gt;&lt;h2&gt;课程论文&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;课程论文&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e8%af%be%e7%a8%8b%e8%ae%ba%e6%96%87&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;浙江大学2023&amp;ndash;2024学年 冬 学期&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;《社会心理学》课程期末考查&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;课程号&lt;/strong&gt;：7913N001&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;开课学院&lt;/strong&gt;：心理与行为科学系&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;考查形式&lt;/strong&gt;：课程论文&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;考查日期&lt;/strong&gt;：&lt;strong&gt;2024&lt;/strong&gt;年&lt;strong&gt;1&lt;/strong&gt;月&lt;strong&gt;3&lt;/strong&gt;日&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;&lt;strong&gt;打分项目&lt;/strong&gt;&lt;/th&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;&lt;strong&gt;论文结构&lt;/strong&gt;&lt;/th&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;&lt;strong&gt;论文内容&lt;/strong&gt;&lt;/th&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;&lt;strong&gt;文字表达&lt;/strong&gt;&lt;/th&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;&lt;strong&gt;创新性&lt;/strong&gt;&lt;/th&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;&lt;strong&gt;研究意义&lt;/strong&gt;&lt;/th&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;&lt;strong&gt;总 分&lt;/strong&gt;&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;strong&gt;得分&lt;/strong&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;strong&gt;评卷人&lt;/strong&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h3&gt;期 末 论 文&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;期-末-论-文&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e6%9c%9f-%e6%9c%ab-%e8%ae%ba-%e6%96%87&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;根据本学期《社会心理学》课程的教学内容，描述某一社会现象，并运用社会心理学的相关理论加以分析。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;论文写作要求&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;论文应包含题目，摘要，正文，参考文献四部分，其中正文字数不少于3000字&lt;/li&gt;
&lt;li&gt;参考文献以近五年为主，APA 7th格式&lt;/li&gt;
&lt;li&gt;格式规范，符合心理学论文的一般写作要求（具体可参考&lt;a href=&#34;http://www.appliedpsy.cn/UserFiles/File/guifan.doc&#34;target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;《心理学论文写作规范》&lt;/a&gt;）&lt;/li&gt;
&lt;li&gt;不得抄袭，一旦发现抄袭以零分处理&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h1&gt;新媒体环境下青少年脏话使用的社会心理学探究&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;摘要&lt;/strong&gt;：本研究聚焦于新媒体环境中青少年使用网络脏话的社会心理学现象，探讨了脏话使用的动因、亚文化的形成及其对青少年心理和行为的影响。通过分析青少年在新媒体环境下脏话使用的社会和个人原因，本研究揭示了网络脏话的使用不仅仅是语言的简单使用，而是深层的社会心理过程的体现。研究还深入探讨了脏话变体（如谐音、倒放）的产生原因，包括新媒体平台的特性、社会管理者的干预及媒介属性和受众特征。此外，本文对祖安文化这一青少年后亚文化现象进行了分析，强调了去中心化、弱群体归属感和消费主义下的文化狂欢对青少年心理特征和行为动因的影响。通过这一研究，我们能更深入地理解青少年的社会心理需求，以及他们在特定社会环境中的互动模式。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;关键词&lt;/strong&gt;：社会心理学；青少年；新媒体；网络脏话；亚文化&lt;/p&gt;
&lt;h2&gt;1. 引言&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;1-引言&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#1-%e5%bc%95%e8%a8%80&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;在当今社会，随着新媒体技术的快速发展，人们的沟通方式经历了显著的变革。特别是在青少年中，新媒体平台如社交网络、在线游戏和视频分享网站已成为日常交流的主要渠道。伴随这一变革，网络语言也经历了迅速的演变，其中包括脏话使用的新形式和趋势。脏话在网络环境中的普及不仅体现了语言的适应性和创新性，也反映了深层的社会心理因素和文化变迁。&lt;/p&gt;
&lt;p&gt;
    &lt;img src=&#34;.././media/%e7%a4%be%e4%bc%9a%e5%bf%83%e7%90%86%e5%ad%a6/image1.png&#34; alt=&#34;社交媒体上关于&amp;#34;阿米诺斯&amp;#34;的讨论度&#34;  loading=&#34;lazy&#34; /&gt;
&lt;em&gt;图1 社交媒体上关于&amp;quot;阿米诺斯&amp;quot;的讨论度&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;在这个背景下，脏话的使用不再仅仅是个别人的语言行为，而是成为了一个值得深入研究的社会现象。尤其值得关注的是，脏话在新媒体环境下呈现出的特殊特点和流行趋势，例如谐音脏话、倒放脏话、网络流行语等，这些都是传统脏话研究所未覆盖的新领域，如图1所见，在互联网上激起了广大青少年共同的响应。因此，对新媒体环境下脏话的使用进行研究，不仅有助于理解当代青少年的语言习惯和沟通方式，也对揭示社会文化动态和促进健康网络环境的构建具有重要意义。&lt;/p&gt;
&lt;h2&gt;2. 脏话使用的社会和个人因素&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;2-脏话使用的社会和个人因素&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#2-%e8%84%8f%e8%af%9d%e4%bd%bf%e7%94%a8%e7%9a%84%e7%a4%be%e4%bc%9a%e5%92%8c%e4%b8%aa%e4%ba%ba%e5%9b%a0%e7%b4%a0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;通过分析青少年使用网络脏话的动机、态度以及脏话的社会文化含义，本研究试图回答一个核心问题：即新媒体环境下，青少年使用脏话的主要动因是什么？针对这个问题，笔者提出了以下六种假说：&lt;/p&gt;
&lt;p&gt;&lt;em&gt;表1 针对青少年使用脏话的六种假说&lt;/em&gt;&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;假说次序&lt;/th&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;假说内容&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;H1&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;网络环境的相对宽松和自由使得青少年更倾向于在此环境中使用脏话，与现实环境形成对比&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;H2&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;青少年认为网络与现实生活中的行为规范存在差异，导致他们在网络环境中使用脏话的行为与现实生活中的言语选择有所不同&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;H3&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;特定网络亚文化群体（如祖安文化）对青少年使用网络脏话的方式产生影响，促使他们模仿和采纳这些群体的语言习惯&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;H4&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;青少年使用网络脏话作为一种情感表达方式，尤其在特定的情感状态下，如愤怒或激动时&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;H5&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;青少年在其社交圈和社交媒体的影响下，使用网络脏话作为一种适应和融入社交环境的手段&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;H6&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;随着时间推移，青少年对网络脏话的敏感度逐渐下降，导致他们更容易接受甚至采用这类语言，包括脏话的谐音或倒放形式&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2&gt;3. 调查方法和结果&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;3-调查方法和结果&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#3-%e8%b0%83%e6%9f%a5%e6%96%b9%e6%b3%95%e5%92%8c%e7%bb%93%e6%9e%9c&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;为了深入理解青少年在新媒体环境下使用网络脏话的原因，本研究设计了一份详细的问卷调查。调查采用了结构化的问卷格式，目的是探索浙江大学大学生对网络脏话使用的态度、频率以及背后的心理和社会动因，总共收集到了76份有效问卷。&lt;/p&gt;
&lt;p&gt;接下来，我们将使用列联表分析和卡方检验对假说进行验证分析。&lt;/p&gt;
&lt;p&gt;&lt;em&gt;表2 大学生对于脏话变体接受度调查问卷的卡方分析&lt;/em&gt;&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;题目&lt;/th&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;是&lt;/th&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;否&lt;/th&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;X²&lt;/th&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;P&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;你认为网络环境相比于现实环境在言论表达上更宽松吗？&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;64&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;12&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;20.15&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;0.000***&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;在现实环境中使用脏话的频率是否高于网络生活？&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;22&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;54&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;7.05&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;0.008**&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;你认为在朵朵与98的匿名帖中使用脏话没有平时的心理负担吗？&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;39&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;37&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;0.026&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;0.871&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;你在朵朵与98的实名帖子中经常见到脏话吗？&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;47&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;29&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;2.16&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;0.141&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;你是否认为网络与现实生活中的行为准则有所不同？&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;52&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;24&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;5.34&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;0.021*&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;在网络环境中使用脏话是否会影响你在现实生活中的言语选择？&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;49&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;27&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;3.25&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;0.071&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;你是否认为特定的网络亚文化群体（如祖安文化）影响了你使用网络脏话的方式？&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;48&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;28&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;2.68&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;0.102&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;你是否因为在B站或抖音刷到&amp;quot;阿米诺斯物业&amp;quot;&amp;ldquo;otto&amp;quot;的二创视频而提高了类似用语的使用频率？&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;40&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;36&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;0.105&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;0.746&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;你是否因为属于你关注的博主/UP主而更倾向于使用网络脏话？&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;35&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;41&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;0.237&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;0.626&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;你的社交圈子是否常用网络脏话？&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;43&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;33&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;0.661&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;0.416&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;你经常浏览的社交媒体（微博/贴吧/小红书/知乎等）是否影响了你平时的用语方式？&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;56&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;20&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;9.03&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;0.003**&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;你是否觉得在你的社交圈中使用网络脏话可以帮助你更好地融入？&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;43&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;33&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;0.061&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;0.416&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;长期以来，你对网络脏话的接受程度是否有所改变？&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;56&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;20&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;9.03&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;0.003**&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;你是否认为网络脏话现在更为普遍接受，不再那么令人反感？&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;50&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;26&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;3.89&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;0.049*&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;你是否认为脏话的谐音或倒放不属于侮辱性语言，已经脱离脏话的概念了？&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;49&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;27&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;3.25&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;0.071&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2&gt;4. 原因分析&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;4-原因分析&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#4-%e5%8e%9f%e5%9b%a0%e5%88%86%e6%9e%90&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;问卷结果表明，网络环境的相对宽松和自由是青少年倾向于在此环境中使用脏话的一个重要原因（H1）。这一现象与现实环境形成了鲜明对比，青少年在网络中感受到更少的言语表达限制。特别是，关于网络环境言论表达宽松程度的问题，卡方检验显示了极其显著的差异（X²=20.15, p&amp;lt;0.001），强调了这一点的重要性。&lt;/p&gt;
&lt;p&gt;此外，青少年认为网络与现实生活中的行为规范存在差异（H2），这导致他们在网络环境中的脏话使用与现实生活中的言语选择有所不同。这种感知的差异可能是由网络环境的匿名性和去中心化特性所引起的，通过卡方检验得到了统计学上的显著支持（X²=5.34, p=0.021）。&lt;/p&gt;
&lt;p&gt;网络亚文化群体的影响同样显著（H3），尤其是如B站上&amp;quot;一个叫&amp;rsquo;阿米诺斯&amp;rsquo;的互联网民族&amp;quot;&amp;ldquo;聊聊阿米诺斯，脏话屏蔽背后的权力与反抗&amp;quot;等视频所折射的特定群体，对青少年使用网络脏话的方式产生了显著影响。这些群体通过其独特的语言习惯和沟通风格，为青少年提供了新的表达方式。虽然对这一假设的卡方检验未达到传统的显著性水平（χ²=2.68, p=0.102），但结果仍提供了一定程度的支持，推测是取样样本不够的原因。&lt;/p&gt;
&lt;p&gt;情感表达是青少年使用网络脏话的一个重要动机（H4）。在特定的情感状态下，如愤怒或激动时，脏话成为了一种有效的情感释放手段，如问卷中搜集到的词云图所示。Rassin和Muris由宣泄情绪这一原因认为，脏话可以帮助保持心理卫生，从而具有存在的必要。&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;
    &lt;img src=&#34;.././media/%e7%a4%be%e4%bc%9a%e5%bf%83%e7%90%86%e5%ad%a6/image2.png&#34; alt=&#34;更倾向于使用网络脏话的情感状态词云图&#34;  loading=&#34;lazy&#34; /&gt;
&lt;em&gt;图2 更倾向于使用网络脏话的情感状态词云图&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;此外，青少年在其社交圈和社交媒体的影响下，使用网络脏话作为适应和融入社交环境的一种手段（H5），这表明脏话的使用与社交认同和归属感的建立有关。对这一假设的卡方检验虽未达显著水平（X²=0.661, p=0.416），但提供了对趋势的洞见。&lt;/p&gt;
&lt;p&gt;随着时间的推移，青少年对网络脏话的敏感度逐渐下降（H6），这导致他们更容易接受甚至采用这类语言，包括脏话的谐音或倒放形式。这种变化可能与新媒体环境中脏话使用的日益普及有关，反映了文化适应过程中语言和价值观的变迁。这一假设通过卡方检验得到了显著支持（X²=9.03, p=0.003）。&lt;/p&gt;
&lt;h2&gt;5. 新媒体环境中脏话变体的社会心理学分析&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;5-新媒体环境中脏话变体的社会心理学分析&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#5-%e6%96%b0%e5%aa%92%e4%bd%93%e7%8e%af%e5%a2%83%e4%b8%ad%e8%84%8f%e8%af%9d%e5%8f%98%e4%bd%93%e7%9a%84%e7%a4%be%e4%bc%9a%e5%bf%83%e7%90%86%e5%ad%a6%e5%88%86%e6%9e%90&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;（一）脏话的演变与分类&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;一脏话的演变与分类&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%b8%80%e8%84%8f%e8%af%9d%e7%9a%84%e6%bc%94%e5%8f%98%e4%b8%8e%e5%88%86%e7%b1%bb&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;1. 从直接脏话到谐音语的转变&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;1-从直接脏话到谐音语的转变&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#1-%e4%bb%8e%e7%9b%b4%e6%8e%a5%e8%84%8f%e8%af%9d%e5%88%b0%e8%b0%90%e9%9f%b3%e8%af%ad%e7%9a%84%e8%bd%ac%e5%8f%98&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;脏话的演变过程体现了语言适应社会文化和技术环境变化的能力。传统上，脏话作为一种直接、粗俗的语言形式，主要用于表达愤怒、侮辱或其他强烈情绪。然而，在新媒体环境中，直接脏话的使用受到了社会规范和技术监控的限制。为了适应这种环境，并保持脏话表达愤怒和侮辱情绪的功能，出现了谐音脏话的现象。从粗俗的&amp;quot;操你妈&amp;quot;到羊驼的&amp;quot;草泥马&amp;rdquo;，这种演变可以被视为一种语言策略，使得用户能够在遵守社会规范和技术限制的同时，继续使用脏话进行情绪表达和社会评论。谐音脏话通过改变原有脏话的音节结构，创造出听起来相似但字面意义不同的词汇，从而在表达上获得一定程度的隐蔽性和安全性。&lt;/p&gt;
&lt;h4&gt;2. 网络脏话的定义和分类&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;2-网络脏话的定义和分类&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#2-%e7%bd%91%e7%bb%9c%e8%84%8f%e8%af%9d%e7%9a%84%e5%ae%9a%e4%b9%89%e5%92%8c%e5%88%86%e7%b1%bb&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;脏话变体可定义为一种在音韵上类似于传统脏话，但在字面意义上有所差异的语言现象。&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;这种变体既保留了原有脏话的部分音韵特征，又通过创新实现了新的语义层次。脏话变体的分类包括但不限于以下几种类型：&lt;/p&gt;
&lt;p&gt;&lt;em&gt;表3 脏话变体的分类&lt;/em&gt;&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;分类类型&lt;/th&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;解释&lt;/th&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;举例&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;单字替换&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;通过替换脏话中的某个字或音节，创造出听起来相似但含义不同的词汇&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;翔、戳、吊&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;字母或拼音替换&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;在拼写或拼音上进行改动，使得词汇在视觉或听觉上与原脏话相似&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;TMD、NMSL、SB、SM、NT&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;特定群体侮辱类&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;针对特定群体或个人的谐音脏话，旨在通过变体表达对特定对象的侮辱或讽刺&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;玩原神玩的、遥遥领先&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;同音字替代&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;使用与原脏话同音或近音的字词替代，以达到类似的表达效果&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;草泥马、我去年买了个表&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;外文发音&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;借助外语单词的发音来创造与原脏话类似的音效，同时避免直接使用脏话&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;花Q、碧池&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;夸赞类&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;将原本具有负面含义的脏话转化为表扬或夸奖的用语，通常带有讽刺或幽默的意味&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;牛逼、碉堡了&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;表情包&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;使用表情包代替文字脏话，通过图像传达相似的情绪或意图&lt;/td&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;龙图、孙笑川图&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3&gt;（二）脏话变体的产生原因&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;二脏话变体的产生原因&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%ba%8c%e8%84%8f%e8%af%9d%e5%8f%98%e4%bd%93%e7%9a%84%e4%ba%a7%e7%94%9f%e5%8e%9f%e5%9b%a0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;1. 新媒体平台的作用&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;1-新媒体平台的作用&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#1-%e6%96%b0%e5%aa%92%e4%bd%93%e5%b9%b3%e5%8f%b0%e7%9a%84%e4%bd%9c%e7%94%a8&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;班杜拉的社会认知理论(STC)认为,人的行为是个人、社会和行为相互作用的结果&lt;sup id=&#34;fnref:3&#34;&gt;&lt;a href=&#34;#fn:3&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;3&lt;/a&gt;&lt;/sup&gt;。在新媒体的语境中，脏话的谐音、倒放及其他变体形式的产生并非偶然现象，而是新媒体平台特性的直接结果。新媒体平台，如社交网络和即时通讯工具，提供了一个相对自由和去中心化的沟通环境，其中信息的传播速度快，覆盖范围广。这种环境促进了语言形式的快速创新和演变，尤其是在年轻的互联网使用者中。脏话的谐音变体在这种环境中快速流行，反映了青少年群体对于传统语言规范的挑战以及对创新表达形式的追求。此外，新媒体平台的匿名性或半匿名性特点也为脏话变体的使用提供了一个相对安全的空间，如美国的4chan、日本的2ch、中国的NGA等，使得用户在表达强烈情绪或观点时更加大胆。&lt;/p&gt;
&lt;h4&gt;2. 社会管理者的干预&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;2-社会管理者的干预&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#2-%e7%a4%be%e4%bc%9a%e7%ae%a1%e7%90%86%e8%80%85%e7%9a%84%e5%b9%b2%e9%a2%84&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;广电以及其下游的各大社交媒体审核对网络言论的监管和干预，如实施禁言条例和内容过滤机制，也是推动脏话变体产生的重要因素。以网易《我的世界》举例，&amp;ldquo;给点草方块&amp;quot;&amp;ldquo;联机开房间&amp;quot;等游戏正常用语会被屏蔽为&amp;rdquo;***&amp;quot;，就连连续的数字也因QQ号的嫌疑而被屏蔽。为了规避这些监管措施，网络用户常常创造和使用脏话的变体形式，以绕过自动审核系统，这种变通方式反映了用户对言论自由的追求和对权威的逆反心理。&lt;/p&gt;
&lt;p&gt;当青少年尝试避免在某些社交场合使用网络脏话时，可能会经历思维抑制(Thought Suppression)的心理过程。然而，根据思维抑制理论，越是尝试抑制某些思维，这些思维反而可能更强烈地回归，导致在不适当的情况下使用网络脏话的反弹效应。在这个过程中，脏话变体不仅作为一种规避机制，还逐渐发展成为一种独特的文化符号，具有特定的社会和心理含义。&lt;/p&gt;
&lt;h4&gt;3. 媒介属性和受众特征&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;3-媒介属性和受众特征&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#3-%e5%aa%92%e4%bb%8b%e5%b1%9e%e6%80%a7%e5%92%8c%e5%8f%97%e4%bc%97%e7%89%b9%e5%be%81&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;新媒体的媒介属性，特别是其交互性、即时性和多样性，与脏话变体的产生和流行密切相关。这些属性使得新媒体成为一个动态且富有创造性的沟通环境，其中用户可以迅速响应社会事件和文化趋势，并以创新的语言形式进行表达。特别是在年轻的受众群体中，他们对新奇和另类表达方式的偏好驱动了脏话变体的创造和流行。这些年轻用户通常更加熟悉和活跃于新媒体平台，他们的交流方式和文化偏好在很大程度上塑造了新媒体环境中的语言趋势。因此，脏话变体的流行也可以看作是新媒体环境中年轻用户文化特征和心理需求的反映。&lt;/p&gt;
&lt;p&gt;综上所述，脏话谐音和其他变体在新媒体环境中的产生和流行是多种因素交织的结果，包括新媒体平台的特性、社会管理者的干预以及媒介属性和受众特征的互动。这些因素共同作用，推动了脏话变体作为一种特殊的社会心理现象在网络空间的发展和演变。&lt;/p&gt;
&lt;h2&gt;6. 青少年后亚文化&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;6-青少年后亚文化&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#6-%e9%9d%92%e5%b0%91%e5%b9%b4%e5%90%8e%e4%ba%9a%e6%96%87%e5%8c%96&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h3&gt;（一）祖安文化的形成和发展&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;一祖安文化的形成和发展&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%b8%80%e7%a5%96%e5%ae%89%e6%96%87%e5%8c%96%e7%9a%84%e5%bd%a2%e6%88%90%e5%92%8c%e5%8f%91%e5%b1%95&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;在探讨新媒体环境中脏话变体的社会心理学现象时，我们不得不提及特定的亚文化群体&amp;mdash;&amp;mdash;祖安文化，它在网络脏话的使用和演变中扮演着重要角色。祖安文化及其之后所发展的亚文化不仅反映了脏话在新媒体中的创新表达方式，而且展示了青少年群体如何通过特定的语言和行为模式，在亚文化中寻求认同和归属感。&lt;/p&gt;
&lt;h4&gt;1. 起源和直接因素&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;1-起源和直接因素&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#1-%e8%b5%b7%e6%ba%90%e5%92%8c%e7%9b%b4%e6%8e%a5%e5%9b%a0%e7%b4%a0&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;祖安文化起源于网络游戏《英雄联盟》中的虚拟地区&amp;quot;祖安&amp;rdquo;，这一地区以其玩家的特定言行风格著称。祖安文化的直接因素包括了游戏内的角色设定、玩家之间的互动方式，以及游戏主播对这种文化的推广和演绎。这种文化最初表现为游戏内的一种特定沟通方式，随后逐渐扩散至游戏外的网络空间，成为一种独立的亚文化现象。它的形成体现了青少年群体如何通过共享的兴趣和活动，构建并认同特定的社会身份。&lt;/p&gt;
&lt;p&gt;祖安文化中脏话的使用初期较为直接和粗俗，但随着文化的传播和发展，其语言形式经历了显著的演变。这种演变体现在从直接脏话到创新的谐音、音译和合成词等形式的转变。这一变化不仅是对新媒体监管的适应，也是对传统语言表达方式的创新。在这个过程中，祖安文化的参与者展示了他们对语言的掌控力和创造力，通过改变传统脏话的形式来维持文化的独特性和辨识度。&lt;/p&gt;
&lt;h4&gt;2. 文化意义的变化&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;2-文化意义的变化&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#2-%e6%96%87%e5%8c%96%e6%84%8f%e4%b9%89%e7%9a%84%e5%8f%98%e5%8c%96&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;随着祖安文化的发展和传播，其文化意义也经历了变化。最初，祖安文化主要表现为对抗传统和权威的一种方式，反映了青少年群体对现实世界的不满和对网络空间的逃避。然而，随着这种文化在更广泛的网络空间中流行，其原始的文化内核逐渐被模糊和商业化。这种文化意义的转变反映了亚文化在新媒体环境中的演化特点，即从边缘化的反叛表达到更为主流和商业化的娱乐形式。在社会心理学的视角下，这一变化揭示了青少年群体在文化认同、集体归属感以及对权威的态度等方面的心理动态。&lt;/p&gt;
&lt;p&gt;爱德华在《语言论》中指出：&amp;ldquo;语言不脱离文化而存在，就是说，不脱离社会流传下来的、决定我们生活面貌的风俗和信仰的总体。&amp;rdquo;&lt;sup id=&#34;fnref:4&#34;&gt;&lt;a href=&#34;#fn:4&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;4&lt;/a&gt;&lt;/sup&gt;通过分析祖安文化的形成、发展和文化意义的变化，我们可以更深入地理解青少年后亚文化中脏话使用的社会心理学含义，包括身份认同、集体归属感以及对社会规范的态度等方面的心理动因。&lt;/p&gt;
&lt;h3&gt;（二）去中心化和弱群体归属感&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;二去中心化和弱群体归属感&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%ba%8c%e5%8e%bb%e4%b8%ad%e5%bf%83%e5%8c%96%e5%92%8c%e5%bc%b1%e7%be%a4%e4%bd%93%e5%bd%92%e5%b1%9e%e6%84%9f&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;h4&gt;1. 参与群体的拓展&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;1-参与群体的拓展&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#1-%e5%8f%82%e4%b8%8e%e7%be%a4%e4%bd%93%e7%9a%84%e6%8b%93%e5%b1%95&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;祖安文化最初局限于《英雄联盟》游戏玩家的小范围群体，但随着时间的推移，其参与群体迅速扩展。这一扩展不仅涉及更广泛的网络用户，如追星粉丝、各类网络社区成员，也包括更多通过社交媒体和其他新媒体平台接触到该文化的青少年。青年群体作为网络的主要使用者,富有创造力,充满个性化表达欲望,而网络脏话作为一种风格化、符号化的表达方式,具有新奇、怪异的特点,正是青年群体用来消解、对抗传统主流文化的一种方式。&lt;sup id=&#34;fnref:5&#34;&gt;&lt;a href=&#34;#fn:5&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;5&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;h4&gt;2. 后亚文化特征的分析&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;2-后亚文化特征的分析&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#2-%e5%90%8e%e4%ba%9a%e6%96%87%e5%8c%96%e7%89%b9%e5%be%81%e7%9a%84%e5%88%86%e6%9e%90&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;祖安文化作为一种后亚文化，其核心特征包括去中心化和弱群体归属感。去中心化表现在该文化没有固定的领导者或组织结构，文化的发展和传播主要依靠参与者的自发行为。这种特征导致了文化内部多样性和复杂性的增加，使得不同参与者可能基于不同的理由加入并诠释该文化。弱群体归属感反映在参与者通常不形成紧密的社群结构，个体在文化中的身份相对松散，容易受到外部因素如流行趋势和商业化的影响。&lt;/p&gt;
&lt;h3&gt;（三）消费主义下的文化狂欢&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;三消费主义下的文化狂欢&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#%e4%b8%89%e6%b6%88%e8%b4%b9%e4%b8%bb%e4%b9%89%e4%b8%8b%e7%9a%84%e6%96%87%e5%8c%96%e7%8b%82%e6%ac%a2&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;任何后亚文化能够得以生存，某种程度上来说，都与当今社会主流的商业化消费观脱不了干系。如果说后亚文化是一个机体，那么它的某些个体要素如风格化的东西则会被转化成象征符号，然后再转化成商品的形式。&lt;sup id=&#34;fnref:6&#34;&gt;&lt;a href=&#34;#fn:6&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;6&lt;/a&gt;&lt;/sup&gt;网络迷因（Memes）经常被广告商用来吸引年轻消费者，如伴随&amp;quot;只因你太美&amp;quot;而兴起的一系列淘宝小装饰和二创视频，为相当大部分创作者和电商提供了收益。在消费主义的推动下，亚文化经历了从小众圈子到更广泛流行文化的转变。这种转变伴随着商业平台的介入和推广，使得文化原有的反叛和边缘特征逐渐被商业化和娱乐化的元素所消解。&lt;/p&gt;
&lt;p&gt;从社会心理学的角度来看，祖安文化的发展和演变反映了青少年在新媒体环境中的身份建构、群体互动以及消费主义影响下的文化参与方式。通过理解这些特征，我们可以更深入地洞察青少年的心理需求和行为动机，以及他们在特定社会环境中的互动模式。&lt;/p&gt;
&lt;h2&gt;7. 结论&lt;span class=&#34;hx:absolute hx:-mt-20&#34; id=&#34;7-结论&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#7-%e7%bb%93%e8%ae%ba&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;青少年在新媒体环境下使用网络脏话和参与特定亚文化的行为，反映了他们在构建个人身份和社会关系方面的心理需求。这种行为不仅是对传统社会规范的一种挑战，也是一种对个人自我表达和群体归属感的追求。特别是在消费主义和媒体饱和的社会背景下，这种行为表现了青少年对于自我认同和社会认同的探索。&lt;/p&gt;
&lt;p&gt;在社会心理学的视角下，网络脏话的使用和亚文化的参与，可以被视为青少年应对社会压力、寻求社会归属以及表达个体差异的策略。这些行为不仅是语言和文化的简单表现，而是深层的社会心理过程的体现。它们揭示了青少年在社会化过程中如何适应和反应社会规范，以及如何在新媒体环境中寻找和构建属于自己的社会空间。&lt;/p&gt;
&lt;p&gt;此外，新媒体环境中脏话的演变和亚文化的流行，也反映了青少年群体在心理发展过程中的逆反心理、从众心理以及对于新奇体验的追求。这些心理特征与新媒体环境的特性相结合，促成了独特的社会心理现象的出现。&lt;/p&gt;
&lt;p&gt;总之，本研究强调了青少年在新媒体环境中使用网络脏T话和参与亚文化活动的行为，不仅是社会文化现象的反映，更是复杂的社会心理过程的体现。这些发现对于理解青少年的心理发展、社会行为以及他们与社会环境的互动具有重要意义。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;参考文献&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Rassin, E., &amp;amp; Murs, P. (2005). Why do women syear? An exploration of reasons for and perceived efficacy of swearing in Dutch female students. &lt;em&gt;Personality and Individual Differences, 38&lt;/em&gt;(7), 1669-1674.&lt;/p&gt;
&lt;p&gt;徐勇. (2019). 新媒体环境中脏话谐音现象的原因探究. &lt;em&gt;东南传播, 2019&lt;/em&gt;(8), 114-116. DOI:10.13556/j.cnki.dncb.cn35-1274/j.2019.08.034.&lt;/p&gt;
&lt;p&gt;班杜拉. (1988). &lt;em&gt;社会学习心理学&lt;/em&gt;. 吉林: 吉林教育出版社.&lt;/p&gt;
&lt;p&gt;爱德华·萨丕尔 (原著), 陆卓元 (译). (1977). &lt;em&gt;语言论: 言语研究导论&lt;/em&gt;. 北京: 商务印书馆.&lt;/p&gt;
&lt;p&gt;李长健, 沈露依, &amp;amp; 但思臣. (2019). 当代青年群体使用&amp;quot;网络脏话&amp;quot;动因的实证研究. &lt;em&gt;东南传播, 2019&lt;/em&gt;(9), 96-99. DOI:10.13556/j.cnki.dncb.cn35-1274/j.2019.09.031.&lt;/p&gt;
&lt;p&gt;华桦. (2020). &amp;ldquo;祖安文化&amp;quot;的形成机制、文化特征及应对策略&amp;mdash;&amp;mdash;基于青年后亚文化的理论解释与局限. &lt;em&gt;当代青年研究, 2020&lt;/em&gt;(6), 46-52.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;说明：&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;第一页为封面页，保留第一页格式。正文从第二页开始。&lt;/li&gt;
&lt;li&gt;打印装订：A4页面，双面打印，左侧装订&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;Rassin, E., &amp;amp; Murs, P. (2005). Why do women syear? An exploration of reasons for and perceived efficacy of swearing in Dutch female students. Personality and Individual Differences, 38(7), 1669-1674.&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34;&gt;
&lt;p&gt;徐勇. (2019). 新媒体环境中脏话谐音现象的原因探究. 东南传播, 2019(8), 114-116. DOI:10.13556/j.cnki.dncb.cn35-1274/j.2019.08.034.&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:3&#34;&gt;
&lt;p&gt;班杜拉. (1988). 社会学习心理学. 吉林: 吉林教育出版社.&amp;#160;&lt;a href=&#34;#fnref:3&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:4&#34;&gt;
&lt;p&gt;爱德华·萨丕尔 (原著), 陆卓元 (译). (1977). 语言论: 言语研究导论. 北京: 商务印书馆.&amp;#160;&lt;a href=&#34;#fnref:4&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:5&#34;&gt;
&lt;p&gt;李长健, 沈露依, &amp;amp; 但思臣. (2019). 当代青年群体使用&amp;quot;网络脏话&amp;quot;动因的实证研究. 东南传播, 2019(9), 96-99. DOI:10.13556/j.cnki.dncb.cn35-1274/j.2019.09.031.&amp;#160;&lt;a href=&#34;#fnref:5&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:6&#34;&gt;
&lt;p&gt;华桦. (2020). &amp;ldquo;祖安文化&amp;quot;的形成机制、文化特征及应对策略&amp;mdash;&amp;mdash;基于青年后亚文化的理论解释与局限. 当代青年研究, 2020(6), 46-52.&amp;#160;&lt;a href=&#34;#fnref:6&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;

      </description>
    </item>
    
    <item>
      <title></title>
      <link>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E7%BD%91%E7%90%83/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>http://localhost:1313/docs/undergraduate/%E9%80%9A%E8%AF%86%E6%9D%82%E9%A1%B9/%E7%BD%91%E7%90%83/</guid>
      <description>
        
        
        
      </description>
    </item>
    
  </channel>
</rss>
