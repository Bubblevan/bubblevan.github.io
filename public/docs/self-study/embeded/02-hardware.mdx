---
id: embeded-hardware
title: 硬件设计
sidebar_label: 02-硬件设计
---

# 硬件设计

> 硬件是基础，好的硬件设计能让后续开发事半功倍。

## PCB设计

### 设计工具

使用**嘉立创EDA**进行PCB设计，原因：
- ✅ 免费且功能强大
- ✅ 国产软件，中文支持好
- ✅ 可以直接在嘉立创打样
- ✅ 有丰富的元器件库

### 原理图设计

#### 主控电路

ESP32最小系统：
- ESP32-WROOM-32模块
- 复位电路
- 晶振电路（ESP32内置，可选）
- 电源指示灯

#### 电源管理

```
18650电池 (3.7V)
    │
    ├── TP4056充电模块
    │   └── USB充电接口
    │
    ├── AMS1117-5V
    │   └── 舵机供电 (5V)
    │
    └── AMS1117-3.3V
        └── ESP32供电 (3.3V)
```

**注意事项**：
- 舵机启动电流大，需要足够的电容滤波
- 电池保护电路（过充/过放保护）
- 电源开关设计

#### 舵机控制

12路PWM输出：
- ESP32有16路PWM通道，足够使用
- 每路PWM需要独立控制
- 建议使用PCA9685舵机驱动板（可选，简化设计）

**舵机连接**：
- 红色：VCC (5V)
- 黑色：GND
- 黄色/橙色：PWM信号线

#### 传感器接口

- **IMU传感器**（MPU6050）：I2C接口
- **触摸传感器**：GPIO输入
- **LED指示灯**：GPIO输出

### PCB布局要点

1. **电源走线**：尽量宽，减少压降
2. **信号线**：避免与电源线平行，减少干扰
3. **接地**：大面积铺铜，降低噪声
4. **元器件布局**：按功能模块分区
5. **过孔**：合理使用，保证信号完整性

### 打样与焊接

- 使用嘉立创打样（5元/5片，非常便宜）
- 元器件可以在嘉立创商城购买
- 焊接时注意温度控制，避免损坏元器件

## 元器件清单

### 核心元器件

| 名称 | 型号/规格 | 数量 | 备注 |
|------|----------|------|------|
| 主控模块 | ESP32-WROOM-32 | 1 | 或ESP32开发板 |
| 舵机 | MG90S | 12 | 每条腿3个 |
| 电池 | 18650 3.7V 2600mAh | 1 | 带保护板 |
| 充电模块 | TP4056 | 1 | USB充电 |
| 稳压芯片 | AMS1117-5V | 1 | 舵机供电 |
| 稳压芯片 | AMS1117-3.3V | 1 | 主控供电 |

### 传感器

| 名称 | 型号 | 数量 | 接口 |
|------|------|------|------|
| IMU | MPU6050 | 1 | I2C |
| 触摸传感器 | TTP223 | 1 | GPIO |

### 其他

| 名称 | 规格 | 数量 |
|------|------|------|
| LED | 3mm | 2-4 |
| 电阻 | 10kΩ, 1kΩ | 若干 |
| 电容 | 100uF, 10uF, 0.1uF | 若干 |
| 排针/排母 | 2.54mm | 若干 |

## 电源设计详解

### 功耗估算

- **ESP32**：工作电流约80-240mA（取决于工作模式）
- **舵机（单个）**：空载约50-100mA，负载约500-1000mA
- **12个舵机同时工作**：峰值可达12A（实际不会同时满载）

### 电源方案选择

**方案1：单电池+双路稳压**
- 优点：简单，成本低
- 缺点：电池负担重，续航短

**方案2：双电池（分别供电）**
- 优点：电源分离，稳定性好
- 缺点：重量增加，成本增加

**推荐方案1**，但需要：
- 大容量电池（3000mAh+）
- 足够的滤波电容
- 合理的电源管理（避免所有舵机同时启动）

## 调试接口

设计时预留：
- **USB转串口**：用于程序下载和调试
- **SWD接口**（如使用STM32）：用于调试
- **测试点**：关键信号测试点

## 常见问题

### Q: 舵机抖动怎么办？
A: 
- 检查电源是否稳定（增加滤波电容）
- 检查PWM信号是否稳定
- 检查机械结构是否卡顿

### Q: 电池续航短？
A:
- 使用更大容量电池
- 优化控制算法，减少不必要的运动
- 添加休眠功能

### Q: PCB打样注意事项？
A:
- 最小线宽/线距：0.1mm（嘉立创标准工艺）
- 过孔大小：最小0.2mm
- 板厚：1.6mm（标准）

## 参考资源

- 嘉立创EDA教程
- ESP32官方原理图
- 舵机驱动电路参考设计
